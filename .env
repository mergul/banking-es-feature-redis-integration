# Server Configuration
PORT=3000

# Database Configuration
# Database Configuration (based on PostgreSQL optimization script)
# PostgreSQL max_connections = 132 (8 CPU cores * 4 + 100)
# Application pools use ~60% of total capacity (80 connections)
DB_MAX_CONNECTIONS=100
DB_MIN_CONNECTIONS=50
DB_ACQUIRE_TIMEOUT=30
DB_IDLE_TIMEOUT=600
DB_MAX_LIFETIME=1800
DB_BATCH_SIZE=1000
DB_BATCH_TIMEOUT_MS=25
DB_MAX_BATCH_QUEUE_SIZE=10000
DB_BATCH_PROCESSOR_COUNT=16
DB_SNAPSHOT_THRESHOLD=500
DB_SNAPSHOT_INTERVAL=300
DB_SNAPSHOT_CACHE_TTL=1800
DB_MAX_SNAPSHOTS_PER_RUN=20

# Pool Configuration (aligned with PostgreSQL recommendations)
POOL_MAX_CONNECTIONS=100
POOL_MIN_CONNECTIONS=50
POOL_HEALTH_CHECK_INTERVAL=10
POOL_CONNECTION_TIMEOUT=30
POOL_MAX_WAIT_TIME=5
POOL_EXHAUSTION_THRESHOLD=0.8
POOL_AUTO_SCALING=true

# Authentication Configuration
JWT_SECRET=default_secret
REFRESH_TOKEN_SECRET=default_refresh_secret
ACCESS_TOKEN_EXPIRY=3600
REFRESH_TOKEN_EXPIRY=604800
RATE_LIMIT_REQUESTS=1000
RATE_LIMIT_WINDOW=60
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30

# Cache Configuration
CACHE_DEFAULT_TTL=3600
CACHE_MAX_SIZE=5000
CACHE_SHARD_COUNT=8
CACHE_WARMUP_BATCH_SIZE=50
CACHE_WARMUP_INTERVAL=300

# Projection Store Configuration
PROJECTION_MAX_CONNECTIONS=200
PROJECTION_MIN_CONNECTIONS=50

# Rate Limiting Configuration
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20
RATE_LIMIT_WINDOW_SIZE=60
RATE_LIMIT_MAX_CLIENTS=500

# Scaling Configuration
SCALING_MIN_INSTANCES=1
SCALING_MAX_INSTANCES=5
SCALING_UP_THRESHOLD=0.8
SCALING_DOWN_THRESHOLD=0.2
SCALING_COOLDOWN_PERIOD=300
SCALING_HEALTH_CHECK_INTERVAL=30
SCALING_INSTANCE_TIMEOUT=60

# Kafka Configuration
KAFKA_ENABLED=true
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_GROUP_ID=banking-es-group
KAFKA_TOPIC_PREFIX=banking-es
KAFKA_PRODUCER_ACKS=1
KAFKA_PRODUCER_RETRIES=3
KAFKA_PRODUCER_BATCH_SIZE=65536
KAFKA_CONSUMER_MAX_POLL_INTERVAL_MS=300000
KAFKA_CONSUMER_SESSION_TIMEOUT_MS=10000
KAFKA_CONSUMER_MAX_POLL_RECORDS=1000
KAFKA_FETCH_MAX_BYTES= 5*1024*1024
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
KAFKA_SASL_MECHANISM=PLAIN
KAFKA_SSL_CA_LOCATION=
KAFKA_AUTO_OFFSET_RESET=earliest

# Test Mode (set to true for testing)
RUST_TEST=false

# redis url
# Used for caching, event batching, and command de-duplication.
REDIS_URL=redis://localhost:6379
DATABASE_URL=postgresql://postgres:Francisco1@localhost:5432/banking_es
# DATA_CAPTURE_METHOD=outbox_poller  
DATA_CAPTURE_METHOD=cdc_debezium
# Application Configuration
MAX_CONCURRENT_OPERATIONS=500
MAX_REQUESTS_PER_SECOND=1000
BATCH_FLUSH_INTERVAL_MS=50
