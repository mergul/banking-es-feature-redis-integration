   Compiling banking-es v0.1.0 (/home/mesut/RustroverProjects/banking-es-refactor-cqrs-kafka/banking-es-feature-redis-integration)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 25.21s
     Running unittests src/lib.rs (target/debug/deps/banking_es-68500efa58e3f3c8)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 21 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/debug/deps/banking_es-45ba5b5b3d5b2723)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 21 filtered out; finished in 0.00s

     Running tests/working_stress_test.rs (target/debug/deps/working_stress_test-1da1def40eafcf4d)

running 1 test
🚀 TEST STARTING - Write Batching Multi-Row Insert Test
🚀 Starting Write Batching Multi-Row Insert Test - STEP 1
🚀 Starting Write Batching Multi-Row Insert Test - STEP 2
🔍 Setting up test environment...
🔧 Initializing services using main.rs pattern...
[2m2025-07-30T10:47:11.154609Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m 🔀 Creating partitioned connection pools...
[2m2025-07-30T10:47:11.154947Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m Creating WRITE pool: 300 max connections
[2m2025-07-30T10:47:19.227995Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m Creating READ pool: 300 max connections
[2m2025-07-30T10:47:27.130280Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m ✅ Partitioned connection pools created successfully
[2m2025-07-30T10:47:27.130313Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m    • Write pool: 0/150 connections
[2m2025-07-30T10:47:27.130319Z[0m [32m INFO[0m [2mbanking_es::infrastructure::connection_pool_partitioning[0m[2m:[0m    • Read pool: 0/150 connections
[2m2025-07-30T10:47:27.134335Z[0m [32m INFO[0m [2mbanking_es::infrastructure::init[0m[2m:[0m Initializing services...
[2m2025-07-30T10:47:27.149150Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464d52580    
[2m2025-07-30T10:47:27.149578Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop started    
[2m2025-07-30T10:47:27.151223Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: Creating consumer with config - bootstrap_servers: localhost:9092, group_id: banking-es-group, auto_offset_reset: earliest
[2m2025-07-30T10:47:27.152289Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464d90590    
[2m2025-07-30T10:47:27.152335Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: ✅ Consumer created successfully with group_id: banking-es-group
[2m2025-07-30T10:47:27.152869Z[0m [32m INFO[0m [2mbanking_es::infrastructure::init[0m[2m:[0m All services initialized successfully
✅ All services initialized successfully
[2m2025-07-30T10:47:27.153282Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464dffe20    
[2m2025-07-30T10:47:27.153444Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop started    
[2m2025-07-30T10:47:27.153595Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.153645Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.153755Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.153797Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.153909Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.153942Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154052Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.154089Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154374Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.154412Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154526Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.154563Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154664Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.154695Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154775Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m 🚀 Starting write batching service...
[2m2025-07-30T10:47:27.154808Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m ✅ Write batching service started
[2m2025-07-30T10:47:27.154923Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Destroy ThreadedProducer    
[2m2025-07-30T10:47:27.154947Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Stopping polling    
[2m2025-07-30T10:47:27.154970Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Waiting for polling thread termination    
[2m2025-07-30T10:47:27.253878Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop terminated    
[2m2025-07-30T10:47:27.254233Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling stopped    
[2m2025-07-30T10:47:27.254294Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m ThreadedProducer destroyed    
[2m2025-07-30T10:47:27.254491Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464dffe20    
[2m2025-07-30T10:47:27.255203Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464dffe20    
[2m2025-07-30T10:47:27.255275Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464d8d8c0    
[2m2025-07-30T10:47:27.255302Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464d8d8c0    
[2m2025-07-30T10:47:27.255489Z[0m [32m INFO[0m [2mbanking_es::application::services::cqrs_service[0m[2m:[0m Write batching service is enabled and ready
✅ Write batching service started
🔧 Setting up CDC service manager...
[2m2025-07-30T10:47:27.256342Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464d70ff0    
[2m2025-07-30T10:47:27.256517Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: Creating consumer with config - bootstrap_servers: localhost:9092, group_id: banking-es-group, auto_offset_reset: earliest
[2m2025-07-30T10:47:27.256682Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop started    
[2m2025-07-30T10:47:27.258427Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464e1fa90    
[2m2025-07-30T10:47:27.258593Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: ✅ Consumer created successfully with group_id: banking-es-group
[2m2025-07-30T10:47:27.259036Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Destroying consumer: 0x714464e1fa90    
[2m2025-07-30T10:47:27.359187Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Consumer destroyed: 0x714464e1fa90    
[2m2025-07-30T10:47:27.359271Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464e1fa90    
[2m2025-07-30T10:47:27.360716Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464e1fa90    
[2m2025-07-30T10:47:27.360783Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464d8bdb0    
[2m2025-07-30T10:47:27.360810Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464d8bdb0    
🔧 Starting CDC service manager...
[2m2025-07-30T10:47:27.361451Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager::start() called
[2m2025-07-30T10:47:27.361524Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Starting optimized CDC Service Manager
[2m2025-07-30T10:47:27.361546Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Initializing with config: OptimizationConfig { health_check_interval_secs: 30, cleanup_interval_secs: 3600, metrics_flush_interval_secs: 60, graceful_shutdown_timeout_secs: 30, consumer_backoff_ms: 100, max_retries: 3, circuit_breaker_threshold: 0.1, enable_compression: true, enable_batching: true }
[2m2025-07-30T10:47:27.361583Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Consistency manager is available and set on processor
[2m2025-07-30T10:47:27.361668Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Initializing infrastructure...
[2m2025-07-30T10:47:27.361746Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Initializing infrastructure...
[2m2025-07-30T10:47:27.364744Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 0 started
[2m2025-07-30T10:47:27.364859Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 1 started
[2m2025-07-30T10:47:27.364900Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 2 started
[2m2025-07-30T10:47:27.364926Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 3 started
[2m2025-07-30T10:47:27.364950Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 4 started
[2m2025-07-30T10:47:27.365019Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 5 started
[2m2025-07-30T10:47:27.365063Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 6 started
[2m2025-07-30T10:47:27.365121Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 7 started
[2m2025-07-30T10:47:27.365156Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 8 started
[2m2025-07-30T10:47:27.365182Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 9 started
[2m2025-07-30T10:47:27.365205Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 10 started
[2m2025-07-30T10:47:27.365230Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 11 started
[2m2025-07-30T10:47:27.365253Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 12 started
[2m2025-07-30T10:47:27.365276Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 13 started
[2m2025-07-30T10:47:27.365307Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 14 started
[2m2025-07-30T10:47:27.365387Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 15 started
[2m2025-07-30T10:47:27.365456Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 16 started
[2m2025-07-30T10:47:27.365515Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 17 started
[2m2025-07-30T10:47:27.365597Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 18 started
[2m2025-07-30T10:47:27.365706Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 19 started
[2m2025-07-30T10:47:27.365736Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 20 started
[2m2025-07-30T10:47:27.365761Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 21 started
[2m2025-07-30T10:47:27.365822Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 22 started
[2m2025-07-30T10:47:27.365895Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 23 started
[2m2025-07-30T10:47:27.365967Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 24 started
[2m2025-07-30T10:47:27.366025Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 25 started
[2m2025-07-30T10:47:27.366095Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 26 started
[2m2025-07-30T10:47:27.366170Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 27 started
[2m2025-07-30T10:47:27.366222Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 28 started
[2m2025-07-30T10:47:27.366302Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 29 started
[2m2025-07-30T10:47:27.366363Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 30 started
[2m2025-07-30T10:47:27.366422Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m Optimized batch processor worker 31 started
[2m2025-07-30T10:47:27.366911Z[0m [35mTRACE[0m [2mrdkafka::consumer::stream_consumer[0m[2m:[0m Starting stream consumer wake loop: 0x714464d90590    
[2m2025-07-30T10:47:27.368263Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying topic partition list: 0x714464ec4660    
[2m2025-07-30T10:47:27.368368Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed topic partition list: 0x714464ec4660    
[2m2025-07-30T10:47:27.372174Z[0m [35mTRACE[0m [2mrdkafka::consumer::stream_consumer[0m[2m:[0m Starting stream consumer wake loop: 0x714464e1fa90    
[2m2025-07-30T10:47:27.372313Z[0m [35mTRACE[0m [2mrdkafka::consumer::stream_consumer[0m[2m:[0m Shut down stream consumer wake loop: 0x714464e1fa90    
[2m2025-07-30T10:47:27.377609Z[0m [32m INFO[0m [2mbanking_es::infrastructure::event_store[0m[2m:[0m EventStore Metrics - Processed: 0, Failed: 0, Success: 0%, Batches: 0, Cache Hit Rate: 0%
[2m2025-07-30T10:47:27.377829Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m Projection Metrics - Cache Hit Rate: 0.00%, Batch Updates: 0, Errors: 0, Avg Query Time: 0.00ms
[2m2025-07-30T10:47:27.378010Z[0m [32m INFO[0m [2mbanking_es::infrastructure::repository[0m[2m:[0m Repository Metrics - Cache Hit Rate: 0.0%, Batch Flushes: 0, Events Processed: 0, Errors: 0
[2m2025-07-30T10:47:27.380105Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m Projection Metrics - Cache Hit Rate: 0.00%, Batch Updates: 0, Errors: 0, Avg Query Time: 0.00ms
[2m2025-07-30T10:47:27.388283Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m relation "kafka_outbox_cdc" already exists, skipping
[2m2025-07-30T10:47:27.402810Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT …" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS kafka_outbox_cdc (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  aggregate_id UUID NOT NULL,\n  event_id UUID NOT NULL UNIQUE,\n  event_type VARCHAR(255) NOT NULL,\n  payload BYTEA NOT NULL,\n  topic VARCHAR(255) NOT NULL,\n  metadata JSONB,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n)\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m18.875888ms [3melapsed_secs[0m[2m=[0m0.018875888
[2m2025-07-30T10:47:27.413110Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m relation "idx_outbox_cdc_created_at" already exists, skipping
[2m2025-07-30T10:47:27.414112Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE INDEX IF NOT …" [3mdb.statement[0m[2m=[0m"\n\nCREATE INDEX IF NOT EXISTS idx_outbox_cdc_created_at ON kafka_outbox_cdc(created_at)\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.174455ms [3melapsed_secs[0m[2m=[0m0.007174455
[2m2025-07-30T10:47:27.424343Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m relation "idx_outbox_cdc_aggregate_id" already exists, skipping
[2m2025-07-30T10:47:27.425528Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE INDEX IF NOT …" [3mdb.statement[0m[2m=[0m"\n\nCREATE INDEX IF NOT EXISTS idx_outbox_cdc_aggregate_id ON kafka_outbox_cdc(aggregate_id)\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.869796ms [3melapsed_secs[0m[2m=[0m0.005869796
[2m2025-07-30T10:47:27.431664Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m relation "idx_outbox_cdc_event_id" already exists, skipping
[2m2025-07-30T10:47:27.432856Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE INDEX IF NOT …" [3mdb.statement[0m[2m=[0m"\n\nCREATE INDEX IF NOT EXISTS idx_outbox_cdc_event_id ON kafka_outbox_cdc(event_id)\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.757916ms [3melapsed_secs[0m[2m=[0m0.003757916
[2m2025-07-30T10:47:27.443946Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"ALTER TABLE kafka_outbox_cdc REPLICA …" [3mdb.statement[0m[2m=[0m"\n\nALTER TABLE\n  kafka_outbox_cdc REPLICA IDENTITY FULL\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.136676ms [3melapsed_secs[0m[2m=[0m0.007136676
[2m2025-07-30T10:47:27.444011Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Pre-warming caches...
[2m2025-07-30T10:47:27.444022Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Validating Kafka connectivity...
[2m2025-07-30T10:47:27.444028Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Infrastructure initialized
[2m2025-07-30T10:47:27.444034Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Infrastructure initialized successfully
[2m2025-07-30T10:47:27.444040Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Starting core services...
[2m2025-07-30T10:47:27.444064Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager::start_resilient_consumer() called
[2m2025-07-30T10:47:27.444105Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Starting event processor's batch processor...
[2m2025-07-30T10:47:27.444182Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Batch processor started successfully
[2m2025-07-30T10:47:27.444193Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Event processor's batch processor started successfully
[2m2025-07-30T10:47:27.444209Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: Force starting batch processor...
[2m2025-07-30T10:47:27.444229Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Batch processor force started successfully
[2m2025-07-30T10:47:27.444246Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Core services started
[2m2025-07-30T10:47:27.444266Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Core services started successfully
[2m2025-07-30T10:47:27.444284Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Starting monitoring tasks...
[2m2025-07-30T10:47:27.444334Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Monitoring tasks started
[2m2025-07-30T10:47:27.444353Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Monitoring tasks started successfully
[2m2025-07-30T10:47:27.444376Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager started successfully
[2m2025-07-30T10:47:27.444393Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Service is now RUNNING
✅ CDC Service Manager started
⏳ Waiting for CDC consumer to be ready...
[2m2025-07-30T10:47:27.449689Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: consumer task spawned
[2m2025-07-30T10:47:27.449811Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Consumer: Creating new Kafka consumer instance...
[2m2025-07-30T10:47:27.449827Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Creating Kafka consumer with config - bootstrap_servers: localhost:9092, group_id: banking-es-group, topic_prefix: banking-es
[2m2025-07-30T10:47:27.449853Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: Kafka config created, attempting to create consumer...
[2m2025-07-30T10:47:27.449874Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: Creating consumer with config - bootstrap_servers: localhost:9092, group_id: banking-es-group, auto_offset_reset: earliest
[2m2025-07-30T10:47:27.451223Z[0m [35mTRACE[0m [2mrdkafka::client[0m[2m:[0m Create new librdkafka client 0x714464e9d350    
[2m2025-07-30T10:47:27.451519Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: ✅ Consumer created successfully with group_id: banking-es-group
[2m2025-07-30T10:47:27.451583Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: ✅ Kafka consumer created successfully
[2m2025-07-30T10:47:27.451606Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Consumer: ✅ Successfully created Kafka consumer
[2m2025-07-30T10:47:27.451665Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDCServiceManager: about to enter consumer main loop
[2m2025-07-30T10:47:27.451778Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Entering main polling loop. Active consumers: 1
[2m2025-07-30T10:47:27.451807Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer::start_consuming_with_cancellation_token() called for topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:27.451818Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Starting CDC consumer for topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:27.451827Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Entered start_consuming async loop for topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:27.451838Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Kafka consumer config - enabled: true, group_id: banking-es-group, bootstrap_servers: localhost:9092
[2m2025-07-30T10:47:27.451850Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Subscribing to topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:27.451871Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: subscribe_to_topic - Subscribing to topic: banking-es.public.kafka_outbox_cdc with group_id: banking-es-group
[2m2025-07-30T10:47:27.452037Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying topic partition list: 0x714464e9b830    
[2m2025-07-30T10:47:27.452070Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed topic partition list: 0x714464e9b830    
[2m2025-07-30T10:47:27.452092Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m KafkaConsumer: subscribe_to_topic - Successfully subscribed to topic: banking-es.public.kafka_outbox_cdc with group_id: banking-es-group
[2m2025-07-30T10:47:27.452108Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: ✅ Successfully subscribed to topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:27.452115Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Waiting for consumer to join group...
[2m2025-07-30T10:47:27.452553Z[0m [35mTRACE[0m [2mrdkafka::consumer::stream_consumer[0m[2m:[0m Starting stream consumer wake loop: 0x714464e9d350    
[2m2025-07-30T10:47:27.455497Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Health Check: {"healthy":true,"metrics":{"avg_processing_latency_ms":0,"batches_processed":0,"cache_invalidations":0,"circuit_breaker_trips":0,"consumer_restarts":0,"error_rate_percent":0,"events_failed":0,"events_processed":0,"memory_usage_mb":0,"projection_updates":0,"throughput_per_second":0},"timestamp":"2025-07-30T10:47:27.455449029+00:00"}
[2m2025-07-30T10:47:27.455568Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Cleanup Task: Starting cleanup cycle
[2m2025-07-30T10:47:27.455826Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Metrics: Processed: 0, Failed: 0, Throughput: 0/s, Error Rate: 0%
[2m2025-07-30T10:47:27.465208Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"DELETE FROM kafka_outbox_cdc WHERE …" [3mdb.statement[0m[2m=[0m"\n\nDELETE FROM\n  kafka_outbox_cdc\nWHERE\n  created_at < $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.863391ms [3melapsed_secs[0m[2m=[0m0.006863391
[2m2025-07-30T10:47:27.465334Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Cleanup Task: Cleaned 0 old messages
[2m2025-07-30T10:47:28.175689Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running pre-rebalance with Assign(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:28.175752Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Pre-rebalance: Assign(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:28.175763Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running rebalance with Assign(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:28.176077Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running post-rebalance with Assign(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:28.176130Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Post-rebalance: Assign(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:28.176193Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714448021ba0    
[2m2025-07-30T10:47:28.176222Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714448021ba0    
[2m2025-07-30T10:47:31.184352Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running pre-rebalance with Assign(TPL {})    
[2m2025-07-30T10:47:31.184383Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Pre-rebalance: Assign(TPL {})
[2m2025-07-30T10:47:31.184391Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running rebalance with Assign(TPL {})    
[2m2025-07-30T10:47:31.184465Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running post-rebalance with Assign(TPL {})    
[2m2025-07-30T10:47:31.184501Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Post-rebalance: Assign(TPL {})
[2m2025-07-30T10:47:31.184525Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714448023520    
[2m2025-07-30T10:47:31.184537Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714448023520    
✅ CDC consumer is ready and healthy
🔍 Verifying CDC consumer is actively processing...
[2m2025-07-30T10:47:32.454107Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Consumer group join completed
[2m2025-07-30T10:47:32.454148Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Starting main consumption loop for topic: banking-es.public.kafka_outbox_cdc
[2m2025-07-30T10:47:32.454281Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Using polling interval: 10ms (from CDC_POLL_INTERVAL_MS env var)
[2m2025-07-30T10:47:32.454406Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running pre-rebalance with Assign(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:32.454479Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Pre-rebalance: Assign(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:32.454491Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running rebalance with Assign(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:32.455001Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running post-rebalance with Assign(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:32.455044Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Post-rebalance: Assign(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:32.455128Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714440021680    
[2m2025-07-30T10:47:32.455157Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714440021680    
[2m2025-07-30T10:47:32.460418Z[0m [33m WARN[0m [2mlibrdkafka[0m[2m:[0m librdkafka: OFFSET [thrd:main]: banking-es.public.kafka_outbox_cdc [0]: offset reset (at offset 11 (leader epoch -1), broker 0) to offset BEGINNING (leader epoch -1): fetch failed due to requested offset not available on the broker: Broker: Offset out of range    
[2m2025-07-30T10:47:32.460448Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714440023340    
[2m2025-07-30T10:47:32.460470Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714440023340    
[2m2025-07-30T10:47:32.460515Z[0m [33m WARN[0m [2mlibrdkafka[0m[2m:[0m librdkafka: OFFSET [thrd:main]: banking-es.public.kafka_outbox_cdc [1]: offset reset (at offset 15 (leader epoch -1), broker 0) to offset BEGINNING (leader epoch -1): fetch failed due to requested offset not available on the broker: Broker: Offset out of range    
[2m2025-07-30T10:47:32.460538Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714440023410    
[2m2025-07-30T10:47:32.460563Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714440023410    
[2m2025-07-30T10:47:32.460605Z[0m [33m WARN[0m [2mlibrdkafka[0m[2m:[0m librdkafka: OFFSET [thrd:main]: banking-es.public.kafka_outbox_cdc [2]: offset reset (at offset 24 (leader epoch -1), broker 0) to offset BEGINNING (leader epoch -1): fetch failed due to requested offset not available on the broker: Broker: Offset out of range    
[2m2025-07-30T10:47:32.460636Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144400235e0    
[2m2025-07-30T10:47:32.460662Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144400235e0    
[2m2025-07-30T10:47:34.447653Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Service Manager: ✅ Batch processor is already running
✅ CDC Event Processor with batch processing enabled retrieved
✅ CDC Batch Processor running: true
[2m2025-07-30T10:47:34.447713Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Destroy ThreadedProducer    
[2m2025-07-30T10:47:34.447729Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Stopping polling    
[2m2025-07-30T10:47:34.447743Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Waiting for polling thread termination    
[2m2025-07-30T10:47:34.456910Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop terminated    
[2m2025-07-30T10:47:34.457379Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling stopped    
[2m2025-07-30T10:47:34.457481Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m ThreadedProducer destroyed    
[2m2025-07-30T10:47:34.457678Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464d52580    
[2m2025-07-30T10:47:34.458210Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464d52580    
[2m2025-07-30T10:47:34.458251Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464d4a660    
[2m2025-07-30T10:47:34.458259Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464d4a660    
✅ Write batching test environment setup complete
🔍 Test environment setup successful, proceeding to Phase 1

📝 PHASE 1: Create New Test Accounts with Multi-Aggregate Batching
===================================================================
🔧 Creating 50 new test accounts with batching...
⏱️  Starting account creation timer...
🚀 Submitting all 50 operations simultaneously...
🔍 Getting write batching service...
✅ Write batching service found
🔍 About to submit 50 operations...
🔍 Submitting operation 0 for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc
🔍 [WriteBatchingService] Submitting operation 5ff2d4d9-b021-4f6c-a299-cf7ac4f917f1 for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.306575652s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 1 for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
🔍 [WriteBatchingService] Submitting operation 87261775-eff0-4c15-9003-4b78537dcd30 for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
🔍 Batch now has 1 operations, max_size: 100, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.307088101s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 2 for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f
🔍 [WriteBatchingService] Submitting operation 790cf96e-23ca-4ed6-a37a-a5e6cad5b412 for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f
🔍 Batch now has 1 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 97.682µs
🔍 Operation 2 result: Ok(790cf96e-23ca-4ed6-a37a-a5e6cad5b412)
🔍 Submitting operation 3 for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
🔍 [WriteBatchingService] Submitting operation 35d4f72e-a1f5-41f1-9fb8-8384ac97a537 for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.306291781s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 4 for aggregate cce69089-c607-40e6-9437-d36c2bd44cef
🔍 [WriteBatchingService] Submitting operation 4aca1f31-ac2e-4b29-a7e3-dcefb0badb57 for aggregate cce69089-c607-40e6-9437-d36c2bd44cef
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.306841038s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 5 for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2
🔍 [WriteBatchingService] Submitting operation f41f6422-17cf-42e9-aec1-c29b83633c53 for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.30661294s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 6 for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2
🔍 [WriteBatchingService] Submitting operation dd31aa1d-a268-4a8b-9589-50b63f44a364 for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 372.44µs
🔍 Operation 6 result: Ok(dd31aa1d-a268-4a8b-9589-50b63f44a364)
🔍 Submitting operation 7 for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
🔍 [WriteBatchingService] Submitting operation d8c4a725-cfdf-452d-a7db-d46b489b771f for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
🔍 Batch now has 2 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 616.924µs
🔍 Operation 7 result: Ok(d8c4a725-cfdf-452d-a7db-d46b489b771f)
🔍 Submitting operation 8 for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314
🔍 [WriteBatchingService] Submitting operation e1b6e91f-8369-4dc9-891a-93aa8d0cbf88 for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.30662304s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 9 for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4
🔍 [WriteBatchingService] Submitting operation e5e0092d-3682-473e-a2f8-563557e40eff for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 70.881µs
🔍 Operation 9 result: Ok(e5e0092d-3682-473e-a2f8-563557e40eff)
🔍 Submitting operation 10 for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e
🔍 [WriteBatchingService] Submitting operation 87b7a7bb-e076-4911-9a78-de65ba945b43 for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.307664611s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 11 for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432
🔍 [WriteBatchingService] Submitting operation e1230702-1c2b-4a65-b867-37ee0e9f6900 for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432
🔍 Batch now has 3 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 883.733µs
🔍 Operation 11 result: Ok(e1230702-1c2b-4a65-b867-37ee0e9f6900)
🔍 Submitting operation 12 for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c
🔍 [WriteBatchingService] Submitting operation b5e02400-42f9-436b-9ec2-553c4578bebe for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 566.23µs
🔍 Operation 12 result: Ok(b5e02400-42f9-436b-9ec2-553c4578bebe)
🔍 Submitting operation 13 for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f
🔍 [WriteBatchingService] Submitting operation 5262569e-cb64-4d05-9666-0a0fde4d4a49 for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
📦 Processing write batch: 1 operations (full: false, old: true), age: 7.306803401s
🔄 Starting batch processing with distributed locking...
🔍 Submitting operation 14 for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f
🔍 [WriteBatchingService] Submitting operation e0f19fa3-def1-4768-b32c-aaa8d8af68d7 for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 1.181544ms
🔍 Operation 14 result: Ok(e0f19fa3-def1-4768-b32c-aaa8d8af68d7)
🔍 Submitting operation 15 for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252
🔍 [WriteBatchingService] Submitting operation b5240d0b-3b43-4706-a5d8-841c6ca520e9 for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 997.216µs
🔍 Operation 15 result: Ok(b5240d0b-3b43-4706-a5d8-841c6ca520e9)
🔍 Submitting operation 16 for aggregate 1e66be70-e791-4039-8fd6-84d172418be7
🔍 [WriteBatchingService] Submitting operation 9cd199d4-8cc4-43d1-9ef9-e94ad2629c61 for aggregate 1e66be70-e791-4039-8fd6-84d172418be7
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 733.605µs
🔍 Operation 16 result: Ok(9cd199d4-8cc4-43d1-9ef9-e94ad2629c61)
🔍 Submitting operation 17 for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4
🔍 [WriteBatchingService] Submitting operation 48eebb51-7740-45ad-a39c-5ce8408c519a for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 465.255µs
🔍 Operation 17 result: Ok(48eebb51-7740-45ad-a39c-5ce8408c519a)
🔍 Submitting operation 18 for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2
🔍 [WriteBatchingService] Submitting operation 813a0fed-5141-439a-b2fe-518dd7777918 for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 824.324µs
🔍 Operation 18 result: Ok(813a0fed-5141-439a-b2fe-518dd7777918)
🔍 Submitting operation 19 for aggregate 83985b20-c135-4923-a1b2-1ca795622186
🔍 [WriteBatchingService] Submitting operation 8a2f4100-0cc2-4374-a8e3-67cc1b2cf0e7 for aggregate 83985b20-c135-4923-a1b2-1ca795622186
🔍 Batch now has 4 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 866.659µs
🔍 Operation 19 result: Ok(8a2f4100-0cc2-4374-a8e3-67cc1b2cf0e7)
🔍 Submitting operation 20 for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0
🔍 [WriteBatchingService] Submitting operation b33d11e9-d709-45a3-a239-9be02bab6fc2 for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 1.222944ms
🔍 Operation 20 result: Ok(b33d11e9-d709-45a3-a239-9be02bab6fc2)
🔍 Submitting operation 21 for aggregate 95295434-12fb-4e71-844f-b0e41f005d18
🔍 [WriteBatchingService] Submitting operation 51f91105-8fe9-4375-8015-2a449511e4d0 for aggregate 95295434-12fb-4e71-844f-b0e41f005d18
🔍 Batch now has 5 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 5 operations, age: 961.63µs
🔍 Operation 21 result: Ok(51f91105-8fe9-4375-8015-2a449511e4d0)
🔍 Submitting operation 22 for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279
🔍 [WriteBatchingService] Submitting operation eab68380-1af0-4c85-85cb-4e957788cc0a for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 877.811µs
🔍 Operation 22 result: Ok(eab68380-1af0-4c85-85cb-4e957788cc0a)
🔍 Submitting operation 23 for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13
🔍 [WriteBatchingService] Submitting operation b2ebc53b-cd54-47d6-85c4-7418986cbe3e for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13
🔍 Batch now has 4 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 1.7226ms
🔍 Operation 23 result: Ok(b2ebc53b-cd54-47d6-85c4-7418986cbe3e)
🔍 Submitting operation 24 for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50
🔍 [WriteBatchingService] Submitting operation 4e3fd82f-c7b5-4d6b-bd74-22f75735eb59 for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 964.156µs
🔍 Operation 24 result: Ok(4e3fd82f-c7b5-4d6b-bd74-22f75735eb59)
🔍 Submitting operation 25 for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37
🔍 [WriteBatchingService] Submitting operation fe474a7f-b6dc-4429-b312-a47a69a92f84 for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 1.612886ms
🔍 Operation 25 result: Ok(fe474a7f-b6dc-4429-b312-a47a69a92f84)
🔍 Submitting operation 26 for aggregate 934002d1-3696-455e-95d3-29b1fd549c06
🔍 [WriteBatchingService] Submitting operation e4789d4c-9f99-48b4-8874-762922a6bb60 for aggregate 934002d1-3696-455e-95d3-29b1fd549c06
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 1.055254ms
🔍 Operation 26 result: Ok(e4789d4c-9f99-48b4-8874-762922a6bb60)
🔍 Submitting operation 27 for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847
🔍 [WriteBatchingService] Submitting operation a9f78982-3b5c-43cb-9fd9-a47ab6d5b739 for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 2.029718ms
🔍 Operation 27 result: Ok(a9f78982-3b5c-43cb-9fd9-a47ab6d5b739)
🔍 Submitting operation 28 for aggregate 3f158540-6f31-4847-911a-10d513334c6e
🔍 [WriteBatchingService] Submitting operation 831d5f63-8cff-403d-a93a-d72be2d98ffc for aggregate 3f158540-6f31-4847-911a-10d513334c6e
🔍 Batch now has 4 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 1.584455ms
🔍 Operation 28 result: Ok(831d5f63-8cff-403d-a93a-d72be2d98ffc)
🔍 Submitting operation 29 for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73
🔍 [WriteBatchingService] Submitting operation 60cca070-1de8-4072-85a3-31dd57ab0a2c for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 1.005455ms
🔍 Operation 29 result: Ok(60cca070-1de8-4072-85a3-31dd57ab0a2c)
🔍 Submitting operation 30 for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
🔍 [WriteBatchingService] Submitting operation 3af47da4-095b-4924-928e-16ff26a89176 for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 1.05187ms
🔍 Operation 30 result: Ok(3af47da4-095b-4924-928e-16ff26a89176)
🔍 Submitting operation 31 for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae
🔍 [WriteBatchingService] Submitting operation 7217e2cc-e928-42a0-94c2-a2a6fe40b80e for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae
🔍 Batch now has 5 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 5 operations, age: 2.095679ms
🔍 Operation 31 result: Ok(7217e2cc-e928-42a0-94c2-a2a6fe40b80e)
🔍 Submitting operation 32 for aggregate e527021e-2239-422d-b558-f698ec838ab1
🔍 [WriteBatchingService] Submitting operation ba49b2a9-df71-43c3-bda3-4e09b5224a01 for aggregate e527021e-2239-422d-b558-f698ec838ab1
🔍 Batch now has 4 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 1.153943ms
🔍 Operation 32 result: Ok(ba49b2a9-df71-43c3-bda3-4e09b5224a01)
🔍 Submitting operation 33 for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d
🔍 [WriteBatchingService] Submitting operation eedac0f7-dd08-4990-b3fc-bcbd5318efe6 for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d
🔍 Batch now has 5 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 5 operations, age: 1.197049ms
🔍 Operation 33 result: Ok(eedac0f7-dd08-4990-b3fc-bcbd5318efe6)
🔍 Submitting operation 34 for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
🔍 [WriteBatchingService] Submitting operation 767c4c19-09c5-42b2-8ca5-b2b184c81a3c for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
🔍 Batch now has 5 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 5 operations, age: 1.864541ms
🔍 Operation 34 result: Ok(767c4c19-09c5-42b2-8ca5-b2b184c81a3c)
🔍 Submitting operation 35 for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31
🔍 [WriteBatchingService] Submitting operation e7818fba-e54b-4021-a954-f5887996a888 for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31
🔍 Batch now has 4 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 1.470927ms
🔍 Operation 35 result: Ok(e7818fba-e54b-4021-a954-f5887996a888)
🔍 Submitting operation 36 for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5
🔍 [WriteBatchingService] Submitting operation f880cac3-8bf2-457d-90fe-f2522f23a908 for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5
🔍 Batch now has 6 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 6 operations, age: 1.408497ms
🔍 Operation 36 result: Ok(f880cac3-8bf2-457d-90fe-f2522f23a908)
🔍 Submitting operation 37 for aggregate 0341015a-b267-467c-b005-6094bbabfeaf
🔍 [WriteBatchingService] Submitting operation 61f9068f-d71b-467d-8b7f-9c16bccafb31 for aggregate 0341015a-b267-467c-b005-6094bbabfeaf
🔍 Batch now has 1 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 1 operations, age: 2.168515ms
🔍 Operation 37 result: Ok(61f9068f-d71b-467d-8b7f-9c16bccafb31)
🔍 Submitting operation 38 for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802
🔍 [WriteBatchingService] Submitting operation 9164ef98-64a8-4db2-8622-4c85c338a46a for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 2.294955ms
🔍 Operation 38 result: Ok(9164ef98-64a8-4db2-8622-4c85c338a46a)
🔍 Submitting operation 39 for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa
🔍 [WriteBatchingService] Submitting operation 71db7286-47fc-46ee-a189-403b35d3ee67 for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa
🔍 Batch now has 5 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 5 operations, age: 1.735792ms
🔍 Operation 39 result: Ok(71db7286-47fc-46ee-a189-403b35d3ee67)
🔍 Submitting operation 40 for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
🔍 [WriteBatchingService] Submitting operation 50146246-b3cf-4891-9ae0-aa25dc66f79e for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
🔍 Batch now has 2 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 2 operations, age: 2.30757ms
🔍 Operation 40 result: Ok(50146246-b3cf-4891-9ae0-aa25dc66f79e)
🔍 Submitting operation 41 for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f
🔍 [WriteBatchingService] Submitting operation 90df3fb4-efe3-4409-922b-1ff9ee8bd2a6 for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f
🔍 Batch now has 6 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 6 operations, age: 2.28226ms
🔍 Operation 41 result: Ok(90df3fb4-efe3-4409-922b-1ff9ee8bd2a6)
🔍 Submitting operation 42 for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd
🔍 [WriteBatchingService] Submitting operation f1254291-8f39-4263-8972-697bc9d01859 for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd
🔍 Batch now has 4 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 4 operations, age: 2.497111ms
🔍 Operation 42 result: Ok(f1254291-8f39-4263-8972-697bc9d01859)
🔍 Submitting operation 43 for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb
🔍 [WriteBatchingService] Submitting operation 7a575c34-50f7-446e-a922-33264b89488f for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 2.463987ms
🔍 Operation 43 result: Ok(7a575c34-50f7-446e-a922-33264b89488f)
🔍 Submitting operation 44 for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654
🔍 [WriteBatchingService] Submitting operation 10d3001d-1012-4e9b-bb75-4e01cd992e18 for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654
🔍 Batch now has 3 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 3 operations, age: 2.911684ms
🔍 Operation 44 result: Ok(10d3001d-1012-4e9b-bb75-4e01cd992e18)
🔍 Submitting operation 45 for aggregate 008eed35-a97e-4648-983b-539a104fa6fa
🔍 [WriteBatchingService] Submitting operation ef64ce7a-c00e-40a1-ba2d-debef8ed6716 for aggregate 008eed35-a97e-4648-983b-539a104fa6fa
🔍 Batch now has 7 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 7 operations, age: 2.469098ms
🔍 Operation 45 result: Ok(ef64ce7a-c00e-40a1-ba2d-debef8ed6716)
🔍 Submitting operation 46 for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7
🔍 [WriteBatchingService] Submitting operation 846111ca-e6d0-4c68-ac6f-eccc68714efd for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7
🔍 Batch now has 6 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 6 operations, age: 2.201691ms
🔍 Operation 46 result: Ok(846111ca-e6d0-4c68-ac6f-eccc68714efd)
🔍 Submitting operation 47 for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
🔍 [WriteBatchingService] Submitting operation 8db16f33-94fb-4475-a632-2ef9bb38e315 for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
🔍 Batch now has 6 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 6 operations, age: 2.917539ms
🔍 Operation 47 result: Ok(8db16f33-94fb-4475-a632-2ef9bb38e315)
🔍 Submitting operation 48 for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c
🔍 [WriteBatchingService] Submitting operation eabdd7ba-f71f-4399-a305-1e71e60ab794 for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c
🔍 Batch now has 7 operations, max_size: 100, max_wait_time: 100ms
⏳ Batch not ready yet: 7 operations, age: 3.134065ms
🔍 Operation 48 result: Ok(eabdd7ba-f71f-4399-a305-1e71e60ab794)
🔍 Submitting operation 49 for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
🔍 [WriteBatchingService] Submitting operation 23d99894-6e64-4e26-9415-01d4fb79f446 for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
🔍 Batch now has 8 operations, max_size: 50, max_wait_time: 100ms
⏳ Batch not ready yet: 8 operations, age: 2.815236ms
🔍 Operation 49 result: Ok(23d99894-6e64-4e26-9415-01d4fb79f446)
🔍 Adding lock command for key: lock:aggregate:9f42ccc5-8766-4904-94ab-030dd75e9abc
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
🔍 Executing batch lock pipeline with 1 commands
[2m2025-07-30T10:47:34.470834Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470855Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=7, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.470876Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470882Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=5, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.470896Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470902Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=3, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.470919Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470924Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=3, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.470939Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470953Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=8, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.470988Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.470997Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=4, is_full=false, is_old=false, should_process=false
[2m2025-07-30T10:47:34.471013Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.471028Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=6, is_full=false, is_old=false, should_process=false
🔍 Adding lock command for key: lock:aggregate:693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:cce69089-c607-40e6-9437-d36c2bd44cef
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:cb146a59-24f7-4da9-b46c-0bd86e4e5314
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:8d973005-da14-446b-b507-7f6e9cd4399e
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:94f664e3-df24-405e-8033-914fa42fc6d2
🔍 Executing batch lock pipeline with 1 commands
🔍 Adding lock command for key: lock:aggregate:2b7940e6-3f66-4d87-a21f-63976829668f
🔍 Executing batch lock pipeline with 1 commands
[2m2025-07-30T10:47:34.474044Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.474079Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=6, is_full=false, is_old=false, should_process=false
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.477802Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478122Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478272Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478412Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate cce69089-c607-40e6-9437-d36c2bd44cef (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478555Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478703Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478833Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
🔍 Received 1 pipeline results
🔍 Result 0: OK, success: true
🔍 Batch lock acquisition completed: 1/1 successful
[2m2025-07-30T10:47:34.478988Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 1/1 successful
🔒 Acquired lock for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (batch mode)
📦 Processing 1 locked operations in batch
[DEBUG] execute_batch: Starting batch with 1 operations
[2m2025-07-30T10:47:34.481765Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.481929Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482058Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482183Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482313Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482440Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482576Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.482723Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 1 events and 1 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 1 aggregates
[2m2025-07-30T10:47:34.489179Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.868835ms [3melapsed_secs[0m[2m=[0m0.006868835
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (AccountCreated event)
[2m2025-07-30T10:47:34.489802Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.430016ms [3melapsed_secs[0m[2m=[0m0.007430016
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (AccountCreated event)
[2m2025-07-30T10:47:34.490445Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.898875ms [3melapsed_secs[0m[2m=[0m0.007898875
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate cce69089-c607-40e6-9437-d36c2bd44cef (AccountCreated event)
[2m2025-07-30T10:47:34.491043Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.42504ms [3melapsed_secs[0m[2m=[0m0.00842504
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (AccountCreated event)
[2m2025-07-30T10:47:34.491640Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.887365ms [3melapsed_secs[0m[2m=[0m0.008887365
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (AccountCreated event)
[2m2025-07-30T10:47:34.492237Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.358752ms [3melapsed_secs[0m[2m=[0m0.009358752
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (AccountCreated event)
[2m2025-07-30T10:47:34.492831Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.808616ms [3melapsed_secs[0m[2m=[0m0.009808616
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (AccountCreated event)
[2m2025-07-30T10:47:34.493414Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m10.249246ms [3melapsed_secs[0m[2m=[0m0.010249246
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 1 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 1 events
🔍 [DEBUG] Skipping version check for new aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (AccountCreated event)
[2m2025-07-30T10:47:34.505459Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.940596ms [3melapsed_secs[0m[2m=[0m0.009940596
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.508931Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m15.503166ms [3melapsed_secs[0m[2m=[0m0.015503166
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.511856Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m15.61437ms [3melapsed_secs[0m[2m=[0m0.01561437
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.517583Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m22.126752ms [3melapsed_secs[0m[2m=[0m0.022126752
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.521194Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m25.367175ms [3melapsed_secs[0m[2m=[0m0.025367175
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.524328Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m32.249259ms [3melapsed_secs[0m[2m=[0m0.032249259
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.528002Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m33.396426ms [3melapsed_secs[0m[2m=[0m0.033396426
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.533746Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m35.936871ms [3melapsed_secs[0m[2m=[0m0.035936871
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.536562Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m30.912503ms [3melapsed_secs[0m[2m=[0m0.030912503
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314, event_id=f09c5be9-0147-4e77-90dd-df4506f34a7d
[2m2025-07-30T10:47:34.536720Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.537434Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m28.437826ms [3melapsed_secs[0m[2m=[0m0.028437826
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=cce69089-c607-40e6-9437-d36c2bd44cef, event_id=a0ccef75-f4ff-4ab1-b7f7-a398a102e455
[2m2025-07-30T10:47:34.537485Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.537641Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m25.725231ms [3melapsed_secs[0m[2m=[0m0.025725231
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=2b7940e6-3f66-4d87-a21f-63976829668f, event_id=3ded4f61-aa21-4bfa-84fd-23be48a0f555
[2m2025-07-30T10:47:34.537701Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.537841Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m19.861761ms [3melapsed_secs[0m[2m=[0m0.019861761
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, event_id=e518e474-b74f-4c88-bff8-528394fe4fdc
[2m2025-07-30T10:47:34.537898Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.538038Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m16.748631ms [3melapsed_secs[0m[2m=[0m0.016748631
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=94f664e3-df24-405e-8033-914fa42fc6d2, event_id=b371dcf2-ba13-4ce0-8660-b64f1b88a736
[2m2025-07-30T10:47:34.538083Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.538220Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.824375ms [3melapsed_secs[0m[2m=[0m0.013824375
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=9f42ccc5-8766-4904-94ab-030dd75e9abc, event_id=1222f767-effd-46a9-a43c-387f349a8eb4
[2m2025-07-30T10:47:34.538280Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.538441Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m10.356707ms [3melapsed_secs[0m[2m=[0m0.010356707
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, event_id=466480b3-6fe1-4fae-b949-151617adfc9a
[2m2025-07-30T10:47:34.538510Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[2m2025-07-30T10:47:34.538668Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.798636ms [3melapsed_secs[0m[2m=[0m0.004798636
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=8d973005-da14-446b-b507-7f6e9cd4399e, event_id=f84ba3de-46cf-484c-9ebc-2752aa49eefc
[2m2025-07-30T10:47:34.538718Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 1 operations, 1 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 1 results
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[2m2025-07-30T10:47:34.542840Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 8 result: Ok(e1b6e91f-8369-4dc9-891a-93aa8d0cbf88)
[2m2025-07-30T10:47:34.542925Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 4 result: Ok(4aca1f31-ac2e-4b29-a7e3-dcefb0badb57)
[2m2025-07-30T10:47:34.542988Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 13 result: Ok(5262569e-cb64-4d05-9666-0a0fde4d4a49)
[2m2025-07-30T10:47:34.543056Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 1 result: Ok(87261775-eff0-4c15-9003-4b78537dcd30)
[2m2025-07-30T10:47:34.543106Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 5 result: Ok(f41f6422-17cf-42e9-aec1-c29b83633c53)
[2m2025-07-30T10:47:34.543170Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 0 result: Ok(5ff2d4d9-b021-4f6c-a299-cf7ac4f917f1)
[2m2025-07-30T10:47:34.543230Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 3 result: Ok(35d4f72e-a1f5-41f1-9fb8-8384ac97a537)
[2m2025-07-30T10:47:34.543292Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 1 locks in batch
🔍 Operation 10 result: Ok(87b7a7bb-e076-4911-9a78-de65ba945b43)
✅ Submitted 50 operations for batching
⏳ Waiting for all operations to complete...
[2m2025-07-30T10:47:34.543802Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.543969Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544109Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544243Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544373Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544516Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544671Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.544813Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.560322Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.21467ms [3melapsed_secs[0m[2m=[0m0.00821467
[2m2025-07-30T10:47:34.560400Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 15.721555ms
[2m2025-07-30T10:47:34.560827Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m366.441µs [3melapsed_secs[0m[2m=[0m0.000366441
[2m2025-07-30T10:47:34.560921Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 21.067974ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.569879Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m16.902378ms [3melapsed_secs[0m[2m=[0m0.016902378
[2m2025-07-30T10:47:34.569950Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 25.840202ms
[2m2025-07-30T10:47:34.576703Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m26.276757ms [3melapsed_secs[0m[2m=[0m0.026276757
[2m2025-07-30T10:47:34.576753Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 32.783983ms
[2m2025-07-30T10:47:34.584794Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m32.753948ms [3melapsed_secs[0m[2m=[0m0.032753948
[2m2025-07-30T10:47:34.584878Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 40.629855ms
[2m2025-07-30T10:47:34.591889Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m41.431412ms [3melapsed_secs[0m[2m=[0m0.041431412
[2m2025-07-30T10:47:34.591940Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 48.141312ms
[2m2025-07-30T10:47:34.600317Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m48.184666ms [3melapsed_secs[0m[2m=[0m0.048184666
[2m2025-07-30T10:47:34.600382Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 56.008925ms
[2m2025-07-30T10:47:34.607318Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m55.91104ms [3melapsed_secs[0m[2m=[0m0.05591104
[2m2025-07-30T10:47:34.607403Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 62.590961ms
[2m2025-07-30T10:47:34.614899Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m63.132276ms [3melapsed_secs[0m[2m=[0m0.063132276
[2m2025-07-30T10:47:34.615172Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 70.633869ms
[2m2025-07-30T10:47:34.616042Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m46.012066ms [3melapsed_secs[0m[2m=[0m0.046012066
[2m2025-07-30T10:47:34.616188Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 76.691767ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.616341Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m39.54468ms [3melapsed_secs[0m[2m=[0m0.03954468
[2m2025-07-30T10:47:34.616379Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 76.992349ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.616474Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m31.5282ms [3melapsed_secs[0m[2m=[0m0.0315282
[2m2025-07-30T10:47:34.616534Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 76.948621ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.616648Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m24.668209ms [3melapsed_secs[0m[2m=[0m0.024668209
[2m2025-07-30T10:47:34.616685Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 77.611446ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.617505Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.617521Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=7, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
🔍 Adding lock command for key: lock:aggregate:f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
🔍 Adding lock command for key: lock:aggregate:5591cc7a-5bfa-49d2-bda8-7e9c78197432
🔍 Adding lock command for key: lock:aggregate:15aecab1-20c2-4ee4-9b64-a980a9a341ae
🔍 Adding lock command for key: lock:aggregate:c4897ec9-f2ac-45df-aefa-9326bfac6a2f
🔍 Adding lock command for key: lock:aggregate:d23dfd52-c53e-41ff-ad59-84ce50361f13
🔍 Adding lock command for key: lock:aggregate:34068678-f78f-4c4e-897a-320e1e1ef98c
🔍 Executing batch lock pipeline with 7 commands
[2m2025-07-30T10:47:34.617754Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.617771Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=5, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:b9d64fad-b777-4586-afbd-9857b52c8c50
🔍 Adding lock command for key: lock:aggregate:19e6eb70-d640-4aa4-87b1-07a148f1c279
🔍 Adding lock command for key: lock:aggregate:934002d1-3696-455e-95d3-29b1fd549c06
🔍 Adding lock command for key: lock:aggregate:550123b2-bf64-4afb-a6b1-b8d34120defa
🔍 Adding lock command for key: lock:aggregate:43940fcc-f74b-426f-a97b-2574764a7e31
🔍 Executing batch lock pipeline with 5 commands
[2m2025-07-30T10:47:34.617937Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.617957Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=3, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:76712f66-7c6a-4f2a-a27b-b088343a009f
🔍 Adding lock command for key: lock:aggregate:b44cb9ca-2459-42f3-b1ed-f384936e1654
🔍 Adding lock command for key: lock:aggregate:82a28ae2-091a-4d48-b74d-6a26967b6847
🔍 Executing batch lock pipeline with 3 commands
[2m2025-07-30T10:47:34.618084Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.618102Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=3, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:0341015a-b267-467c-b005-6094bbabfeaf
🔍 Adding lock command for key: lock:aggregate:ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
🔍 Adding lock command for key: lock:aggregate:c987ee59-e277-49cc-8759-ae6fa80c36bb
🔍 Executing batch lock pipeline with 3 commands
[2m2025-07-30T10:47:34.618229Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.618249Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=8, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:de7c59df-e67a-4ecb-bc69-ddd631c84c9f
🔍 Adding lock command for key: lock:aggregate:8b39b03e-62d5-47a2-85d0-4c7d6160a252
🔍 Adding lock command for key: lock:aggregate:008eed35-a97e-4648-983b-539a104fa6fa
🔍 Adding lock command for key: lock:aggregate:d1b755fc-6266-414c-ab59-ab599dac5a5c
🔍 Adding lock command for key: lock:aggregate:3f158540-6f31-4847-911a-10d513334c6e
🔍 Adding lock command for key: lock:aggregate:99d9d236-1b1e-4b04-82e3-fdd8c20144d7
🔍 Adding lock command for key: lock:aggregate:8d7de81d-5f6a-4204-811b-86a77fbc34e0
🔍 Adding lock command for key: lock:aggregate:74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
🔍 Executing batch lock pipeline with 8 commands
[2m2025-07-30T10:47:34.618467Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.618484Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=4, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:3f72cff7-d030-48d3-bcef-fc8bc53d1802
🔍 Adding lock command for key: lock:aggregate:b89811b8-79a0-444b-b81c-b5d1318fcf37
🔍 Adding lock command for key: lock:aggregate:f28b281d-1783-4d9d-989e-dbf9ed9130cd
🔍 Adding lock command for key: lock:aggregate:cffce9cb-b536-4cf4-9578-ac63bf4d41b2
🔍 Executing batch lock pipeline with 4 commands
[2m2025-07-30T10:47:34.618706Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.618724Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=6, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:83985b20-c135-4923-a1b2-1ca795622186
🔍 Adding lock command for key: lock:aggregate:6123ee1b-78cb-4996-98dc-801c2cbac2b2
🔍 Adding lock command for key: lock:aggregate:95295434-12fb-4e71-844f-b0e41f005d18
🔍 Adding lock command for key: lock:aggregate:1e66be70-e791-4039-8fd6-84d172418be7
🔍 Adding lock command for key: lock:aggregate:bba216de-b846-46ca-a2e0-a248fa9481e4
🔍 Adding lock command for key: lock:aggregate:2fb0c79f-18dd-49bd-94ec-24980172faf7
🔍 Executing batch lock pipeline with 6 commands
[2m2025-07-30T10:47:34.618891Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch processor interval tick
[2m2025-07-30T10:47:34.618908Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [WriteBatchingService] Batch status: size=6, is_full=false, is_old=true, should_process=true
🔄 Starting batch processing with distributed locking...
🔍 Adding lock command for key: lock:aggregate:2fed6150-edc2-4f35-92e2-2653975a4ab4
🔍 Adding lock command for key: lock:aggregate:e527021e-2239-422d-b558-f698ec838ab1
🔍 Adding lock command for key: lock:aggregate:cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
🔍 Adding lock command for key: lock:aggregate:acf0ba30-0efb-4b8c-9842-f6033fbfc84d
🔍 Adding lock command for key: lock:aggregate:8a1e00f0-1597-4259-8059-0e75d4a854a5
🔍 Adding lock command for key: lock:aggregate:7186dfcc-e470-4997-ba8a-d80f3f3dac73
🔍 Executing batch lock pipeline with 6 commands
[2m2025-07-30T10:47:34.620715Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m20.258918ms [3melapsed_secs[0m[2m=[0m0.020258918
[2m2025-07-30T10:47:34.620808Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 81.12454ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.620921Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.471414ms [3melapsed_secs[0m[2m=[0m0.013471414
[2m2025-07-30T10:47:34.620987Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 81.024394ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.621074Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.703171ms [3melapsed_secs[0m[2m=[0m0.005703171
[2m2025-07-30T10:47:34.621128Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 81.364354ms
[DEBUG] OutboxBatcher::flush: Flush complete
🔍 Received 7 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Result 4: OK, success: true
🔍 Result 5: OK, success: true
🔍 Result 6: OK, success: true
🔍 Batch lock acquisition completed: 7/7 successful
[2m2025-07-30T10:47:34.623114Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 7/7 successful
🔒 Acquired lock for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (batch mode)
🔒 Acquired lock for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (batch mode)
🔒 Acquired lock for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (batch mode)
🔒 Acquired lock for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (batch mode)
🔒 Acquired lock for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (batch mode)
🔒 Acquired lock for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (batch mode)
🔒 Acquired lock for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (batch mode)
📦 Processing 7 locked operations in batch
[DEBUG] execute_batch: Starting batch with 7 operations
🔍 Received 5 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Result 4: OK, success: true
🔍 Batch lock acquisition completed: 5/5 successful
[2m2025-07-30T10:47:34.623376Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 5/5 successful
🔒 Acquired lock for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (batch mode)
🔒 Acquired lock for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (batch mode)
🔒 Acquired lock for aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (batch mode)
🔒 Acquired lock for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (batch mode)
🔒 Acquired lock for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (batch mode)
📦 Processing 5 locked operations in batch
[DEBUG] execute_batch: Starting batch with 5 operations
🔍 Received 3 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Batch lock acquisition completed: 3/3 successful
[2m2025-07-30T10:47:34.623551Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 3/3 successful
🔒 Acquired lock for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (batch mode)
🔒 Acquired lock for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (batch mode)
🔒 Acquired lock for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (batch mode)
📦 Processing 3 locked operations in batch
[DEBUG] execute_batch: Starting batch with 3 operations
🔍 Received 3 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Batch lock acquisition completed: 3/3 successful
[2m2025-07-30T10:47:34.623730Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 3/3 successful
🔒 Acquired lock for aggregate 0341015a-b267-467c-b005-6094bbabfeaf (batch mode)
🔒 Acquired lock for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (batch mode)
🔒 Acquired lock for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (batch mode)
📦 Processing 3 locked operations in batch
[DEBUG] execute_batch: Starting batch with 3 operations
🔍 Received 8 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Result 4: OK, success: true
🔍 Result 5: OK, success: true
🔍 Result 6: OK, success: true
🔍 Result 7: OK, success: true
🔍 Batch lock acquisition completed: 8/8 successful
[2m2025-07-30T10:47:34.623911Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 8/8 successful
🔒 Acquired lock for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (batch mode)
🔒 Acquired lock for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (batch mode)
🔒 Acquired lock for aggregate 008eed35-a97e-4648-983b-539a104fa6fa (batch mode)
🔒 Acquired lock for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (batch mode)
🔒 Acquired lock for aggregate 3f158540-6f31-4847-911a-10d513334c6e (batch mode)
🔒 Acquired lock for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (batch mode)
🔒 Acquired lock for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (batch mode)
🔒 Acquired lock for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (batch mode)
📦 Processing 8 locked operations in batch
[DEBUG] execute_batch: Starting batch with 8 operations
🔍 Received 4 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Batch lock acquisition completed: 4/4 successful
[2m2025-07-30T10:47:34.624093Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 4/4 successful
🔒 Acquired lock for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (batch mode)
🔒 Acquired lock for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (batch mode)
🔒 Acquired lock for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (batch mode)
🔒 Acquired lock for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (batch mode)
📦 Processing 4 locked operations in batch
[DEBUG] execute_batch: Starting batch with 4 operations
🔍 Received 6 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Result 4: OK, success: true
🔍 Result 5: OK, success: true
🔍 Batch lock acquisition completed: 6/6 successful
[2m2025-07-30T10:47:34.624272Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 6/6 successful
🔒 Acquired lock for aggregate 83985b20-c135-4923-a1b2-1ca795622186 (batch mode)
🔒 Acquired lock for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (batch mode)
🔒 Acquired lock for aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (batch mode)
🔒 Acquired lock for aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (batch mode)
🔒 Acquired lock for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (batch mode)
🔒 Acquired lock for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (batch mode)
📦 Processing 6 locked operations in batch
[DEBUG] execute_batch: Starting batch with 6 operations
🔍 Received 6 pipeline results
🔍 Result 0: OK, success: true
🔍 Result 1: OK, success: true
🔍 Result 2: OK, success: true
🔍 Result 3: OK, success: true
🔍 Result 4: OK, success: true
🔍 Result 5: OK, success: true
🔍 Batch lock acquisition completed: 6/6 successful
[2m2025-07-30T10:47:34.624446Z[0m [32m INFO[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 📦 Batch lock acquisition completed: 6/6 successful
🔒 Acquired lock for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (batch mode)
🔒 Acquired lock for aggregate e527021e-2239-422d-b558-f698ec838ab1 (batch mode)
🔒 Acquired lock for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (batch mode)
🔒 Acquired lock for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (batch mode)
🔒 Acquired lock for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (batch mode)
🔒 Acquired lock for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (batch mode)
📦 Processing 6 locked operations in batch
[DEBUG] execute_batch: Starting batch with 6 operations
[2m2025-07-30T10:47:34.625872Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 7 events and 7 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 7 aggregates
[2m2025-07-30T10:47:34.626097Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 5 events and 5 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 5 aggregates
[2m2025-07-30T10:47:34.626271Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 3 events and 3 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 3 aggregates
[2m2025-07-30T10:47:34.626451Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 3 events and 3 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 3 aggregates
[2m2025-07-30T10:47:34.626677Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 8 events and 8 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 8 aggregates
[2m2025-07-30T10:47:34.626876Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 4 events and 4 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 4 aggregates
[2m2025-07-30T10:47:34.627070Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 6 events and 6 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 6 aggregates
[2m2025-07-30T10:47:34.627279Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Prepared 6 events and 6 outbox messages
[DEBUG] execute_batch: About to call save_events_multi_aggregate_in_transaction with 6 aggregates
[2m2025-07-30T10:47:34.629343Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.757463ms [3melapsed_secs[0m[2m=[0m0.002757463
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 7 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 7 events
🔍 [DEBUG] Skipping version check for new aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (AccountCreated event)
[2m2025-07-30T10:47:34.631905Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.656749ms [3melapsed_secs[0m[2m=[0m0.004656749
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 5 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 5 events
🔍 [DEBUG] Skipping version check for new aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (AccountCreated event)
[2m2025-07-30T10:47:34.633676Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.55774ms [3melapsed_secs[0m[2m=[0m0.00655774
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 3 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 3 events
🔍 [DEBUG] Skipping version check for new aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (AccountCreated event)
[2m2025-07-30T10:47:34.635235Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.774785ms [3melapsed_secs[0m[2m=[0m0.007774785
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 3 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 3 events
🔍 [DEBUG] Skipping version check for new aggregate 0341015a-b267-467c-b005-6094bbabfeaf (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (AccountCreated event)
[2m2025-07-30T10:47:34.636362Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.948517ms [3melapsed_secs[0m[2m=[0m0.008948517
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 8 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 8 events
🔍 [DEBUG] Skipping version check for new aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 3f158540-6f31-4847-911a-10d513334c6e (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 008eed35-a97e-4648-983b-539a104fa6fa (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (AccountCreated event)
[2m2025-07-30T10:47:34.637428Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m10.007242ms [3melapsed_secs[0m[2m=[0m0.010007242
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 4 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 4 events
🔍 [DEBUG] Skipping version check for new aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (AccountCreated event)
[2m2025-07-30T10:47:34.638379Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m10.755195ms [3melapsed_secs[0m[2m=[0m0.010755195
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 6 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 6 events
🔍 [DEBUG] Skipping version check for new aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 83985b20-c135-4923-a1b2-1ca795622186 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (AccountCreated event)
[2m2025-07-30T10:47:34.639362Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SET TRANSACTION ISOLATION LEVEL …" [3mdb.statement[0m[2m=[0m"\n\nSET\n  TRANSACTION ISOLATION LEVEL SERIALIZABLE\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m11.509132ms [3melapsed_secs[0m[2m=[0m0.011509132
🔍 [DEBUG] About to call bulk_insert_events_multi_aggregate with 6 events
🚀 [DEBUG] bulk_insert_events_multi_aggregate called with 6 events
🔍 [DEBUG] Skipping version check for new aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate e527021e-2239-422d-b558-f698ec838ab1 (AccountCreated event)
🔍 [DEBUG] Skipping version check for new aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (AccountCreated event)
[2m2025-07-30T10:47:34.656694Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28),\n  ($29, $30, $31, $32, $33, $34, $35),\n  ($36, $37, $38, $39, $40, $41, $42),\n  ($43, $44, $45, $46, $47, $48, $49)\n" [3mrows_affected[0m[2m=[0m7 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.133182ms [3melapsed_secs[0m[2m=[0m0.013133182
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.663537Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21)\n" [3mrows_affected[0m[2m=[0m3 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m21.610859ms [3melapsed_secs[0m[2m=[0m0.021610859
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.674875Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28)\n" [3mrows_affected[0m[2m=[0m4 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m27.564719ms [3melapsed_secs[0m[2m=[0m0.027564719
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.684888Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28),\n  ($29, $30, $31, $32, $33, $34, $35)\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m43.107729ms [3melapsed_secs[0m[2m=[0m0.043107729
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.698392Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28),\n  ($29, $30, $31, $32, $33, $34, $35),\n  ($36, $37, $38, $39, $40, $41, $42),\n  ($43, $44, $45, $46, $47, $48, $49),\n  ($50, $51, $52, $53, $54, $55, $56)\n" [3mrows_affected[0m[2m=[0m8 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m48.620613ms [3melapsed_secs[0m[2m=[0m0.048620613
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.704775Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21)\n" [3mrows_affected[0m[2m=[0m3 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m65.143101ms [3melapsed_secs[0m[2m=[0m0.065143101
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.717315Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28),\n  ($29, $30, $31, $32, $33, $34, $35),\n  ($36, $37, $38, $39, $40, $41, $42)\n" [3mrows_affected[0m[2m=[0m6 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m66.437598ms [3melapsed_secs[0m[2m=[0m0.066437598
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.727938Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO events (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  events (\n    id,\n    aggregate_id,\n    event_type,\n    event_data,\n    version,\n    timestamp,\n    metadata\n  )\nVALUES\n  ($1, $2, $3, $4, $5, $6, $7),\n  ($8, $9, $10, $11, $12, $13, $14),\n  ($15, $16, $17, $18, $19, $20, $21),\n  ($22, $23, $24, $25, $26, $27, $28),\n  ($29, $30, $31, $32, $33, $34, $35),\n  ($36, $37, $38, $39, $40, $41, $42)\n" [3mrows_affected[0m[2m=[0m6 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m78.053422ms [3melapsed_secs[0m[2m=[0m0.078053422
✅ [DEBUG] bulk_insert_events_multi_aggregate completed successfully
[DEBUG] execute_batch: Transaction complete, results: Ok(())
[2m2025-07-30T10:47:34.728306Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m71.436326ms [3melapsed_secs[0m[2m=[0m0.071436326
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, event_id=fda66298-fb9c-4549-b9c2-03730860c4f5
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, event_id=ee19dd02-b0a7-4f94-9748-7f6534e31dba
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432, event_id=f23abe6f-f30c-4991-a8b9-3f8bf78bc96f
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae, event_id=8312e630-fbb7-4a1b-a063-a289db1bcd36
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f, event_id=c7e36ea6-5554-4094-abb8-3b04484ed6bd
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=d23dfd52-c53e-41ff-ad59-84ce50361f13, event_id=7c26dcfa-dfea-49eb-8d1d-740c612f9c30
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=34068678-f78f-4c4e-897a-320e1e1ef98c, event_id=deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39
[2m2025-07-30T10:47:34.728458Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 7 operations, 7 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 7 results
[2m2025-07-30T10:47:34.728746Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m64.631581ms [3melapsed_secs[0m[2m=[0m0.064631581
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=0341015a-b267-467c-b005-6094bbabfeaf, event_id=4fe5d90d-cd79-483e-b5b4-8dce0f86f624
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, event_id=8d0392bf-e746-4b5b-9ddb-a387d5baba89
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=c987ee59-e277-49cc-8759-ae6fa80c36bb, event_id=586993db-3ace-475f-aa7e-ffa2d7187e95
[2m2025-07-30T10:47:34.728818Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 3 operations, 3 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 3 results
[2m2025-07-30T10:47:34.729004Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m53.987974ms [3melapsed_secs[0m[2m=[0m0.053987974
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802, event_id=0a066437-a88f-467f-9b94-acfbdac9915e
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=b89811b8-79a0-444b-b81c-b5d1318fcf37, event_id=66953c8a-fdb0-4121-842d-a26a1e1a804a
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd, event_id=5cd8df9b-5b49-4951-a4d5-8a2981b99709
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2, event_id=fd54a23c-fdaf-4339-9de6-79d615178d54
[2m2025-07-30T10:47:34.729103Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 4 operations, 4 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 4 results
[DEBUG] OutboxBatcher::flush: Flushing 3 messages
[2m2025-07-30T10:47:34.733116Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m47.950909ms [3melapsed_secs[0m[2m=[0m0.047950909
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=b9d64fad-b777-4586-afbd-9857b52c8c50, event_id=bfd10942-85a8-4137-8135-6bfa610eb812
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=19e6eb70-d640-4aa4-87b1-07a148f1c279, event_id=8b77c2d9-009f-4be0-bc64-e404d948bd5f
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=934002d1-3696-455e-95d3-29b1fd549c06, event_id=096f7cf1-c698-47ff-bfb7-d7fad36e5ae0
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=550123b2-bf64-4afb-a6b1-b8d34120defa, event_id=cc6c62c5-7106-4d03-9425-37f71476c4eb
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=43940fcc-f74b-426f-a97b-2574764a7e31, event_id=d8622646-8725-4509-9247-d93b6235f2df
[2m2025-07-30T10:47:34.733396Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 5 operations, 5 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 5 results
[2m2025-07-30T10:47:34.733931Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m35.082791ms [3melapsed_secs[0m[2m=[0m0.035082791
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f, event_id=33664502-747f-4fdf-9abb-29b87f9dcc55
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252, event_id=ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=008eed35-a97e-4648-983b-539a104fa6fa, event_id=abb942e1-408e-4f15-88b5-2a4d5b9648a5
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=d1b755fc-6266-414c-ab59-ab599dac5a5c, event_id=368b22db-f0ee-412d-a4c0-2203423040e9
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=3f158540-6f31-4847-911a-10d513334c6e, event_id=fe9ead01-7750-4a9b-9438-ed3646a94284
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7, event_id=ad056ed2-9fbc-43ed-8297-b0fed668ac0e
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0, event_id=ecf85f54-3440-4469-bcae-4c77280a4c13
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, event_id=d9fdfd97-d603-4df6-8544-24dd57bfbfe8
[2m2025-07-30T10:47:34.734125Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 8 operations, 8 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 8 results
[2m2025-07-30T10:47:34.734450Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m29.561627ms [3melapsed_secs[0m[2m=[0m0.029561627
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=76712f66-7c6a-4f2a-a27b-b088343a009f, event_id=3176200c-d481-4c23-934d-e6da9aa37ae2
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=b44cb9ca-2459-42f3-b1ed-f384936e1654, event_id=ea259d86-037e-46c3-b196-16332a44b94b
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=82a28ae2-091a-4d48-b74d-6a26967b6847, event_id=18a4c1a4-9729-46fb-8edd-4d2fda5b4bce
[2m2025-07-30T10:47:34.734530Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 3 operations, 3 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 3 results
[2m2025-07-30T10:47:34.734734Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m17.266271ms [3melapsed_secs[0m[2m=[0m0.017266271
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=83985b20-c135-4923-a1b2-1ca795622186, event_id=d887467f-d9ad-47d7-995d-68de26afe872
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2, event_id=10176408-40b9-44a4-9e09-e71b8139e919
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=95295434-12fb-4e71-844f-b0e41f005d18, event_id=710a7b9f-e101-4d61-928d-1a02fe5dbcf7
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=1e66be70-e791-4039-8fd6-84d172418be7, event_id=0c94ec95-0121-4acf-aa47-e253e8f84765
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=bba216de-b846-46ca-a2e0-a248fa9481e4, event_id=95657bd9-2ca2-4bc2-ad8e-8725aad3f794
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=2fb0c79f-18dd-49bd-94ec-24980172faf7, event_id=796b6dcb-4333-4b52-8395-20957b85a8d0
[2m2025-07-30T10:47:34.734825Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 6 operations, 6 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 6 results
[2m2025-07-30T10:47:34.735061Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.979732ms [3melapsed_secs[0m[2m=[0m0.006979732
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=2fed6150-edc2-4f35-92e2-2653975a4ab4, event_id=163c3131-0986-4154-b779-fcd36b7cbc1e
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=e527021e-2239-422d-b558-f698ec838ab1, event_id=56a3ab30-1752-453b-9c27-4e38fcf22ad0
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98, event_id=3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d, event_id=cf124277-9e7e-48db-89f9-c8ef4eacc3ab
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=8a1e00f0-1597-4259-8059-0e75d4a854a5, event_id=b19d4719-1ccc-4196-8130-00f133eacc78
[DEBUG] OutboxBatcher::submit: Submitting outbox message for aggregate_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73, event_id=a851dcb4-a913-4996-be36-0d5572b342ae
[2m2025-07-30T10:47:34.735157Z[0m [32m INFO[0m [2mbanking_es::infrastructure::write_batching[0m[2m:[0m [DEBUG] execute_batch: Completed successfully - 6 operations, 6 outbox messages, outbox_success=true
[DEBUG] execute_batch: Finished batch with 6 results
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 2 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 7 messages
✅ Account 0 created successfully: 9f42ccc5-8766-4904-94ab-030dd75e9abc
✅ Account 1 created successfully: e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
✅ Account 2 created successfully: c4897ec9-f2ac-45df-aefa-9326bfac6a2f
✅ Account 3 created successfully: 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
✅ Account 4 created successfully: cce69089-c607-40e6-9437-d36c2bd44cef
✅ Account 5 created successfully: 94f664e3-df24-405e-8033-914fa42fc6d2
✅ Account 6 created successfully: cffce9cb-b536-4cf4-9578-ac63bf4d41b2
✅ Account 7 created successfully: f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
✅ Account 8 created successfully: cb146a59-24f7-4da9-b46c-0bd86e4e5314
✅ Account 9 created successfully: bba216de-b846-46ca-a2e0-a248fa9481e4
✅ Account 10 created successfully: 8d973005-da14-446b-b507-7f6e9cd4399e
✅ Account 11 created successfully: 5591cc7a-5bfa-49d2-bda8-7e9c78197432
✅ Account 12 created successfully: d1b755fc-6266-414c-ab59-ab599dac5a5c
✅ Account 13 created successfully: 2b7940e6-3f66-4d87-a21f-63976829668f
✅ Account 14 created successfully: 76712f66-7c6a-4f2a-a27b-b088343a009f
✅ Account 15 created successfully: 8b39b03e-62d5-47a2-85d0-4c7d6160a252
✅ Account 16 created successfully: 1e66be70-e791-4039-8fd6-84d172418be7
✅ Account 17 created successfully: 2fed6150-edc2-4f35-92e2-2653975a4ab4
✅ Account 18 created successfully: 6123ee1b-78cb-4996-98dc-801c2cbac2b2
✅ Account 19 created successfully: 83985b20-c135-4923-a1b2-1ca795622186
✅ Account 20 created successfully: 8d7de81d-5f6a-4204-811b-86a77fbc34e0
✅ Account 21 created successfully: 95295434-12fb-4e71-844f-b0e41f005d18
✅ Account 22 created successfully: 19e6eb70-d640-4aa4-87b1-07a148f1c279
✅ Account 23 created successfully: d23dfd52-c53e-41ff-ad59-84ce50361f13
✅ Account 24 created successfully: b9d64fad-b777-4586-afbd-9857b52c8c50
✅ Account 25 created successfully: b89811b8-79a0-444b-b81c-b5d1318fcf37
✅ Account 26 created successfully: 934002d1-3696-455e-95d3-29b1fd549c06
✅ Account 27 created successfully: 82a28ae2-091a-4d48-b74d-6a26967b6847
✅ Account 28 created successfully: 3f158540-6f31-4847-911a-10d513334c6e
✅ Account 29 created successfully: 7186dfcc-e470-4997-ba8a-d80f3f3dac73
✅ Account 30 created successfully: cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
✅ Account 31 created successfully: 15aecab1-20c2-4ee4-9b64-a980a9a341ae
✅ Account 32 created successfully: e527021e-2239-422d-b558-f698ec838ab1
✅ Account 33 created successfully: acf0ba30-0efb-4b8c-9842-f6033fbfc84d
✅ Account 34 created successfully: 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
✅ Account 35 created successfully: 43940fcc-f74b-426f-a97b-2574764a7e31
✅ Account 36 created successfully: 8a1e00f0-1597-4259-8059-0e75d4a854a5
✅ Account 37 created successfully: 0341015a-b267-467c-b005-6094bbabfeaf
✅ Account 38 created successfully: 3f72cff7-d030-48d3-bcef-fc8bc53d1802
✅ Account 39 created successfully: 550123b2-bf64-4afb-a6b1-b8d34120defa
✅ Account 40 created successfully: ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
✅ Account 41 created successfully: de7c59df-e67a-4ecb-bc69-ddd631c84c9f
✅ Account 42 created successfully: f28b281d-1783-4d9d-989e-dbf9ed9130cd
✅ Account 43 created successfully: c987ee59-e277-49cc-8759-ae6fa80c36bb
✅ Account 44 created successfully: b44cb9ca-2459-42f3-b1ed-f384936e1654
✅ Account 45 created successfully: 008eed35-a97e-4648-983b-539a104fa6fa
✅ Account 46 created successfully: 2fb0c79f-18dd-49bd-94ec-24980172faf7
✅ Account 47 created successfully: 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
✅ Account 48 created successfully: 34068678-f78f-4c4e-897a-320e1e1ef98c
✅ Account 49 created successfully: 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
⏱️  Account creation completed!
📊 Account Creation Results:
   • Total accounts created: 50
   • Total time: 278.91ms
   • Average time per account: 5.58ms
   • Accounts per second: 179.27
✅ Successfully created 50 test accounts out of 50 submitted
⏳ Waiting for CDC/projection sync after account creation...
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 3 messages
[2m2025-07-30T10:47:34.738612Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 7 locks in batch
[2m2025-07-30T10:47:34.738775Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 3 locks in batch
[2m2025-07-30T10:47:34.738846Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 4 locks in batch
[2m2025-07-30T10:47:34.739043Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 3 messages
[2m2025-07-30T10:47:34.740692Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.740878Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 2 messages
[2m2025-07-30T10:47:34.741715Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 5 locks in batch
[2m2025-07-30T10:47:34.741808Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 8 locks in batch
[2m2025-07-30T10:47:34.741880Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 3 locks in batch
[2m2025-07-30T10:47:34.741949Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 6 locks in batch
[2m2025-07-30T10:47:34.742012Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::redis_aggregate_lock[0m[2m:[0m 🔓 Released 6 locks in batch
[2m2025-07-30T10:47:34.742225Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.742451Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 7 messages
[2m2025-07-30T10:47:34.742645Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.742821Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.743004Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 3 messages
[2m2025-07-30T10:47:34.755817Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.796953ms [3melapsed_secs[0m[2m=[0m0.004796953
[2m2025-07-30T10:47:34.755926Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 15.238649ms
[2m2025-07-30T10:47:34.766542Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m3 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m17.476829ms [3melapsed_secs[0m[2m=[0m0.017476829
[2m2025-07-30T10:47:34.766654Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 3 messages in 27.606544ms
[2m2025-07-30T10:47:34.774906Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m2 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m26.259534ms [3melapsed_secs[0m[2m=[0m0.026259534
[2m2025-07-30T10:47:34.774966Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 2 messages in 34.0895ms
[2m2025-07-30T10:47:34.785782Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m32.958869ms [3melapsed_secs[0m[2m=[0m0.032958869
[2m2025-07-30T10:47:34.785891Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 43.663279ms
[2m2025-07-30T10:47:34.798196Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m7 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m44.115197ms [3melapsed_secs[0m[2m=[0m0.044115197
[2m2025-07-30T10:47:34.798861Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 7 messages in 56.166991ms
[2m2025-07-30T10:47:34.807793Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m56.515664ms [3melapsed_secs[0m[2m=[0m0.056515664
[2m2025-07-30T10:47:34.807850Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 65.206701ms
[2m2025-07-30T10:47:34.816835Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m3 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m65.103793ms [3melapsed_secs[0m[2m=[0m0.065103793
[2m2025-07-30T10:47:34.816951Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 3 messages in 73.945128ms
[2m2025-07-30T10:47:34.817286Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m61.278775ms [3melapsed_secs[0m[2m=[0m0.061278775
[2m2025-07-30T10:47:34.817351Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 80.947054ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.824177Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m74.60228ms [3melapsed_secs[0m[2m=[0m0.07460228
[2m2025-07-30T10:47:34.824229Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 81.410642ms
[2m2025-07-30T10:47:34.824515Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m57.775599ms [3melapsed_secs[0m[2m=[0m0.057775599
[2m2025-07-30T10:47:34.824585Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 3 messages in 94.929921ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.824704Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m49.69405ms [3melapsed_secs[0m[2m=[0m0.04969405
[2m2025-07-30T10:47:34.824737Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 2 messages in 88.186901ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.824820Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m38.872746ms [3melapsed_secs[0m[2m=[0m0.038872746
[2m2025-07-30T10:47:34.824853Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 88.177434ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.824993Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430004518, event_ptr: 0x7144300044a0 }
[2m2025-07-30T10:47:34.825251Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("693cdbe7-cb05-4b71-9a8d-4a9dda6d7769"), "created_at": String("2025-07-30T10:47:34.541458Z"), "event_id": String("466480b3-6fe1-4fae-b949-151617adfc9a"), "event_type": String("AccountCreated"), "id": String("86430b24-2e09-4610-8166-23890420812c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAaTzb58sFS3GajUqd2m13aRAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMwQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541458Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.825307Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("693cdbe7-cb05-4b71-9a8d-4a9dda6d7769"), "created_at": String("2025-07-30T10:47:34.541458Z"), "event_id": String("466480b3-6fe1-4fae-b949-151617adfc9a"), "event_type": String("AccountCreated"), "id": String("86430b24-2e09-4610-8166-23890420812c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAaTzb58sFS3GajUqd2m13aRAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMwQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541458Z")}
[2m2025-07-30T10:47:34.825336Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, event_id=466480b3-6fe1-4fae-b949-151617adfc9a, event_type=AccountCreated
[2m2025-07-30T10:47:34.825395Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 466480b3-6fe1-4fae-b949-151617adfc9a: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 105, 60, 219, 231])
[2m2025-07-30T10:47:34.825443Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 466480b3-6fe1-4fae-b949-151617adfc9a, Aggregate: 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, Type: AccountCreated
[2m2025-07-30T10:47:34.825463Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 466480b3-6fe1-4fae-b949-151617adfc9a
[2m2025-07-30T10:47:34.825492Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 466480b3-6fe1-4fae-b949-151617adfc9a
[2m2025-07-30T10:47:34.825582Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 466480b3-6fe1-4fae-b949-151617adfc9a
[2m2025-07-30T10:47:34.825615Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (immediate)
[2m2025-07-30T10:47:34.825684Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 status=Completed
[2m2025-07-30T10:47:34.825715Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (immediate)
[2m2025-07-30T10:47:34.825743Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (immediate)
[2m2025-07-30T10:47:34.825786Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 status=Completed
[2m2025-07-30T10:47:34.825826Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769 (immediate)
[2m2025-07-30T10:47:34.825920Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430004518    
[2m2025-07-30T10:47:34.825944Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430004518    
[2m2025-07-30T10:47:34.825966Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300044a0    
[2m2025-07-30T10:47:34.825995Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300044a0    
[2m2025-07-30T10:47:34.826031Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300065f8, event_ptr: 0x714430006580 }
[2m2025-07-30T10:47:34.826231Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933"), "created_at": String("2025-07-30T10:47:34.541092Z"), "event_id": String("e518e474-b74f-4c88-bff8-528394fe4fdc"), "event_type": String("AccountCreated"), "id": String("97a78622-8b71-4099-9549-0bcba1cd0e47"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA4XUOt0y9Qvedfrpx4fqZMxAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541092Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.826314Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933"), "created_at": String("2025-07-30T10:47:34.541092Z"), "event_id": String("e518e474-b74f-4c88-bff8-528394fe4fdc"), "event_type": String("AccountCreated"), "id": String("97a78622-8b71-4099-9549-0bcba1cd0e47"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA4XUOt0y9Qvedfrpx4fqZMxAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541092Z")}
[2m2025-07-30T10:47:34.826357Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, event_id=e518e474-b74f-4c88-bff8-528394fe4fdc, event_type=AccountCreated
[2m2025-07-30T10:47:34.826396Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id e518e474-b74f-4c88-bff8-528394fe4fdc: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 225, 117, 14, 183])
[2m2025-07-30T10:47:34.826440Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: e518e474-b74f-4c88-bff8-528394fe4fdc, Aggregate: e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, Type: AccountCreated
[2m2025-07-30T10:47:34.826478Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id e518e474-b74f-4c88-bff8-528394fe4fdc
[2m2025-07-30T10:47:34.826510Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: e518e474-b74f-4c88-bff8-528394fe4fdc
[2m2025-07-30T10:47:34.826576Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: e518e474-b74f-4c88-bff8-528394fe4fdc
[2m2025-07-30T10:47:34.826606Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (immediate)
[2m2025-07-30T10:47:34.826647Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 status=Completed
[2m2025-07-30T10:47:34.826683Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (immediate)
[2m2025-07-30T10:47:34.826714Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (immediate)
[2m2025-07-30T10:47:34.826747Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 status=Completed
[2m2025-07-30T10:47:34.826782Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933 (immediate)
[2m2025-07-30T10:47:34.826867Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300065f8    
[2m2025-07-30T10:47:34.826890Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300065f8    
[2m2025-07-30T10:47:34.826912Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006580    
[2m2025-07-30T10:47:34.826935Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006580    
[2m2025-07-30T10:47:34.826964Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006738, event_ptr: 0x7144300066c0 }
[2m2025-07-30T10:47:34.827162Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("9f42ccc5-8766-4904-94ab-030dd75e9abc"), "created_at": String("2025-07-30T10:47:34.541239Z"), "event_id": String("1222f767-effd-46a9-a43c-387f349a8eb4"), "event_type": String("AccountCreated"), "id": String("9e05dae1-0838-4f19-9ba1-a69b87dabb2c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAn0LMxYdmSQSUqwMN116avBAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541239Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.827245Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("9f42ccc5-8766-4904-94ab-030dd75e9abc"), "created_at": String("2025-07-30T10:47:34.541239Z"), "event_id": String("1222f767-effd-46a9-a43c-387f349a8eb4"), "event_type": String("AccountCreated"), "id": String("9e05dae1-0838-4f19-9ba1-a69b87dabb2c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAn0LMxYdmSQSUqwMN116avBAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541239Z")}
[2m2025-07-30T10:47:34.827287Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=9f42ccc5-8766-4904-94ab-030dd75e9abc, event_id=1222f767-effd-46a9-a43c-387f349a8eb4, event_type=AccountCreated
[2m2025-07-30T10:47:34.827324Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 1222f767-effd-46a9-a43c-387f349a8eb4: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 159, 66, 204, 197])
[2m2025-07-30T10:47:34.827368Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 1222f767-effd-46a9-a43c-387f349a8eb4, Aggregate: 9f42ccc5-8766-4904-94ab-030dd75e9abc, Type: AccountCreated
[2m2025-07-30T10:47:34.827405Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 1222f767-effd-46a9-a43c-387f349a8eb4
[2m2025-07-30T10:47:34.827437Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 1222f767-effd-46a9-a43c-387f349a8eb4
[2m2025-07-30T10:47:34.827508Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 1222f767-effd-46a9-a43c-387f349a8eb4
[2m2025-07-30T10:47:34.827537Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (immediate)
[2m2025-07-30T10:47:34.827569Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=9f42ccc5-8766-4904-94ab-030dd75e9abc status=Completed
[2m2025-07-30T10:47:34.827610Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (immediate)
[2m2025-07-30T10:47:34.827651Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (immediate)
[2m2025-07-30T10:47:34.827690Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=9f42ccc5-8766-4904-94ab-030dd75e9abc status=Completed
[2m2025-07-30T10:47:34.827726Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 9f42ccc5-8766-4904-94ab-030dd75e9abc (immediate)
[2m2025-07-30T10:47:34.827810Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006738    
[2m2025-07-30T10:47:34.827835Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006738    
[2m2025-07-30T10:47:34.827862Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300066c0    
[2m2025-07-30T10:47:34.827887Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300066c0    
[2m2025-07-30T10:47:34.827919Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006878, event_ptr: 0x714430006800 }
[2m2025-07-30T10:47:34.828116Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("2b7940e6-3f66-4d87-a21f-63976829668f"), "created_at": String("2025-07-30T10:47:34.541022Z"), "event_id": String("3ded4f61-aa21-4bfa-84fd-23be48a0f555"), "event_type": String("AccountCreated"), "id": String("21ce7d16-df89-4b3a-b55e-776ffe517552"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAK3lA5j9mTYeiH2OXaClmjxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541022Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.828200Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("2b7940e6-3f66-4d87-a21f-63976829668f"), "created_at": String("2025-07-30T10:47:34.541022Z"), "event_id": String("3ded4f61-aa21-4bfa-84fd-23be48a0f555"), "event_type": String("AccountCreated"), "id": String("21ce7d16-df89-4b3a-b55e-776ffe517552"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAK3lA5j9mTYeiH2OXaClmjxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541022Z")}
[2m2025-07-30T10:47:34.828249Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=2b7940e6-3f66-4d87-a21f-63976829668f, event_id=3ded4f61-aa21-4bfa-84fd-23be48a0f555, event_type=AccountCreated
[2m2025-07-30T10:47:34.828290Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 3ded4f61-aa21-4bfa-84fd-23be48a0f555: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 43, 121, 64, 230])
[2m2025-07-30T10:47:34.828336Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 3ded4f61-aa21-4bfa-84fd-23be48a0f555, Aggregate: 2b7940e6-3f66-4d87-a21f-63976829668f, Type: AccountCreated
[2m2025-07-30T10:47:34.828375Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 3ded4f61-aa21-4bfa-84fd-23be48a0f555
[2m2025-07-30T10:47:34.828406Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 3ded4f61-aa21-4bfa-84fd-23be48a0f555
[2m2025-07-30T10:47:34.828471Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 3ded4f61-aa21-4bfa-84fd-23be48a0f555
[2m2025-07-30T10:47:34.828502Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (immediate)
[2m2025-07-30T10:47:34.828541Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=2b7940e6-3f66-4d87-a21f-63976829668f status=Completed
[2m2025-07-30T10:47:34.828577Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (immediate)
[2m2025-07-30T10:47:34.828607Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (immediate)
[2m2025-07-30T10:47:34.828652Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=2b7940e6-3f66-4d87-a21f-63976829668f status=Completed
[2m2025-07-30T10:47:34.828689Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 2b7940e6-3f66-4d87-a21f-63976829668f (immediate)
[2m2025-07-30T10:47:34.828778Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006878    
[2m2025-07-30T10:47:34.828803Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006878    
[2m2025-07-30T10:47:34.828830Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006800    
[2m2025-07-30T10:47:34.828858Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006800    
[2m2025-07-30T10:47:34.828903Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300069b8, event_ptr: 0x714430006940 }
[2m2025-07-30T10:47:34.829157Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("8d973005-da14-446b-b507-7f6e9cd4399e"), "created_at": String("2025-07-30T10:47:34.541166Z"), "event_id": String("f84ba3de-46cf-484c-9ebc-2752aa49eefc"), "event_type": String("AccountCreated"), "id": String("3f06b46c-d32d-466f-8575-6fd9531bd742"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAjZcwBdoURGu1B39unNQ5nhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541166Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.829258Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("8d973005-da14-446b-b507-7f6e9cd4399e"), "created_at": String("2025-07-30T10:47:34.541166Z"), "event_id": String("f84ba3de-46cf-484c-9ebc-2752aa49eefc"), "event_type": String("AccountCreated"), "id": String("3f06b46c-d32d-466f-8575-6fd9531bd742"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAjZcwBdoURGu1B39unNQ5nhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541166Z")}
[2m2025-07-30T10:47:34.829311Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=8d973005-da14-446b-b507-7f6e9cd4399e, event_id=f84ba3de-46cf-484c-9ebc-2752aa49eefc, event_type=AccountCreated
[2m2025-07-30T10:47:34.829373Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id f84ba3de-46cf-484c-9ebc-2752aa49eefc: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 141, 151, 48, 5])
[2m2025-07-30T10:47:34.829446Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: f84ba3de-46cf-484c-9ebc-2752aa49eefc, Aggregate: 8d973005-da14-446b-b507-7f6e9cd4399e, Type: AccountCreated
[2m2025-07-30T10:47:34.829490Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id f84ba3de-46cf-484c-9ebc-2752aa49eefc
[2m2025-07-30T10:47:34.829534Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: f84ba3de-46cf-484c-9ebc-2752aa49eefc
[2m2025-07-30T10:47:34.829722Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: f84ba3de-46cf-484c-9ebc-2752aa49eefc
[2m2025-07-30T10:47:34.829762Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (immediate)
[2m2025-07-30T10:47:34.829813Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=8d973005-da14-446b-b507-7f6e9cd4399e status=Completed
[2m2025-07-30T10:47:34.829855Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (immediate)
[2m2025-07-30T10:47:34.829892Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (immediate)
[2m2025-07-30T10:47:34.829932Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=8d973005-da14-446b-b507-7f6e9cd4399e status=Completed
[2m2025-07-30T10:47:34.829975Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 8d973005-da14-446b-b507-7f6e9cd4399e (immediate)
[2m2025-07-30T10:47:34.830193Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300069b8    
[2m2025-07-30T10:47:34.830230Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300069b8    
[2m2025-07-30T10:47:34.830260Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006940    
[2m2025-07-30T10:47:34.830297Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006940    
[2m2025-07-30T10:47:34.830401Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430008378, event_ptr: 0x714430008300 }
[2m2025-07-30T10:47:34.830703Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("cb146a59-24f7-4da9-b46c-0bd86e4e5314"), "created_at": String("2025-07-30T10:47:34.541530Z"), "event_id": String("f09c5be9-0147-4e77-90dd-df4506f34a7d"), "event_type": String("AccountCreated"), "id": String("a019d948-c175-4d85-b150-8f77c6cf6ed4"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAyxRqWST3Tam0bAvYbk5TFBAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfOAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541530Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.830786Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("cb146a59-24f7-4da9-b46c-0bd86e4e5314"), "created_at": String("2025-07-30T10:47:34.541530Z"), "event_id": String("f09c5be9-0147-4e77-90dd-df4506f34a7d"), "event_type": String("AccountCreated"), "id": String("a019d948-c175-4d85-b150-8f77c6cf6ed4"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAyxRqWST3Tam0bAvYbk5TFBAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfOAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541530Z")}
[2m2025-07-30T10:47:34.830852Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314, event_id=f09c5be9-0147-4e77-90dd-df4506f34a7d, event_type=AccountCreated
[2m2025-07-30T10:47:34.830972Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id f09c5be9-0147-4e77-90dd-df4506f34a7d: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 203, 20, 106, 89])
[2m2025-07-30T10:47:34.831073Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: f09c5be9-0147-4e77-90dd-df4506f34a7d, Aggregate: cb146a59-24f7-4da9-b46c-0bd86e4e5314, Type: AccountCreated
[2m2025-07-30T10:47:34.831120Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id f09c5be9-0147-4e77-90dd-df4506f34a7d
[2m2025-07-30T10:47:34.831154Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: f09c5be9-0147-4e77-90dd-df4506f34a7d
[2m2025-07-30T10:47:34.831306Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: f09c5be9-0147-4e77-90dd-df4506f34a7d
[2m2025-07-30T10:47:34.831353Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (immediate)
[2m2025-07-30T10:47:34.831416Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314 status=Completed
[2m2025-07-30T10:47:34.831479Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (immediate)
[2m2025-07-30T10:47:34.831530Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (immediate)
[2m2025-07-30T10:47:34.831601Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314 status=Completed
[2m2025-07-30T10:47:34.831685Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate cb146a59-24f7-4da9-b46c-0bd86e4e5314 (immediate)
[2m2025-07-30T10:47:34.831851Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430008378    
[2m2025-07-30T10:47:34.831879Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430008378    
[2m2025-07-30T10:47:34.831908Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008300    
[2m2025-07-30T10:47:34.831935Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008300    
[2m2025-07-30T10:47:34.832008Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300084b8, event_ptr: 0x714430008440 }
[2m2025-07-30T10:47:34.832234Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("cce69089-c607-40e6-9437-d36c2bd44cef"), "created_at": String("2025-07-30T10:47:34.541316Z"), "event_id": String("a0ccef75-f4ff-4ab1-b7f7-a398a102e455"), "event_type": String("AccountCreated"), "id": String("aa9bed59-831a-43c1-b25b-95f202670936"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAzOaQicYHQOaUN9NsK9RM7xAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541316Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.832322Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("cce69089-c607-40e6-9437-d36c2bd44cef"), "created_at": String("2025-07-30T10:47:34.541316Z"), "event_id": String("a0ccef75-f4ff-4ab1-b7f7-a398a102e455"), "event_type": String("AccountCreated"), "id": String("aa9bed59-831a-43c1-b25b-95f202670936"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAzOaQicYHQOaUN9NsK9RM7xAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNAQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541316Z")}
[2m2025-07-30T10:47:34.832369Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=cce69089-c607-40e6-9437-d36c2bd44cef, event_id=a0ccef75-f4ff-4ab1-b7f7-a398a102e455, event_type=AccountCreated
[2m2025-07-30T10:47:34.832405Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id a0ccef75-f4ff-4ab1-b7f7-a398a102e455: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 204, 230, 144, 137])
[2m2025-07-30T10:47:34.832451Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: a0ccef75-f4ff-4ab1-b7f7-a398a102e455, Aggregate: cce69089-c607-40e6-9437-d36c2bd44cef, Type: AccountCreated
[2m2025-07-30T10:47:34.832482Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id a0ccef75-f4ff-4ab1-b7f7-a398a102e455
[2m2025-07-30T10:47:34.832508Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: a0ccef75-f4ff-4ab1-b7f7-a398a102e455
[2m2025-07-30T10:47:34.832572Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: a0ccef75-f4ff-4ab1-b7f7-a398a102e455
[2m2025-07-30T10:47:34.832598Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate cce69089-c607-40e6-9437-d36c2bd44cef (immediate)
[2m2025-07-30T10:47:34.832642Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=cce69089-c607-40e6-9437-d36c2bd44cef status=Completed
[2m2025-07-30T10:47:34.832664Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate cce69089-c607-40e6-9437-d36c2bd44cef (immediate)
[2m2025-07-30T10:47:34.832674Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate cce69089-c607-40e6-9437-d36c2bd44cef (immediate)
[2m2025-07-30T10:47:34.832686Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=cce69089-c607-40e6-9437-d36c2bd44cef status=Completed
[2m2025-07-30T10:47:34.832697Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate cce69089-c607-40e6-9437-d36c2bd44cef (immediate)
[2m2025-07-30T10:47:34.832744Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300084b8    
[2m2025-07-30T10:47:34.832759Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300084b8    
[2m2025-07-30T10:47:34.832766Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008440    
[2m2025-07-30T10:47:34.832774Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008440    
[2m2025-07-30T10:47:34.832794Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300085f8, event_ptr: 0x714430008580 }
[2m2025-07-30T10:47:34.832900Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("94f664e3-df24-405e-8033-914fa42fc6d2"), "created_at": String("2025-07-30T10:47:34.541382Z"), "event_id": String("b371dcf2-ba13-4ce0-8660-b64f1b88a736"), "event_type": String("AccountCreated"), "id": String("e5cc12a9-b91e-49b5-871a-8778c1a00747"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAlPZk498kQF6AM5FPpC/G0hAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541382Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:34.832937Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("94f664e3-df24-405e-8033-914fa42fc6d2"), "created_at": String("2025-07-30T10:47:34.541382Z"), "event_id": String("b371dcf2-ba13-4ce0-8660-b64f1b88a736"), "event_type": String("AccountCreated"), "id": String("e5cc12a9-b91e-49b5-871a-8778c1a00747"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAlPZk498kQF6AM5FPpC/G0hAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.541382Z")}
[2m2025-07-30T10:47:34.832955Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=94f664e3-df24-405e-8033-914fa42fc6d2, event_id=b371dcf2-ba13-4ce0-8660-b64f1b88a736, event_type=AccountCreated
[2m2025-07-30T10:47:34.832971Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id b371dcf2-ba13-4ce0-8660-b64f1b88a736: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 148, 246, 100, 227])
[2m2025-07-30T10:47:34.832994Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: b371dcf2-ba13-4ce0-8660-b64f1b88a736, Aggregate: 94f664e3-df24-405e-8033-914fa42fc6d2, Type: AccountCreated
[2m2025-07-30T10:47:34.833010Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id b371dcf2-ba13-4ce0-8660-b64f1b88a736
[2m2025-07-30T10:47:34.833021Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: b371dcf2-ba13-4ce0-8660-b64f1b88a736
[2m2025-07-30T10:47:34.833050Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: b371dcf2-ba13-4ce0-8660-b64f1b88a736
[2m2025-07-30T10:47:34.833063Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (immediate)
[2m2025-07-30T10:47:34.833079Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=94f664e3-df24-405e-8033-914fa42fc6d2 status=Completed
[2m2025-07-30T10:47:34.833092Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (immediate)
[2m2025-07-30T10:47:34.833101Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (immediate)
[2m2025-07-30T10:47:34.833115Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=94f664e3-df24-405e-8033-914fa42fc6d2 status=Completed
[2m2025-07-30T10:47:34.833127Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 94f664e3-df24-405e-8033-914fa42fc6d2 (immediate)
[2m2025-07-30T10:47:34.833165Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300085f8    
[2m2025-07-30T10:47:34.833175Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300085f8    
[2m2025-07-30T10:47:34.833182Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008580    
[2m2025-07-30T10:47:34.833191Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008580    
[2m2025-07-30T10:47:34.833922Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m34.949195ms [3melapsed_secs[0m[2m=[0m0.034949195
[2m2025-07-30T10:47:34.833977Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 7 messages in 97.144778ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.834039Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m26.148853ms [3melapsed_secs[0m[2m=[0m0.026148853
[2m2025-07-30T10:47:34.834071Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 96.736035ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.834144Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m17.1395ms [3melapsed_secs[0m[2m=[0m0.0171395
[2m2025-07-30T10:47:34.834175Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 3 messages in 96.653436ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.834241Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.974335ms [3melapsed_secs[0m[2m=[0m0.009974335
[2m2025-07-30T10:47:34.834293Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 96.856923ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.834705Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: start for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: before L1 cache lookup for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: L1 cache miss for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: before Redis lookup for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: Redis miss for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] CacheService::get_account: returning None for 2b7940e6-3f66-4d87-a21f-63976829668f
[2m2025-07-30T10:47:34.837270Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] get_account: start for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] get_account: acquiring cache read lock for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] get_account: acquired cache read lock for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] get_account: cache miss for 2b7940e6-3f66-4d87-a21f-63976829668f
[DEBUG] ProjectionStore: About to query DB for account_id=2b7940e6-3f66-4d87-a21f-63976829668f
[2m2025-07-30T10:47:34.841215Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.946003ms [3melapsed_secs[0m[2m=[0m0.001946003
[DEBUG] ProjectionStore: Finished DB query for account_id=2b7940e6-3f66-4d87-a21f-63976829668f
[2m2025-07-30T10:47:34.843060Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 2b7940e6-3f66-4d87-a21f-63976829668f
[2m2025-07-30T10:47:34.843119Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: start for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: before L1 cache lookup for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: L1 cache miss for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: before Redis lookup for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: Redis miss for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] CacheService::get_account: returning None for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[2m2025-07-30T10:47:34.844782Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] get_account: start for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] get_account: acquiring cache read lock for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] get_account: acquired cache read lock for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] get_account: cache miss for cb146a59-24f7-4da9-b46c-0bd86e4e5314
[DEBUG] ProjectionStore: About to query DB for account_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314
[2m2025-07-30T10:47:34.851846Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.015286ms [3melapsed_secs[0m[2m=[0m0.004015286
[DEBUG] ProjectionStore: Finished DB query for account_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314
[2m2025-07-30T10:47:34.854766Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: cb146a59-24f7-4da9-b46c-0bd86e4e5314
[2m2025-07-30T10:47:34.854827Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: start for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: before L1 cache lookup for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: L1 cache miss for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: before Redis lookup for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: Redis miss for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] CacheService::get_account: returning None for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[2m2025-07-30T10:47:34.856376Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] get_account: start for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] get_account: acquiring cache read lock for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] get_account: acquired cache read lock for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] get_account: cache miss for 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[DEBUG] ProjectionStore: About to query DB for account_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[2m2025-07-30T10:47:34.860162Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.783595ms [3melapsed_secs[0m[2m=[0m0.001783595
[DEBUG] ProjectionStore: Finished DB query for account_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[2m2025-07-30T10:47:34.862056Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769
[2m2025-07-30T10:47:34.862141Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: start for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: before L1 cache lookup for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: L1 cache miss for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: before Redis lookup for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: Redis miss for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] CacheService::get_account: returning None for cce69089-c607-40e6-9437-d36c2bd44cef
[2m2025-07-30T10:47:34.866310Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] get_account: start for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] get_account: acquiring cache read lock for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] get_account: acquired cache read lock for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] get_account: cache miss for cce69089-c607-40e6-9437-d36c2bd44cef
[DEBUG] ProjectionStore: About to query DB for account_id=cce69089-c607-40e6-9437-d36c2bd44cef
[2m2025-07-30T10:47:34.870824Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.280895ms [3melapsed_secs[0m[2m=[0m0.002280895
[DEBUG] ProjectionStore: Finished DB query for account_id=cce69089-c607-40e6-9437-d36c2bd44cef
[2m2025-07-30T10:47:34.873025Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: cce69089-c607-40e6-9437-d36c2bd44cef
[2m2025-07-30T10:47:34.873100Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: start for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: before L1 cache lookup for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: L1 cache miss for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: before Redis lookup for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: Redis miss for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] CacheService::get_account: returning None for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[2m2025-07-30T10:47:34.874602Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] get_account: start for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] get_account: acquiring cache read lock for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] get_account: acquired cache read lock for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] get_account: cache miss for e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[DEBUG] ProjectionStore: About to query DB for account_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[2m2025-07-30T10:47:34.878587Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.833521ms [3melapsed_secs[0m[2m=[0m0.001833521
[DEBUG] ProjectionStore: Finished DB query for account_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[2m2025-07-30T10:47:34.882634Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933
[2m2025-07-30T10:47:34.882757Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: start for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: before L1 cache lookup for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: L1 cache miss for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: before Redis lookup for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: Redis miss for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] CacheService::get_account: returning None for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[2m2025-07-30T10:47:34.884486Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] get_account: start for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] get_account: acquiring cache read lock for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] get_account: acquired cache read lock for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] get_account: cache miss for 9f42ccc5-8766-4904-94ab-030dd75e9abc
[DEBUG] ProjectionStore: About to query DB for account_id=9f42ccc5-8766-4904-94ab-030dd75e9abc
[2m2025-07-30T10:47:34.888983Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.0881ms [3melapsed_secs[0m[2m=[0m0.0020881
[DEBUG] ProjectionStore: Finished DB query for account_id=9f42ccc5-8766-4904-94ab-030dd75e9abc
[2m2025-07-30T10:47:34.890959Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 9f42ccc5-8766-4904-94ab-030dd75e9abc
[2m2025-07-30T10:47:34.891007Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: start for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: before L1 cache lookup for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: L1 cache miss for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: before Redis lookup for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: Redis miss for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] CacheService::get_account: returning None for 8d973005-da14-446b-b507-7f6e9cd4399e
[2m2025-07-30T10:47:34.892804Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] get_account: start for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] get_account: acquiring cache read lock for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] get_account: acquired cache read lock for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] get_account: cache miss for 8d973005-da14-446b-b507-7f6e9cd4399e
[DEBUG] ProjectionStore: About to query DB for account_id=8d973005-da14-446b-b507-7f6e9cd4399e
[2m2025-07-30T10:47:34.896983Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.600198ms [3melapsed_secs[0m[2m=[0m0.001600198
[DEBUG] ProjectionStore: Finished DB query for account_id=8d973005-da14-446b-b507-7f6e9cd4399e
[2m2025-07-30T10:47:34.900724Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 8d973005-da14-446b-b507-7f6e9cd4399e
[2m2025-07-30T10:47:34.900809Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: start for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: before L1 cache lookup for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: L1 cache miss for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: before Redis lookup for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: Redis miss for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] CacheService::get_account: returning None for 94f664e3-df24-405e-8033-914fa42fc6d2
[2m2025-07-30T10:47:34.903321Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] get_account: start for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] get_account: acquiring cache read lock for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] get_account: acquired cache read lock for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] get_account: cache miss for 94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] ProjectionStore: About to query DB for account_id=94f664e3-df24-405e-8033-914fa42fc6d2
[2m2025-07-30T10:47:34.907999Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.096592ms [3melapsed_secs[0m[2m=[0m0.002096592
[DEBUG] ProjectionStore: Finished DB query for account_id=94f664e3-df24-405e-8033-914fa42fc6d2
[DEBUG] OutboxBatcher::flush: Flushing 4 messages
[2m2025-07-30T10:47:34.919179Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 4 messages
[2m2025-07-30T10:47:34.920820Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 94f664e3-df24-405e-8033-914fa42fc6d2
[2m2025-07-30T10:47:34.920969Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 8 projections to ProjectionStore. IDs: [2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[2m2025-07-30T10:47:34.921177Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 8 accounts. IDs: [2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[2m2025-07-30T10:47:34.921201Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=2b7940e6-3f66-4d87-a21f-63976829668f, owner_name=StressTestUser_13
[2m2025-07-30T10:47:34.921219Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314, owner_name=StressTestUser_8
[2m2025-07-30T10:47:34.921238Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, owner_name=StressTestUser_3
[2m2025-07-30T10:47:34.921256Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=cce69089-c607-40e6-9437-d36c2bd44cef, owner_name=StressTestUser_4
[2m2025-07-30T10:47:34.921276Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, owner_name=StressTestUser_1
[2m2025-07-30T10:47:34.921295Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=9f42ccc5-8766-4904-94ab-030dd75e9abc, owner_name=StressTestUser_0
[2m2025-07-30T10:47:34.921313Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=8d973005-da14-446b-b507-7f6e9cd4399e, owner_name=StressTestUser_10
[2m2025-07-30T10:47:34.921331Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=94f664e3-df24-405e-8033-914fa42fc6d2, owner_name=StressTestUser_5
[2m2025-07-30T10:47:34.921365Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:34.921477Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {8d973005-da14-446b-b507-7f6e9cd4399e: true, cb146a59-24f7-4da9-b46c-0bd86e4e5314: true, 2b7940e6-3f66-4d87-a21f-63976829668f: true, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769: true, 94f664e3-df24-405e-8033-914fa42fc6d2: true, 9f42ccc5-8766-4904-94ab-030dd75e9abc: true, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933: true, cce69089-c607-40e6-9437-d36c2bd44cef: true}
[2m2025-07-30T10:47:34.921515Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 8 events in 86ms, throughput: 93/s
[2m2025-07-30T10:47:34.929379Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m4 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.620534ms [3melapsed_secs[0m[2m=[0m0.002620534
[2m2025-07-30T10:47:34.929609Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 4 messages in 10.422569ms
[2m2025-07-30T10:47:34.931399Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.436775ms [3melapsed_secs[0m[2m=[0m0.001436775
[2m2025-07-30T10:47:34.931696Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 4 messages in 13.250006ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.932163Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 8. IDs: [2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 1 messages
[DEBUG] OutboxBatcher::flush: Flushing 5 messages
[2m2025-07-30T10:47:34.933044Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 8 accounts to DB. IDs: [2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[2m2025-07-30T10:47:34.933800Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.933971Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 1 messages
[2m2025-07-30T10:47:34.934103Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 5 messages
[2m2025-07-30T10:47:34.935020Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[2m2025-07-30T10:47:34.935041Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=2b7940e6-3f66-4d87-a21f-63976829668f, owner_name=StressTestUser_13
[2m2025-07-30T10:47:34.935048Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=cb146a59-24f7-4da9-b46c-0bd86e4e5314, owner_name=StressTestUser_8
[2m2025-07-30T10:47:34.935053Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, owner_name=StressTestUser_3
[2m2025-07-30T10:47:34.935057Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=cce69089-c607-40e6-9437-d36c2bd44cef, owner_name=StressTestUser_4
[2m2025-07-30T10:47:34.935062Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, owner_name=StressTestUser_1
[2m2025-07-30T10:47:34.935066Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=9f42ccc5-8766-4904-94ab-030dd75e9abc, owner_name=StressTestUser_0
[2m2025-07-30T10:47:34.935071Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=8d973005-da14-446b-b507-7f6e9cd4399e, owner_name=StressTestUser_10
[2m2025-07-30T10:47:34.935075Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=94f664e3-df24-405e-8033-914fa42fc6d2, owner_name=StressTestUser_5
[DEBUG] OutboxBatcher::flush: Flushing 5 messages
[2m2025-07-30T10:47:34.943724Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.330976ms [3melapsed_secs[0m[2m=[0m0.003330976
[2m2025-07-30T10:47:34.943782Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 9.980976ms
[2m2025-07-30T10:47:34.951507Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.953497ms [3melapsed_secs[0m[2m=[0m0.009953497
[2m2025-07-30T10:47:34.951585Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 1 messages in 17.601254ms
[DEBUG] OutboxBatcher::flush: Flushing 7 messages
[2m2025-07-30T10:47:34.952820Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 5 messages
[2m2025-07-30T10:47:34.959973Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m18.951161ms [3melapsed_secs[0m[2m=[0m0.018951161
[2m2025-07-30T10:47:34.960013Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 5 messages in 25.911505ms
[2m2025-07-30T10:47:34.960146Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m16.313676ms [3melapsed_secs[0m[2m=[0m0.016313676
[2m2025-07-30T10:47:34.960206Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 27.948418ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.960310Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.624502ms [3melapsed_secs[0m[2m=[0m0.008624502
[2m2025-07-30T10:47:34.960359Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 1 messages in 27.879217ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.968022Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m8 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m25.373675ms [3melapsed_secs[0m[2m=[0m0.025373675
[2m2025-07-30T10:47:34.968095Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=8
[2m2025-07-30T10:47:34.969733Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.650025ms [3melapsed_secs[0m[2m=[0m0.009650025
[2m2025-07-30T10:47:34.969837Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 5 messages in 37.252233ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:34.969941Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Starting bulk insert of 7 messages
[2m2025-07-30T10:47:34.970208Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.063176ms [3melapsed_secs[0m[2m=[0m0.002063176
[2m2025-07-30T10:47:34.970268Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 8 accounts. IDs: [2b7940e6-3f66-4d87-a21f-63976829668f, cb146a59-24f7-4da9-b46c-0bd86e4e5314, 693cdbe7-cb05-4b71-9a8d-4a9dda6d7769, cce69089-c607-40e6-9437-d36c2bd44cef, e1750eb7-4cbd-42f7-9d7e-ba71e1fa9933, 9f42ccc5-8766-4904-94ab-030dd75e9abc, 8d973005-da14-446b-b507-7f6e9cd4399e, 94f664e3-df24-405e-8033-914fa42fc6d2]
[2m2025-07-30T10:47:34.991099Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m18.54142ms [3melapsed_secs[0m[2m=[0m0.01854142
[2m2025-07-30T10:47:34.991190Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 5 messages in 38.376861ms
[2m2025-07-30T10:47:34.993031Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.673921ms [3melapsed_secs[0m[2m=[0m0.001673921
[2m2025-07-30T10:47:34.993236Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 5 messages in 57.416113ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:35.001067Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO kafka_outbox_cdc (aggregate_id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  kafka_outbox_cdc (\n    aggregate_id,\n    event_id,\n    event_type,\n    payload,\n    topic,\n    metadata,\n    created_at,\n    updated_at\n  )\nSELECT\n  unnest($1 :: uuid []) as aggregate_id,\n  unnest($2 :: uuid []) as event_id,\n  unnest($3 :: text []) as event_type,\n  unnest($4 :: bytea []) as payload,\n  unnest($5 :: text []) as topic,\n  unnest($6 :: jsonb []) as metadata,\n  NOW() as created_at,\n  NOW() as updated_at\n" [3mrows_affected[0m[2m=[0m7 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m24.733972ms [3melapsed_secs[0m[2m=[0m0.024733972
[2m2025-07-30T10:47:35.001120Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCOutboxRepository: Successfully bulk inserted 7 messages in 31.181826ms
[2m2025-07-30T10:47:35.002188Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.016272ms [3melapsed_secs[0m[2m=[0m0.001016272
[2m2025-07-30T10:47:35.002230Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m ✅ OutboxBatcher: Flushed 7 messages in 50.234245ms
[DEBUG] OutboxBatcher::flush: Flush complete
[2m2025-07-30T10:47:35.152230Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300036e8, event_ptr: 0x714430003670 }
[2m2025-07-30T10:47:35.152509Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("b9d64fad-b777-4586-afbd-9857b52c8c50"), "created_at": String("2025-07-30T10:47:34.739411Z"), "event_id": String("bfd10942-85a8-4137-8135-6bfa610eb812"), "event_type": String("AccountCreated"), "id": String("141a4994-5a2c-4600-bf65-2d0c99ca0147"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAudZPrbd3RYavvZhXtSyMUBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739411Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.152604Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("b9d64fad-b777-4586-afbd-9857b52c8c50"), "created_at": String("2025-07-30T10:47:34.739411Z"), "event_id": String("bfd10942-85a8-4137-8135-6bfa610eb812"), "event_type": String("AccountCreated"), "id": String("141a4994-5a2c-4600-bf65-2d0c99ca0147"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAudZPrbd3RYavvZhXtSyMUBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739411Z")}
[2m2025-07-30T10:47:35.152650Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=b9d64fad-b777-4586-afbd-9857b52c8c50, event_id=bfd10942-85a8-4137-8135-6bfa610eb812, event_type=AccountCreated
[2m2025-07-30T10:47:35.152689Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id bfd10942-85a8-4137-8135-6bfa610eb812: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 185, 214, 79, 173])
[2m2025-07-30T10:47:35.152737Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: bfd10942-85a8-4137-8135-6bfa610eb812, Aggregate: b9d64fad-b777-4586-afbd-9857b52c8c50, Type: AccountCreated
[2m2025-07-30T10:47:35.152766Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id bfd10942-85a8-4137-8135-6bfa610eb812
[2m2025-07-30T10:47:35.152787Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: bfd10942-85a8-4137-8135-6bfa610eb812
[2m2025-07-30T10:47:35.152881Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: bfd10942-85a8-4137-8135-6bfa610eb812
[2m2025-07-30T10:47:35.152905Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (immediate)
[2m2025-07-30T10:47:35.152932Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=b9d64fad-b777-4586-afbd-9857b52c8c50 status=Completed
[2m2025-07-30T10:47:35.152956Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (immediate)
[2m2025-07-30T10:47:35.152974Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (immediate)
[2m2025-07-30T10:47:35.152995Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=b9d64fad-b777-4586-afbd-9857b52c8c50 status=Completed
[2m2025-07-30T10:47:35.153019Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate b9d64fad-b777-4586-afbd-9857b52c8c50 (immediate)
[2m2025-07-30T10:47:35.153133Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300036e8    
[2m2025-07-30T10:47:35.153156Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300036e8    
[2m2025-07-30T10:47:35.153172Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430003670    
[2m2025-07-30T10:47:35.153193Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430003670    
[2m2025-07-30T10:47:35.153254Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007928, event_ptr: 0x7144300078b0 }
[2m2025-07-30T10:47:35.153471Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("76712f66-7c6a-4f2a-a27b-b088343a009f"), "created_at": String("2025-07-30T10:47:34.739498Z"), "event_id": String("3176200c-d481-4c23-934d-e6da9aa37ae2"), "event_type": String("AccountCreated"), "id": String("4656b474-5b94-42f3-a138-9abb12e9b143"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAdnEvZnxqTyqie7CINDoAnxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739498Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.153547Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("76712f66-7c6a-4f2a-a27b-b088343a009f"), "created_at": String("2025-07-30T10:47:34.739498Z"), "event_id": String("3176200c-d481-4c23-934d-e6da9aa37ae2"), "event_type": String("AccountCreated"), "id": String("4656b474-5b94-42f3-a138-9abb12e9b143"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAdnEvZnxqTyqie7CINDoAnxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739498Z")}
[2m2025-07-30T10:47:35.153584Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=76712f66-7c6a-4f2a-a27b-b088343a009f, event_id=3176200c-d481-4c23-934d-e6da9aa37ae2, event_type=AccountCreated
[2m2025-07-30T10:47:35.153632Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 3176200c-d481-4c23-934d-e6da9aa37ae2: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 118, 113, 47, 102])
[2m2025-07-30T10:47:35.153709Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 3176200c-d481-4c23-934d-e6da9aa37ae2, Aggregate: 76712f66-7c6a-4f2a-a27b-b088343a009f, Type: AccountCreated
[2m2025-07-30T10:47:35.153748Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 3176200c-d481-4c23-934d-e6da9aa37ae2
[2m2025-07-30T10:47:35.153771Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 3176200c-d481-4c23-934d-e6da9aa37ae2
[2m2025-07-30T10:47:35.153855Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 3176200c-d481-4c23-934d-e6da9aa37ae2
[2m2025-07-30T10:47:35.153880Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (immediate)
[2m2025-07-30T10:47:35.153905Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=76712f66-7c6a-4f2a-a27b-b088343a009f status=Completed
[2m2025-07-30T10:47:35.153934Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (immediate)
[2m2025-07-30T10:47:35.153954Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (immediate)
[2m2025-07-30T10:47:35.153977Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=76712f66-7c6a-4f2a-a27b-b088343a009f status=Completed
[2m2025-07-30T10:47:35.153998Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 76712f66-7c6a-4f2a-a27b-b088343a009f (immediate)
[2m2025-07-30T10:47:35.154090Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007928    
[2m2025-07-30T10:47:35.154112Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007928    
[2m2025-07-30T10:47:35.154127Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300078b0    
[2m2025-07-30T10:47:35.154143Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300078b0    
[2m2025-07-30T10:47:35.154184Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007a68, event_ptr: 0x7144300079f0 }
[2m2025-07-30T10:47:35.154394Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("ee19dd02-b0a7-4f94-9748-7f6534e31dba"), "event_type": String("AccountCreated"), "id": String("1a3b29a9-bf64-4be8-b56f-32e3d829a43a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA8s508z84TUO3+uTrbKdfShAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNwQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.154471Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("ee19dd02-b0a7-4f94-9748-7f6534e31dba"), "event_type": String("AccountCreated"), "id": String("1a3b29a9-bf64-4be8-b56f-32e3d829a43a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA8s508z84TUO3+uTrbKdfShAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNwQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.154507Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, event_id=ee19dd02-b0a7-4f94-9748-7f6534e31dba, event_type=AccountCreated
[2m2025-07-30T10:47:35.154544Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id ee19dd02-b0a7-4f94-9748-7f6534e31dba: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 242, 206, 116, 243])
[2m2025-07-30T10:47:35.154609Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: ee19dd02-b0a7-4f94-9748-7f6534e31dba, Aggregate: f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, Type: AccountCreated
[2m2025-07-30T10:47:35.154651Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id ee19dd02-b0a7-4f94-9748-7f6534e31dba
[2m2025-07-30T10:47:35.154676Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: ee19dd02-b0a7-4f94-9748-7f6534e31dba
[2m2025-07-30T10:47:35.154752Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: ee19dd02-b0a7-4f94-9748-7f6534e31dba
[2m2025-07-30T10:47:35.154776Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (immediate)
[2m2025-07-30T10:47:35.154803Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a status=Completed
[2m2025-07-30T10:47:35.154830Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (immediate)
[2m2025-07-30T10:47:35.154851Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (immediate)
[2m2025-07-30T10:47:35.154876Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a status=Completed
[2m2025-07-30T10:47:35.154900Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a (immediate)
[2m2025-07-30T10:47:35.154991Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007a68    
[2m2025-07-30T10:47:35.155017Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007a68    
[2m2025-07-30T10:47:35.155031Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300079f0    
[2m2025-07-30T10:47:35.155047Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300079f0    
[2m2025-07-30T10:47:35.155108Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007ba8, event_ptr: 0x714430007b30 }
[2m2025-07-30T10:47:35.155309Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("3f72cff7-d030-48d3-bcef-fc8bc53d1802"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("0a066437-a88f-467f-9b94-acfbdac9915e"), "event_type": String("AccountCreated"), "id": String("433152e3-8778-4cfb-8127-769ed55e634a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAP3LP99AwSNO87/yLxT0YAhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.155383Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("3f72cff7-d030-48d3-bcef-fc8bc53d1802"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("0a066437-a88f-467f-9b94-acfbdac9915e"), "event_type": String("AccountCreated"), "id": String("433152e3-8778-4cfb-8127-769ed55e634a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAP3LP99AwSNO87/yLxT0YAhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}
[2m2025-07-30T10:47:35.155413Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802, event_id=0a066437-a88f-467f-9b94-acfbdac9915e, event_type=AccountCreated
[2m2025-07-30T10:47:35.155473Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 0a066437-a88f-467f-9b94-acfbdac9915e: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 63, 114, 207, 247])
[2m2025-07-30T10:47:35.155518Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 0a066437-a88f-467f-9b94-acfbdac9915e, Aggregate: 3f72cff7-d030-48d3-bcef-fc8bc53d1802, Type: AccountCreated
[2m2025-07-30T10:47:35.155545Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 0a066437-a88f-467f-9b94-acfbdac9915e
[2m2025-07-30T10:47:35.155563Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 0a066437-a88f-467f-9b94-acfbdac9915e
[2m2025-07-30T10:47:35.155637Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 0a066437-a88f-467f-9b94-acfbdac9915e
[2m2025-07-30T10:47:35.155661Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (immediate)
[2m2025-07-30T10:47:35.155687Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802 status=Completed
[2m2025-07-30T10:47:35.155709Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (immediate)
[2m2025-07-30T10:47:35.155727Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (immediate)
[2m2025-07-30T10:47:35.155747Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802 status=Completed
[2m2025-07-30T10:47:35.155770Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 3f72cff7-d030-48d3-bcef-fc8bc53d1802 (immediate)
[2m2025-07-30T10:47:35.155838Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007ba8    
[2m2025-07-30T10:47:35.155855Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007ba8    
[2m2025-07-30T10:47:35.155868Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007b30    
[2m2025-07-30T10:47:35.155881Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007b30    
[2m2025-07-30T10:47:35.155903Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007ce8, event_ptr: 0x714430007c70 }
[2m2025-07-30T10:47:35.156080Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("b89811b8-79a0-444b-b81c-b5d1318fcf37"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("66953c8a-fdb0-4121-842d-a26a1e1a804a"), "event_type": String("AccountCreated"), "id": String("3e0723b5-933e-47e8-a3ff-e8d6e28b6e23"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAuJgRuHmgREu4HLXRMY/PNxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.156147Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("b89811b8-79a0-444b-b81c-b5d1318fcf37"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("66953c8a-fdb0-4121-842d-a26a1e1a804a"), "event_type": String("AccountCreated"), "id": String("3e0723b5-933e-47e8-a3ff-e8d6e28b6e23"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAuJgRuHmgREu4HLXRMY/PNxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}
[2m2025-07-30T10:47:35.156179Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=b89811b8-79a0-444b-b81c-b5d1318fcf37, event_id=66953c8a-fdb0-4121-842d-a26a1e1a804a, event_type=AccountCreated
[2m2025-07-30T10:47:35.156207Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 66953c8a-fdb0-4121-842d-a26a1e1a804a: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 184, 152, 17, 184])
[2m2025-07-30T10:47:35.156240Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 66953c8a-fdb0-4121-842d-a26a1e1a804a, Aggregate: b89811b8-79a0-444b-b81c-b5d1318fcf37, Type: AccountCreated
[2m2025-07-30T10:47:35.156265Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 66953c8a-fdb0-4121-842d-a26a1e1a804a
[2m2025-07-30T10:47:35.156286Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 66953c8a-fdb0-4121-842d-a26a1e1a804a
[2m2025-07-30T10:47:35.156363Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 66953c8a-fdb0-4121-842d-a26a1e1a804a
[2m2025-07-30T10:47:35.156385Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (immediate)
[2m2025-07-30T10:47:35.156406Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=b89811b8-79a0-444b-b81c-b5d1318fcf37 status=Completed
[2m2025-07-30T10:47:35.156426Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (immediate)
[2m2025-07-30T10:47:35.156443Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (immediate)
[2m2025-07-30T10:47:35.156463Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=b89811b8-79a0-444b-b81c-b5d1318fcf37 status=Completed
[2m2025-07-30T10:47:35.156482Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate b89811b8-79a0-444b-b81c-b5d1318fcf37 (immediate)
[2m2025-07-30T10:47:35.156543Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007ce8    
[2m2025-07-30T10:47:35.156558Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007ce8    
[2m2025-07-30T10:47:35.156572Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007c70    
[2m2025-07-30T10:47:35.156584Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007c70    
[2m2025-07-30T10:47:35.156609Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007e28, event_ptr: 0x714430007db0 }
[2m2025-07-30T10:47:35.156789Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("b44cb9ca-2459-42f3-b1ed-f384936e1654"), "created_at": String("2025-07-30T10:47:34.739498Z"), "event_id": String("ea259d86-037e-46c3-b196-16332a44b94b"), "event_type": String("AccountCreated"), "id": String("903553ca-72c6-44f3-99d0-8fcf6da2d4a2"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAtEy5yiRZQvOx7fOEk24WVBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739498Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.156853Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("b44cb9ca-2459-42f3-b1ed-f384936e1654"), "created_at": String("2025-07-30T10:47:34.739498Z"), "event_id": String("ea259d86-037e-46c3-b196-16332a44b94b"), "event_type": String("AccountCreated"), "id": String("903553ca-72c6-44f3-99d0-8fcf6da2d4a2"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAtEy5yiRZQvOx7fOEk24WVBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739498Z")}
[2m2025-07-30T10:47:35.156883Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=b44cb9ca-2459-42f3-b1ed-f384936e1654, event_id=ea259d86-037e-46c3-b196-16332a44b94b, event_type=AccountCreated
[2m2025-07-30T10:47:35.156911Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id ea259d86-037e-46c3-b196-16332a44b94b: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 180, 76, 185, 202])
[2m2025-07-30T10:47:35.156941Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: ea259d86-037e-46c3-b196-16332a44b94b, Aggregate: b44cb9ca-2459-42f3-b1ed-f384936e1654, Type: AccountCreated
[2m2025-07-30T10:47:35.156966Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id ea259d86-037e-46c3-b196-16332a44b94b
[2m2025-07-30T10:47:35.156987Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: ea259d86-037e-46c3-b196-16332a44b94b
[2m2025-07-30T10:47:35.157031Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: ea259d86-037e-46c3-b196-16332a44b94b
[2m2025-07-30T10:47:35.157053Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (immediate)
[2m2025-07-30T10:47:35.157076Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=b44cb9ca-2459-42f3-b1ed-f384936e1654 status=Completed
[2m2025-07-30T10:47:35.157098Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (immediate)
[2m2025-07-30T10:47:35.157115Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (immediate)
[2m2025-07-30T10:47:35.157136Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=b44cb9ca-2459-42f3-b1ed-f384936e1654 status=Completed
[2m2025-07-30T10:47:35.157155Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate b44cb9ca-2459-42f3-b1ed-f384936e1654 (immediate)
[2m2025-07-30T10:47:35.157240Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007e28    
[2m2025-07-30T10:47:35.157257Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007e28    
[2m2025-07-30T10:47:35.157272Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007db0    
[2m2025-07-30T10:47:35.157285Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007db0    
[2m2025-07-30T10:47:35.157323Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007f68, event_ptr: 0x714430007ef0 }
[2m2025-07-30T10:47:35.157499Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("2fed6150-edc2-4f35-92e2-2653975a4ab4"), "created_at": String("2025-07-30T10:47:34.739600Z"), "event_id": String("163c3131-0986-4154-b779-fcd36b7cbc1e"), "event_type": String("AccountCreated"), "id": String("c0a697af-ba17-4eee-a629-ff06311a3a27"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAL+1hUO3CTzWS4iZTl1pKtBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739600Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.157565Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("2fed6150-edc2-4f35-92e2-2653975a4ab4"), "created_at": String("2025-07-30T10:47:34.739600Z"), "event_id": String("163c3131-0986-4154-b779-fcd36b7cbc1e"), "event_type": String("AccountCreated"), "id": String("c0a697af-ba17-4eee-a629-ff06311a3a27"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAL+1hUO3CTzWS4iZTl1pKtBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739600Z")}
[2m2025-07-30T10:47:35.157594Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=2fed6150-edc2-4f35-92e2-2653975a4ab4, event_id=163c3131-0986-4154-b779-fcd36b7cbc1e, event_type=AccountCreated
[2m2025-07-30T10:47:35.157632Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 163c3131-0986-4154-b779-fcd36b7cbc1e: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 47, 237, 97, 80])
[2m2025-07-30T10:47:35.157673Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 163c3131-0986-4154-b779-fcd36b7cbc1e, Aggregate: 2fed6150-edc2-4f35-92e2-2653975a4ab4, Type: AccountCreated
[2m2025-07-30T10:47:35.157699Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 163c3131-0986-4154-b779-fcd36b7cbc1e
[2m2025-07-30T10:47:35.157721Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 163c3131-0986-4154-b779-fcd36b7cbc1e
[2m2025-07-30T10:47:35.157787Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 163c3131-0986-4154-b779-fcd36b7cbc1e
[2m2025-07-30T10:47:35.157808Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (immediate)
[2m2025-07-30T10:47:35.157841Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=2fed6150-edc2-4f35-92e2-2653975a4ab4 status=Completed
[2m2025-07-30T10:47:35.157864Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (immediate)
[2m2025-07-30T10:47:35.157880Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (immediate)
[2m2025-07-30T10:47:35.157912Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=2fed6150-edc2-4f35-92e2-2653975a4ab4 status=Completed
[2m2025-07-30T10:47:35.157940Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 2fed6150-edc2-4f35-92e2-2653975a4ab4 (immediate)
[2m2025-07-30T10:47:35.158016Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007f68    
[2m2025-07-30T10:47:35.158035Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007f68    
[2m2025-07-30T10:47:35.158052Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007ef0    
[2m2025-07-30T10:47:35.158072Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007ef0    
[2m2025-07-30T10:47:35.158120Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300080a8, event_ptr: 0x714430008030 }
[2m2025-07-30T10:47:35.158300Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("fda66298-fb9c-4549-b9c2-03730860c4f5"), "event_type": String("AccountCreated"), "id": String("c5f02828-4977-4830-bd92-8d2b4e498d7c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAeyjwrozDSziRul9f/4KKPhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.158368Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("fda66298-fb9c-4549-b9c2-03730860c4f5"), "event_type": String("AccountCreated"), "id": String("c5f02828-4977-4830-bd92-8d2b4e498d7c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAeyjwrozDSziRul9f/4KKPhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.158399Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, event_id=fda66298-fb9c-4549-b9c2-03730860c4f5, event_type=AccountCreated
[2m2025-07-30T10:47:35.158427Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id fda66298-fb9c-4549-b9c2-03730860c4f5: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 123, 40, 240, 174])
[2m2025-07-30T10:47:35.158465Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: fda66298-fb9c-4549-b9c2-03730860c4f5, Aggregate: 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, Type: AccountCreated
[2m2025-07-30T10:47:35.158494Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id fda66298-fb9c-4549-b9c2-03730860c4f5
[2m2025-07-30T10:47:35.158512Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: fda66298-fb9c-4549-b9c2-03730860c4f5
[2m2025-07-30T10:47:35.158566Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: fda66298-fb9c-4549-b9c2-03730860c4f5
[2m2025-07-30T10:47:35.158590Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (immediate)
[2m2025-07-30T10:47:35.158612Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e status=Completed
[2m2025-07-30T10:47:35.158651Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (immediate)
[2m2025-07-30T10:47:35.158672Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (immediate)
[2m2025-07-30T10:47:35.158693Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e status=Completed
[2m2025-07-30T10:47:35.158713Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e (immediate)
[2m2025-07-30T10:47:35.158786Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300080a8    
[2m2025-07-30T10:47:35.158804Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300080a8    
[2m2025-07-30T10:47:35.158819Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008030    
[2m2025-07-30T10:47:35.158835Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008030    
[2m2025-07-30T10:47:35.158874Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300081e8, event_ptr: 0x714430008170 }
[2m2025-07-30T10:47:35.159064Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("c4897ec9-f2ac-45df-aefa-9326bfac6a2f"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("c7e36ea6-5554-4094-abb8-3b04484ed6bd"), "event_type": String("AccountCreated"), "id": String("1ee3afcb-5ad9-4eba-b427-da626357ac1a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAxIl+yfKsRd+u+pMmv6xqLxAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMgQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.159128Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("c4897ec9-f2ac-45df-aefa-9326bfac6a2f"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("c7e36ea6-5554-4094-abb8-3b04484ed6bd"), "event_type": String("AccountCreated"), "id": String("1ee3afcb-5ad9-4eba-b427-da626357ac1a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAxIl+yfKsRd+u+pMmv6xqLxAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMgQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.159162Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f, event_id=c7e36ea6-5554-4094-abb8-3b04484ed6bd, event_type=AccountCreated
[2m2025-07-30T10:47:35.159191Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id c7e36ea6-5554-4094-abb8-3b04484ed6bd: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 196, 137, 126, 201])
[2m2025-07-30T10:47:35.159228Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: c7e36ea6-5554-4094-abb8-3b04484ed6bd, Aggregate: c4897ec9-f2ac-45df-aefa-9326bfac6a2f, Type: AccountCreated
[2m2025-07-30T10:47:35.159254Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id c7e36ea6-5554-4094-abb8-3b04484ed6bd
[2m2025-07-30T10:47:35.159280Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: c7e36ea6-5554-4094-abb8-3b04484ed6bd
[2m2025-07-30T10:47:35.159501Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] CacheService::get_account: start for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] CacheService::get_account: before L1 cache lookup for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] CacheService::get_account: L1 cache miss for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] CacheService::get_account: before Redis lookup for b9d64fad-b777-4586-afbd-9857b52c8c50
[2m2025-07-30T10:47:35.159762Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: c7e36ea6-5554-4094-abb8-3b04484ed6bd
[2m2025-07-30T10:47:35.159794Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (immediate)
[2m2025-07-30T10:47:35.159848Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f status=Completed
[2m2025-07-30T10:47:35.159873Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (immediate)
[2m2025-07-30T10:47:35.159891Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (immediate)
[2m2025-07-30T10:47:35.159913Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f status=Completed
[2m2025-07-30T10:47:35.159935Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate c4897ec9-f2ac-45df-aefa-9326bfac6a2f (immediate)
[2m2025-07-30T10:47:35.160028Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300081e8    
[2m2025-07-30T10:47:35.160048Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300081e8    
[2m2025-07-30T10:47:35.160064Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008170    
[2m2025-07-30T10:47:35.160078Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008170    
[2m2025-07-30T10:47:35.160113Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430008328, event_ptr: 0x7144300082b0 }
[2m2025-07-30T10:47:35.160313Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("34068678-f78f-4c4e-897a-320e1e1ef98c"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39"), "event_type": String("AccountCreated"), "id": String("d72337ef-fa27-4069-b8f1-ffa1a07fdbea"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAANAaGePePTE6JejIOHh75jBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.160385Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("34068678-f78f-4c4e-897a-320e1e1ef98c"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39"), "event_type": String("AccountCreated"), "id": String("d72337ef-fa27-4069-b8f1-ffa1a07fdbea"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAANAaGePePTE6JejIOHh75jBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.160421Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=34068678-f78f-4c4e-897a-320e1e1ef98c, event_id=deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39, event_type=AccountCreated
[2m2025-07-30T10:47:35.160455Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 52, 6, 134, 120])
[2m2025-07-30T10:47:35.160509Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39, Aggregate: 34068678-f78f-4c4e-897a-320e1e1ef98c, Type: AccountCreated
[2m2025-07-30T10:47:35.160539Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39
[2m2025-07-30T10:47:35.160562Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39
[DEBUG] CacheService::get_account: Redis miss for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] CacheService::get_account: returning None for b9d64fad-b777-4586-afbd-9857b52c8c50
[2m2025-07-30T10:47:35.184975Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] get_account: start for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] get_account: acquiring cache read lock for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] get_account: acquired cache read lock for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] get_account: cache miss for b9d64fad-b777-4586-afbd-9857b52c8c50
[DEBUG] ProjectionStore: About to query DB for account_id=b9d64fad-b777-4586-afbd-9857b52c8c50
[2m2025-07-30T10:47:35.195374Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m7.343908ms [3melapsed_secs[0m[2m=[0m0.007343908
[DEBUG] ProjectionStore: Finished DB query for account_id=b9d64fad-b777-4586-afbd-9857b52c8c50
[2m2025-07-30T10:47:35.207528Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: b9d64fad-b777-4586-afbd-9857b52c8c50
[2m2025-07-30T10:47:35.208074Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: start for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: before L1 cache lookup for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: L1 cache miss for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: before Redis lookup for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: Redis miss for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] CacheService::get_account: returning None for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[2m2025-07-30T10:47:35.218082Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] get_account: start for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] get_account: acquiring cache read lock for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] get_account: acquired cache read lock for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] get_account: cache miss for 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[DEBUG] ProjectionStore: About to query DB for account_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802
[2m2025-07-30T10:47:35.225729Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.306944ms [3melapsed_secs[0m[2m=[0m0.004306944
[DEBUG] ProjectionStore: Finished DB query for account_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802
[2m2025-07-30T10:47:35.237068Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 3f72cff7-d030-48d3-bcef-fc8bc53d1802
[2m2025-07-30T10:47:35.237144Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: start for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: before L1 cache lookup for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: L1 cache miss for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: before Redis lookup for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: Redis miss for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] CacheService::get_account: returning None for b44cb9ca-2459-42f3-b1ed-f384936e1654
[2m2025-07-30T10:47:35.253684Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] get_account: start for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] get_account: acquiring cache read lock for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] get_account: acquired cache read lock for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] get_account: cache miss for b44cb9ca-2459-42f3-b1ed-f384936e1654
[DEBUG] ProjectionStore: About to query DB for account_id=b44cb9ca-2459-42f3-b1ed-f384936e1654
[2m2025-07-30T10:47:35.264912Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.306339ms [3melapsed_secs[0m[2m=[0m0.006306339
[DEBUG] ProjectionStore: Finished DB query for account_id=b44cb9ca-2459-42f3-b1ed-f384936e1654
[2m2025-07-30T10:47:35.277578Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: b44cb9ca-2459-42f3-b1ed-f384936e1654
[2m2025-07-30T10:47:35.277710Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: start for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: before L1 cache lookup for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: L1 cache miss for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: before Redis lookup for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: Redis miss for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] CacheService::get_account: returning None for 76712f66-7c6a-4f2a-a27b-b088343a009f
[2m2025-07-30T10:47:35.287043Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] get_account: start for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] get_account: acquiring cache read lock for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] get_account: acquired cache read lock for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] get_account: cache miss for 76712f66-7c6a-4f2a-a27b-b088343a009f
[DEBUG] ProjectionStore: About to query DB for account_id=76712f66-7c6a-4f2a-a27b-b088343a009f
[2m2025-07-30T10:47:35.295417Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.844619ms [3melapsed_secs[0m[2m=[0m0.005844619
[DEBUG] ProjectionStore: Finished DB query for account_id=76712f66-7c6a-4f2a-a27b-b088343a009f
[2m2025-07-30T10:47:35.307956Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 76712f66-7c6a-4f2a-a27b-b088343a009f
[2m2025-07-30T10:47:35.308125Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: start for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: before L1 cache lookup for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: L1 cache miss for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: before Redis lookup for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: Redis miss for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] CacheService::get_account: returning None for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[2m2025-07-30T10:47:35.317811Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] get_account: start for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] get_account: acquiring cache read lock for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] get_account: acquired cache read lock for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] get_account: cache miss for 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[DEBUG] ProjectionStore: About to query DB for account_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[2m2025-07-30T10:47:35.328774Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.837779ms [3melapsed_secs[0m[2m=[0m0.006837779
[DEBUG] ProjectionStore: Finished DB query for account_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[2m2025-07-30T10:47:35.342713Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e
[2m2025-07-30T10:47:35.342789Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: start for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: before L1 cache lookup for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: L1 cache miss for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: before Redis lookup for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: Redis miss for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] CacheService::get_account: returning None for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[2m2025-07-30T10:47:35.353733Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] get_account: start for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] get_account: acquiring cache read lock for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] get_account: acquired cache read lock for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] get_account: cache miss for 2fed6150-edc2-4f35-92e2-2653975a4ab4
[DEBUG] ProjectionStore: About to query DB for account_id=2fed6150-edc2-4f35-92e2-2653975a4ab4
[2m2025-07-30T10:47:35.362065Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.096743ms [3melapsed_secs[0m[2m=[0m0.006096743
[DEBUG] ProjectionStore: Finished DB query for account_id=2fed6150-edc2-4f35-92e2-2653975a4ab4
[2m2025-07-30T10:47:35.374746Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 2fed6150-edc2-4f35-92e2-2653975a4ab4
[2m2025-07-30T10:47:35.374891Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: start for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: before L1 cache lookup for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: L1 cache miss for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: before Redis lookup for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: Redis miss for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] CacheService::get_account: returning None for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[2m2025-07-30T10:47:35.385611Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] get_account: start for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] get_account: acquiring cache read lock for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] get_account: acquired cache read lock for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] get_account: cache miss for f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[DEBUG] ProjectionStore: About to query DB for account_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[2m2025-07-30T10:47:35.395615Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.038584ms [3melapsed_secs[0m[2m=[0m0.006038584
[DEBUG] ProjectionStore: Finished DB query for account_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[2m2025-07-30T10:47:35.409139Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a
[2m2025-07-30T10:47:35.409214Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: start for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: before L1 cache lookup for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: L1 cache miss for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: before Redis lookup for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: Redis miss for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] CacheService::get_account: returning None for b89811b8-79a0-444b-b81c-b5d1318fcf37
[2m2025-07-30T10:47:35.418518Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] get_account: start for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] get_account: acquiring cache read lock for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] get_account: acquired cache read lock for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] get_account: cache miss for b89811b8-79a0-444b-b81c-b5d1318fcf37
[DEBUG] ProjectionStore: About to query DB for account_id=b89811b8-79a0-444b-b81c-b5d1318fcf37
[2m2025-07-30T10:47:35.427931Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.482331ms [3melapsed_secs[0m[2m=[0m0.005482331
[DEBUG] ProjectionStore: Finished DB query for account_id=b89811b8-79a0-444b-b81c-b5d1318fcf37
[2m2025-07-30T10:47:35.439061Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: b89811b8-79a0-444b-b81c-b5d1318fcf37
[2m2025-07-30T10:47:35.439501Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 8 projections to ProjectionStore. IDs: [b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[2m2025-07-30T10:47:35.440500Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: deaa2f12-8b90-4c7d-9ef0-97c5a6c59f39
[2m2025-07-30T10:47:35.440653Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (immediate)
[2m2025-07-30T10:47:35.440710Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=34068678-f78f-4c4e-897a-320e1e1ef98c status=Completed
[2m2025-07-30T10:47:35.440738Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (immediate)
[2m2025-07-30T10:47:35.440765Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (immediate)
[2m2025-07-30T10:47:35.440802Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=34068678-f78f-4c4e-897a-320e1e1ef98c status=Completed
[2m2025-07-30T10:47:35.440824Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 34068678-f78f-4c4e-897a-320e1e1ef98c (immediate)
[2m2025-07-30T10:47:35.441107Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430008328    
[2m2025-07-30T10:47:35.441141Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430008328    
[2m2025-07-30T10:47:35.441157Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300082b0    
[2m2025-07-30T10:47:35.441196Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300082b0    
[2m2025-07-30T10:47:35.441371Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430008468, event_ptr: 0x7144300083f0 }
[2m2025-07-30T10:47:35.441684Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("f28b281d-1783-4d9d-989e-dbf9ed9130cd"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("5cd8df9b-5b49-4951-a4d5-8a2981b99709"), "event_type": String("AccountCreated"), "id": String("65b9c1a5-0908-4e6b-871e-1538c4a218f8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA8osoHReDTZ2Yntv57ZEwzREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.441747Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("f28b281d-1783-4d9d-989e-dbf9ed9130cd"), "created_at": String("2025-07-30T10:47:34.735465Z"), "event_id": String("5cd8df9b-5b49-4951-a4d5-8a2981b99709"), "event_type": String("AccountCreated"), "id": String("65b9c1a5-0908-4e6b-871e-1538c4a218f8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA8osoHReDTZ2Yntv57ZEwzREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.735465Z")}
[2m2025-07-30T10:47:35.441776Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd, event_id=5cd8df9b-5b49-4951-a4d5-8a2981b99709, event_type=AccountCreated
[2m2025-07-30T10:47:35.441818Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 5cd8df9b-5b49-4951-a4d5-8a2981b99709: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 242, 139, 40, 29])
[2m2025-07-30T10:47:35.441869Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 5cd8df9b-5b49-4951-a4d5-8a2981b99709, Aggregate: f28b281d-1783-4d9d-989e-dbf9ed9130cd, Type: AccountCreated
[2m2025-07-30T10:47:35.441887Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 5cd8df9b-5b49-4951-a4d5-8a2981b99709
[2m2025-07-30T10:47:35.441919Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 5cd8df9b-5b49-4951-a4d5-8a2981b99709
[2m2025-07-30T10:47:35.441999Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 5cd8df9b-5b49-4951-a4d5-8a2981b99709
[2m2025-07-30T10:47:35.442021Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (immediate)
[2m2025-07-30T10:47:35.442044Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd status=Completed
[2m2025-07-30T10:47:35.442077Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (immediate)
[2m2025-07-30T10:47:35.442104Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (immediate)
[2m2025-07-30T10:47:35.442140Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd status=Completed
[2m2025-07-30T10:47:35.442174Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate f28b281d-1783-4d9d-989e-dbf9ed9130cd (immediate)
[2m2025-07-30T10:47:35.442270Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430008468    
[2m2025-07-30T10:47:35.442294Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430008468    
[2m2025-07-30T10:47:35.442319Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300083f0    
[2m2025-07-30T10:47:35.442344Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300083f0    
[2m2025-07-30T10:47:35.442379Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300085a8, event_ptr: 0x714430008530 }
[2m2025-07-30T10:47:35.442579Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("5591cc7a-5bfa-49d2-bda8-7e9c78197432"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("f23abe6f-f30c-4991-a8b9-3f8bf78bc96f"), "event_type": String("AccountCreated"), "id": String("61d3d927-8de1-43ff-8e0d-4db40a997e3c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAVZHMelv6SdK9qH6ceBl0MhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.442681Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("5591cc7a-5bfa-49d2-bda8-7e9c78197432"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("f23abe6f-f30c-4991-a8b9-3f8bf78bc96f"), "event_type": String("AccountCreated"), "id": String("61d3d927-8de1-43ff-8e0d-4db40a997e3c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAVZHMelv6SdK9qH6ceBl0MhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.442725Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432, event_id=f23abe6f-f30c-4991-a8b9-3f8bf78bc96f, event_type=AccountCreated
[2m2025-07-30T10:47:35.442764Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id f23abe6f-f30c-4991-a8b9-3f8bf78bc96f: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 85, 145, 204, 122])
[2m2025-07-30T10:47:35.442809Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: f23abe6f-f30c-4991-a8b9-3f8bf78bc96f, Aggregate: 5591cc7a-5bfa-49d2-bda8-7e9c78197432, Type: AccountCreated
[2m2025-07-30T10:47:35.442844Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id f23abe6f-f30c-4991-a8b9-3f8bf78bc96f
[2m2025-07-30T10:47:35.442873Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: f23abe6f-f30c-4991-a8b9-3f8bf78bc96f
[2m2025-07-30T10:47:35.442935Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: f23abe6f-f30c-4991-a8b9-3f8bf78bc96f
[2m2025-07-30T10:47:35.442965Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (immediate)
[2m2025-07-30T10:47:35.442997Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432 status=Completed
[2m2025-07-30T10:47:35.443032Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (immediate)
[2m2025-07-30T10:47:35.443059Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (immediate)
[2m2025-07-30T10:47:35.443091Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432 status=Completed
[2m2025-07-30T10:47:35.443123Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 5591cc7a-5bfa-49d2-bda8-7e9c78197432 (immediate)
[2m2025-07-30T10:47:35.443210Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300085a8    
[2m2025-07-30T10:47:35.443233Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300085a8    
[2m2025-07-30T10:47:35.443257Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430008530    
[2m2025-07-30T10:47:35.443281Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430008530    
[2m2025-07-30T10:47:35.443316Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430003b08, event_ptr: 0x714430003a90 }
[2m2025-07-30T10:47:35.443511Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("15aecab1-20c2-4ee4-9b64-a980a9a341ae"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("8312e630-fbb7-4a1b-a063-a289db1bcd36"), "event_type": String("AccountCreated"), "id": String("a7e1d2b5-fda9-467d-8cf5-424e66070b8e"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAFa7KsSDCTuSbZKmAqaNBrhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.443595Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("15aecab1-20c2-4ee4-9b64-a980a9a341ae"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("8312e630-fbb7-4a1b-a063-a289db1bcd36"), "event_type": String("AccountCreated"), "id": String("a7e1d2b5-fda9-467d-8cf5-424e66070b8e"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAFa7KsSDCTuSbZKmAqaNBrhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.443647Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae, event_id=8312e630-fbb7-4a1b-a063-a289db1bcd36, event_type=AccountCreated
[2m2025-07-30T10:47:35.443686Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 8312e630-fbb7-4a1b-a063-a289db1bcd36: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 21, 174, 202, 177])
[2m2025-07-30T10:47:35.443728Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 8312e630-fbb7-4a1b-a063-a289db1bcd36, Aggregate: 15aecab1-20c2-4ee4-9b64-a980a9a341ae, Type: AccountCreated
[2m2025-07-30T10:47:35.443762Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 8312e630-fbb7-4a1b-a063-a289db1bcd36
[2m2025-07-30T10:47:35.443815Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 8312e630-fbb7-4a1b-a063-a289db1bcd36
[2m2025-07-30T10:47:35.443877Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 8312e630-fbb7-4a1b-a063-a289db1bcd36
[2m2025-07-30T10:47:35.443908Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (immediate)
[2m2025-07-30T10:47:35.443936Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae status=Completed
[2m2025-07-30T10:47:35.443964Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (immediate)
[2m2025-07-30T10:47:35.443988Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (immediate)
[2m2025-07-30T10:47:35.444015Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae status=Completed
[2m2025-07-30T10:47:35.444043Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 15aecab1-20c2-4ee4-9b64-a980a9a341ae (immediate)
[2m2025-07-30T10:47:35.444128Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430003b08    
[2m2025-07-30T10:47:35.444157Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430003b08    
[2m2025-07-30T10:47:35.444173Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430003a90    
[2m2025-07-30T10:47:35.444188Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430003a90    
[2m2025-07-30T10:47:35.444217Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430003c48, event_ptr: 0x714430003bd0 }
[2m2025-07-30T10:47:35.444416Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("d23dfd52-c53e-41ff-ad59-84ce50361f13"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("7c26dcfa-dfea-49eb-8d1d-740c612f9c30"), "event_type": String("AccountCreated"), "id": String("1ba71abf-9cdb-49d4-ae5d-0d8f6ed83c21"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA0j39UsU+Qf+tWYTOUDYfExEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.444502Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("d23dfd52-c53e-41ff-ad59-84ce50361f13"), "created_at": String("2025-07-30T10:47:34.739865Z"), "event_id": String("7c26dcfa-dfea-49eb-8d1d-740c612f9c30"), "event_type": String("AccountCreated"), "id": String("1ba71abf-9cdb-49d4-ae5d-0d8f6ed83c21"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA0j39UsU+Qf+tWYTOUDYfExEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739865Z")}
[2m2025-07-30T10:47:35.444545Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=d23dfd52-c53e-41ff-ad59-84ce50361f13, event_id=7c26dcfa-dfea-49eb-8d1d-740c612f9c30, event_type=AccountCreated
[2m2025-07-30T10:47:35.444581Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 7c26dcfa-dfea-49eb-8d1d-740c612f9c30: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 210, 61, 253, 82])
[2m2025-07-30T10:47:35.444636Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 7c26dcfa-dfea-49eb-8d1d-740c612f9c30, Aggregate: d23dfd52-c53e-41ff-ad59-84ce50361f13, Type: AccountCreated
[2m2025-07-30T10:47:35.444678Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 7c26dcfa-dfea-49eb-8d1d-740c612f9c30
[2m2025-07-30T10:47:35.444711Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 7c26dcfa-dfea-49eb-8d1d-740c612f9c30
[2m2025-07-30T10:47:35.444787Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 7c26dcfa-dfea-49eb-8d1d-740c612f9c30
[2m2025-07-30T10:47:35.444819Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (immediate)
[2m2025-07-30T10:47:35.444853Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=d23dfd52-c53e-41ff-ad59-84ce50361f13 status=Completed
[2m2025-07-30T10:47:35.444880Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (immediate)
[2m2025-07-30T10:47:35.444907Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (immediate)
[2m2025-07-30T10:47:35.444936Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=d23dfd52-c53e-41ff-ad59-84ce50361f13 status=Completed
[2m2025-07-30T10:47:35.444971Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate d23dfd52-c53e-41ff-ad59-84ce50361f13 (immediate)
[2m2025-07-30T10:47:35.445056Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430003c48    
[2m2025-07-30T10:47:35.445081Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430003c48    
[2m2025-07-30T10:47:35.445101Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430003bd0    
[2m2025-07-30T10:47:35.445126Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430003bd0    
[2m2025-07-30T10:47:35.445162Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300036e8, event_ptr: 0x714430003670 }
[2m2025-07-30T10:47:35.445362Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("83985b20-c135-4923-a1b2-1ca795622186"), "created_at": String("2025-07-30T10:47:34.739961Z"), "event_id": String("d887467f-d9ad-47d7-995d-68de26afe872"), "event_type": String("AccountCreated"), "id": String("e3f210c8-8f4a-4c8f-a8ee-c3e93417b0e8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAg5hbIME1SSOhshynlWIhhhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739961Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.445449Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("83985b20-c135-4923-a1b2-1ca795622186"), "created_at": String("2025-07-30T10:47:34.739961Z"), "event_id": String("d887467f-d9ad-47d7-995d-68de26afe872"), "event_type": String("AccountCreated"), "id": String("e3f210c8-8f4a-4c8f-a8ee-c3e93417b0e8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAg5hbIME1SSOhshynlWIhhhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.739961Z")}
[2m2025-07-30T10:47:35.445491Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=83985b20-c135-4923-a1b2-1ca795622186, event_id=d887467f-d9ad-47d7-995d-68de26afe872, event_type=AccountCreated
[2m2025-07-30T10:47:35.445526Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id d887467f-d9ad-47d7-995d-68de26afe872: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 131, 152, 91, 32])
[2m2025-07-30T10:47:35.445573Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: d887467f-d9ad-47d7-995d-68de26afe872, Aggregate: 83985b20-c135-4923-a1b2-1ca795622186, Type: AccountCreated
[2m2025-07-30T10:47:35.445613Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id d887467f-d9ad-47d7-995d-68de26afe872
[2m2025-07-30T10:47:35.445671Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: d887467f-d9ad-47d7-995d-68de26afe872
[2m2025-07-30T10:47:35.445732Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: d887467f-d9ad-47d7-995d-68de26afe872
[2m2025-07-30T10:47:35.445762Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 83985b20-c135-4923-a1b2-1ca795622186 (immediate)
[2m2025-07-30T10:47:35.445796Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=83985b20-c135-4923-a1b2-1ca795622186 status=Completed
[2m2025-07-30T10:47:35.445828Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 83985b20-c135-4923-a1b2-1ca795622186 (immediate)
[2m2025-07-30T10:47:35.445859Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 83985b20-c135-4923-a1b2-1ca795622186 (immediate)
[2m2025-07-30T10:47:35.445885Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=83985b20-c135-4923-a1b2-1ca795622186 status=Completed
[2m2025-07-30T10:47:35.445922Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 83985b20-c135-4923-a1b2-1ca795622186 (immediate)
[2m2025-07-30T10:47:35.446004Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300036e8    
[2m2025-07-30T10:47:35.446031Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300036e8    
[2m2025-07-30T10:47:35.446052Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430003670    
[2m2025-07-30T10:47:35.446069Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430003670    
[2m2025-07-30T10:47:35.446108Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430008128, event_ptr: 0x7144300080b0 }
[2m2025-07-30T10:47:35.446310Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("0341015a-b267-467c-b005-6094bbabfeaf"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("4fe5d90d-cd79-483e-b5b4-8dce0f86f624"), "event_type": String("AccountCreated"), "id": String("d6469925-98ee-4d7c-b4d8-d29147adf01c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAA0EBWrJnRnywBWCUu6v+rxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.446396Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("0341015a-b267-467c-b005-6094bbabfeaf"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("4fe5d90d-cd79-483e-b5b4-8dce0f86f624"), "event_type": String("AccountCreated"), "id": String("d6469925-98ee-4d7c-b4d8-d29147adf01c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAA0EBWrJnRnywBWCUu6v+rxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}
[2m2025-07-30T10:47:35.446437Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=0341015a-b267-467c-b005-6094bbabfeaf, event_id=4fe5d90d-cd79-483e-b5b4-8dce0f86f624, event_type=AccountCreated
[2m2025-07-30T10:47:35.446471Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 4fe5d90d-cd79-483e-b5b4-8dce0f86f624: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 3, 65, 1, 90])
[2m2025-07-30T10:47:35.446517Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 4fe5d90d-cd79-483e-b5b4-8dce0f86f624, Aggregate: 0341015a-b267-467c-b005-6094bbabfeaf, Type: AccountCreated
[2m2025-07-30T10:47:35.446555Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 4fe5d90d-cd79-483e-b5b4-8dce0f86f624
[2m2025-07-30T10:47:35.446585Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 4fe5d90d-cd79-483e-b5b4-8dce0f86f624
[2m2025-07-30T10:47:35.446649Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 4fe5d90d-cd79-483e-b5b4-8dce0f86f624
[2m2025-07-30T10:47:35.446683Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 0341015a-b267-467c-b005-6094bbabfeaf (immediate)
[2m2025-07-30T10:47:35.446714Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=0341015a-b267-467c-b005-6094bbabfeaf status=Completed
[2m2025-07-30T10:47:35.446743Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 0341015a-b267-467c-b005-6094bbabfeaf (immediate)
[2m2025-07-30T10:47:35.446768Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 0341015a-b267-467c-b005-6094bbabfeaf (immediate)
[2m2025-07-30T10:47:35.446803Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=0341015a-b267-467c-b005-6094bbabfeaf status=Completed
[2m2025-07-30T10:47:35.446833Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 0341015a-b267-467c-b005-6094bbabfeaf (immediate)
[2m2025-07-30T10:47:35.446914Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430008128    
[2m2025-07-30T10:47:35.446938Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430008128    
[2m2025-07-30T10:47:35.446958Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300080b0    
[2m2025-07-30T10:47:35.446974Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300080b0    
[2m2025-07-30T10:47:35.447006Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300060b8, event_ptr: 0x714430006040 }
[2m2025-07-30T10:47:35.447228Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("c987ee59-e277-49cc-8759-ae6fa80c36bb"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("586993db-3ace-475f-aa7e-ffa2d7187e95"), "event_type": String("AccountCreated"), "id": String("bf0c2a84-088e-4102-b2d2-9cd78d7aa896"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAyYfuWeJ3ScyHWa5vqAw2uxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.447314Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("c987ee59-e277-49cc-8759-ae6fa80c36bb"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("586993db-3ace-475f-aa7e-ffa2d7187e95"), "event_type": String("AccountCreated"), "id": String("bf0c2a84-088e-4102-b2d2-9cd78d7aa896"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAyYfuWeJ3ScyHWa5vqAw2uxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}
[2m2025-07-30T10:47:35.447355Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=c987ee59-e277-49cc-8759-ae6fa80c36bb, event_id=586993db-3ace-475f-aa7e-ffa2d7187e95, event_type=AccountCreated
[2m2025-07-30T10:47:35.447388Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 586993db-3ace-475f-aa7e-ffa2d7187e95: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 201, 135, 238, 89])
[2m2025-07-30T10:47:35.447432Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 586993db-3ace-475f-aa7e-ffa2d7187e95, Aggregate: c987ee59-e277-49cc-8759-ae6fa80c36bb, Type: AccountCreated
[2m2025-07-30T10:47:35.447471Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 586993db-3ace-475f-aa7e-ffa2d7187e95
[2m2025-07-30T10:47:35.447501Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 586993db-3ace-475f-aa7e-ffa2d7187e95
[2m2025-07-30T10:47:35.447561Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 586993db-3ace-475f-aa7e-ffa2d7187e95
[2m2025-07-30T10:47:35.447595Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (immediate)
[2m2025-07-30T10:47:35.447634Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=c987ee59-e277-49cc-8759-ae6fa80c36bb status=Completed
[2m2025-07-30T10:47:35.447665Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (immediate)
[2m2025-07-30T10:47:35.447694Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (immediate)
[2m2025-07-30T10:47:35.447722Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=c987ee59-e277-49cc-8759-ae6fa80c36bb status=Completed
[2m2025-07-30T10:47:35.447756Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate c987ee59-e277-49cc-8759-ae6fa80c36bb (immediate)
[2m2025-07-30T10:47:35.447834Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300060b8    
[2m2025-07-30T10:47:35.447858Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300060b8    
[2m2025-07-30T10:47:35.447878Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006040    
[2m2025-07-30T10:47:35.447896Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006040    
[2m2025-07-30T10:47:35.447921Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300061f8, event_ptr: 0x714430006180 }
[2m2025-07-30T10:47:35.448119Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("de7c59df-e67a-4ecb-bc69-ddd631c84c9f"), "created_at": String("2025-07-30T10:47:34.740065Z"), "event_id": String("33664502-747f-4fdf-9abb-29b87f9dcc55"), "event_type": String("AccountCreated"), "id": String("0ece3dbf-cfcf-4289-bfbe-56a08aabed33"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA3nxZ3+Z6Tsu8ad3WMchMnxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740065Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.448216Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("de7c59df-e67a-4ecb-bc69-ddd631c84c9f"), "created_at": String("2025-07-30T10:47:34.740065Z"), "event_id": String("33664502-747f-4fdf-9abb-29b87f9dcc55"), "event_type": String("AccountCreated"), "id": String("0ece3dbf-cfcf-4289-bfbe-56a08aabed33"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA3nxZ3+Z6Tsu8ad3WMchMnxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740065Z")}
[2m2025-07-30T10:47:35.448257Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f, event_id=33664502-747f-4fdf-9abb-29b87f9dcc55, event_type=AccountCreated
[2m2025-07-30T10:47:35.448291Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 33664502-747f-4fdf-9abb-29b87f9dcc55: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 222, 124, 89, 223])
[2m2025-07-30T10:47:35.448334Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 33664502-747f-4fdf-9abb-29b87f9dcc55, Aggregate: de7c59df-e67a-4ecb-bc69-ddd631c84c9f, Type: AccountCreated
[2m2025-07-30T10:47:35.448371Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 33664502-747f-4fdf-9abb-29b87f9dcc55
[2m2025-07-30T10:47:35.448400Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 33664502-747f-4fdf-9abb-29b87f9dcc55
[2m2025-07-30T10:47:35.448456Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 33664502-747f-4fdf-9abb-29b87f9dcc55
[2m2025-07-30T10:47:35.448489Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (immediate)
[2m2025-07-30T10:47:35.448519Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f status=Completed
[2m2025-07-30T10:47:35.448546Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (immediate)
[2m2025-07-30T10:47:35.448575Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (immediate)
[2m2025-07-30T10:47:35.448603Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f status=Completed
[2m2025-07-30T10:47:35.448682Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 8 accounts. IDs: [b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[2m2025-07-30T10:47:35.448707Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=b9d64fad-b777-4586-afbd-9857b52c8c50, owner_name=StressTestUser_24
[2m2025-07-30T10:47:35.448722Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802, owner_name=StressTestUser_38
[2m2025-07-30T10:47:35.448735Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=b44cb9ca-2459-42f3-b1ed-f384936e1654, owner_name=StressTestUser_44
[2m2025-07-30T10:47:35.448744Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=76712f66-7c6a-4f2a-a27b-b088343a009f, owner_name=StressTestUser_14
[2m2025-07-30T10:47:35.448755Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, owner_name=StressTestUser_47
[2m2025-07-30T10:47:35.448763Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=2fed6150-edc2-4f35-92e2-2653975a4ab4, owner_name=StressTestUser_17
[2m2025-07-30T10:47:35.448771Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, owner_name=StressTestUser_7
[2m2025-07-30T10:47:35.448780Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=b89811b8-79a0-444b-b81c-b5d1318fcf37, owner_name=StressTestUser_25
[2m2025-07-30T10:47:35.448798Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:35.448906Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {b9d64fad-b777-4586-afbd-9857b52c8c50: true, b44cb9ca-2459-42f3-b1ed-f384936e1654: true, 3f72cff7-d030-48d3-bcef-fc8bc53d1802: true, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e: true, b89811b8-79a0-444b-b81c-b5d1318fcf37: true, 2fed6150-edc2-4f35-92e2-2653975a4ab4: true, 76712f66-7c6a-4f2a-a27b-b088343a009f: true, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a: true}
[2m2025-07-30T10:47:35.448940Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 8 events in 289ms, throughput: 27/s
[2m2025-07-30T10:47:35.449028Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] CacheService::get_account: start for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] CacheService::get_account: before L1 cache lookup for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] CacheService::get_account: L1 cache miss for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] CacheService::get_account: before Redis lookup for 0341015a-b267-467c-b005-6094bbabfeaf
[2m2025-07-30T10:47:35.449526Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate de7c59df-e67a-4ecb-bc69-ddd631c84c9f (immediate)
[2m2025-07-30T10:47:35.449613Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300061f8    
[2m2025-07-30T10:47:35.449645Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300061f8    
[2m2025-07-30T10:47:35.449655Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006180    
[2m2025-07-30T10:47:35.449662Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006180    
[2m2025-07-30T10:47:35.449682Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006338, event_ptr: 0x7144300062c0 }
[2m2025-07-30T10:47:35.449862Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("8d0392bf-e746-4b5b-9ddb-a387d5baba89"), "event_type": String("AccountCreated"), "id": String("08ff61f7-cf09-4f5a-9fbe-29334e28f313"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA75PhD4CRSx2p1qpRxueaThEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.449946Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e"), "created_at": String("2025-07-30T10:47:34.740175Z"), "event_id": String("8d0392bf-e746-4b5b-9ddb-a387d5baba89"), "event_type": String("AccountCreated"), "id": String("08ff61f7-cf09-4f5a-9fbe-29334e28f313"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA75PhD4CRSx2p1qpRxueaThEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.740175Z")}
[2m2025-07-30T10:47:35.449985Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, event_id=8d0392bf-e746-4b5b-9ddb-a387d5baba89, event_type=AccountCreated
[2m2025-07-30T10:47:35.450017Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 8d0392bf-e746-4b5b-9ddb-a387d5baba89: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 239, 147, 225, 15])
[2m2025-07-30T10:47:35.450056Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 8d0392bf-e746-4b5b-9ddb-a387d5baba89, Aggregate: ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, Type: AccountCreated
[2m2025-07-30T10:47:35.450094Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 8d0392bf-e746-4b5b-9ddb-a387d5baba89
[2m2025-07-30T10:47:35.450119Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 8d0392bf-e746-4b5b-9ddb-a387d5baba89
[DEBUG] CacheService::get_account: Redis miss for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] CacheService::get_account: returning None for 0341015a-b267-467c-b005-6094bbabfeaf
[2m2025-07-30T10:47:35.464268Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] get_account: start for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] get_account: acquiring cache read lock for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] get_account: acquired cache read lock for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] get_account: cache miss for 0341015a-b267-467c-b005-6094bbabfeaf
[DEBUG] ProjectionStore: About to query DB for account_id=0341015a-b267-467c-b005-6094bbabfeaf
[2m2025-07-30T10:47:35.470331Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.720552ms [3melapsed_secs[0m[2m=[0m0.003720552
[DEBUG] ProjectionStore: Finished DB query for account_id=0341015a-b267-467c-b005-6094bbabfeaf
[2m2025-07-30T10:47:35.474922Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 8. IDs: [b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[2m2025-07-30T10:47:35.476994Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 8 accounts to DB. IDs: [b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[2m2025-07-30T10:47:35.481673Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[2m2025-07-30T10:47:35.481705Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=b9d64fad-b777-4586-afbd-9857b52c8c50, owner_name=StressTestUser_24
[2m2025-07-30T10:47:35.481711Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=3f72cff7-d030-48d3-bcef-fc8bc53d1802, owner_name=StressTestUser_38
[2m2025-07-30T10:47:35.481717Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=b44cb9ca-2459-42f3-b1ed-f384936e1654, owner_name=StressTestUser_44
[2m2025-07-30T10:47:35.481721Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=76712f66-7c6a-4f2a-a27b-b088343a009f, owner_name=StressTestUser_14
[2m2025-07-30T10:47:35.481726Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, owner_name=StressTestUser_47
[2m2025-07-30T10:47:35.481730Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=2fed6150-edc2-4f35-92e2-2653975a4ab4, owner_name=StressTestUser_17
[2m2025-07-30T10:47:35.481745Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, owner_name=StressTestUser_7
[2m2025-07-30T10:47:35.481750Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=b89811b8-79a0-444b-b81c-b5d1318fcf37, owner_name=StressTestUser_25
[2m2025-07-30T10:47:35.485509Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 0341015a-b267-467c-b005-6094bbabfeaf
[2m2025-07-30T10:47:35.485575Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] CacheService::get_account: start for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] CacheService::get_account: before L1 cache lookup for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] CacheService::get_account: L1 cache miss for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] CacheService::get_account: before Redis lookup for c987ee59-e277-49cc-8759-ae6fa80c36bb
[2m2025-07-30T10:47:35.495125Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m8 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.090377ms [3melapsed_secs[0m[2m=[0m0.004090377
[2m2025-07-30T10:47:35.495209Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=8
[2m2025-07-30T10:47:35.497720Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.448341ms [3melapsed_secs[0m[2m=[0m0.002448341
[2m2025-07-30T10:47:35.497768Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 8 accounts. IDs: [b9d64fad-b777-4586-afbd-9857b52c8c50, 3f72cff7-d030-48d3-bcef-fc8bc53d1802, b44cb9ca-2459-42f3-b1ed-f384936e1654, 76712f66-7c6a-4f2a-a27b-b088343a009f, 7b28f0ae-8cc3-4b38-91ba-5f5fff828a3e, 2fed6150-edc2-4f35-92e2-2653975a4ab4, f2ce74f3-3f38-4d43-b7fa-e4eb6ca75f4a, b89811b8-79a0-444b-b81c-b5d1318fcf37]
[DEBUG] CacheService::get_account: Redis miss for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] CacheService::get_account: returning None for c987ee59-e277-49cc-8759-ae6fa80c36bb
[2m2025-07-30T10:47:35.507539Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] get_account: start for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] get_account: acquiring cache read lock for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] get_account: acquired cache read lock for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] get_account: cache miss for c987ee59-e277-49cc-8759-ae6fa80c36bb
[DEBUG] ProjectionStore: About to query DB for account_id=c987ee59-e277-49cc-8759-ae6fa80c36bb
[2m2025-07-30T10:47:35.514359Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.061664ms [3melapsed_secs[0m[2m=[0m0.004061664
[DEBUG] ProjectionStore: Finished DB query for account_id=c987ee59-e277-49cc-8759-ae6fa80c36bb
[2m2025-07-30T10:47:35.528376Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: c987ee59-e277-49cc-8759-ae6fa80c36bb
[2m2025-07-30T10:47:35.528469Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: start for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: before L1 cache lookup for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: L1 cache miss for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: before Redis lookup for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: Redis miss for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] CacheService::get_account: returning None for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[2m2025-07-30T10:47:35.537794Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] get_account: start for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] get_account: acquiring cache read lock for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] get_account: acquired cache read lock for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] get_account: cache miss for 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[DEBUG] ProjectionStore: About to query DB for account_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae
[2m2025-07-30T10:47:35.546274Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.9467ms [3melapsed_secs[0m[2m=[0m0.0059467
[DEBUG] ProjectionStore: Finished DB query for account_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae
[2m2025-07-30T10:47:35.559513Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 15aecab1-20c2-4ee4-9b64-a980a9a341ae
[2m2025-07-30T10:47:35.559589Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: start for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: before L1 cache lookup for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: L1 cache miss for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: before Redis lookup for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: Redis miss for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] CacheService::get_account: returning None for 83985b20-c135-4923-a1b2-1ca795622186
[2m2025-07-30T10:47:35.576326Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] get_account: start for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] get_account: acquiring cache read lock for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] get_account: acquired cache read lock for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] get_account: cache miss for 83985b20-c135-4923-a1b2-1ca795622186
[DEBUG] ProjectionStore: About to query DB for account_id=83985b20-c135-4923-a1b2-1ca795622186
[2m2025-07-30T10:47:35.582513Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.829757ms [3melapsed_secs[0m[2m=[0m0.003829757
[DEBUG] ProjectionStore: Finished DB query for account_id=83985b20-c135-4923-a1b2-1ca795622186
[2m2025-07-30T10:47:35.594652Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 83985b20-c135-4923-a1b2-1ca795622186
[2m2025-07-30T10:47:35.594779Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: start for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: before L1 cache lookup for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: L1 cache miss for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: before Redis lookup for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: Redis miss for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] CacheService::get_account: returning None for d23dfd52-c53e-41ff-ad59-84ce50361f13
[2m2025-07-30T10:47:35.603727Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] get_account: start for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] get_account: acquiring cache read lock for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] get_account: acquired cache read lock for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] get_account: cache miss for d23dfd52-c53e-41ff-ad59-84ce50361f13
[DEBUG] ProjectionStore: About to query DB for account_id=d23dfd52-c53e-41ff-ad59-84ce50361f13
[2m2025-07-30T10:47:35.611430Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.415303ms [3melapsed_secs[0m[2m=[0m0.005415303
[DEBUG] ProjectionStore: Finished DB query for account_id=d23dfd52-c53e-41ff-ad59-84ce50361f13
[2m2025-07-30T10:47:35.622681Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: d23dfd52-c53e-41ff-ad59-84ce50361f13
[2m2025-07-30T10:47:35.623048Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: start for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: before L1 cache lookup for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: L1 cache miss for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: before Redis lookup for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: Redis miss for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] CacheService::get_account: returning None for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[2m2025-07-30T10:47:35.633444Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] get_account: start for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] get_account: acquiring cache read lock for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] get_account: acquired cache read lock for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] get_account: cache miss for de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[DEBUG] ProjectionStore: About to query DB for account_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[2m2025-07-30T10:47:35.640977Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.825952ms [3melapsed_secs[0m[2m=[0m0.003825952
[DEBUG] ProjectionStore: Finished DB query for account_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[2m2025-07-30T10:47:35.653467Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: de7c59df-e67a-4ecb-bc69-ddd631c84c9f
[2m2025-07-30T10:47:35.653557Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: start for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: before L1 cache lookup for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: L1 cache miss for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: before Redis lookup for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: Redis miss for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] CacheService::get_account: returning None for 34068678-f78f-4c4e-897a-320e1e1ef98c
[2m2025-07-30T10:47:35.663976Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] get_account: start for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] get_account: acquiring cache read lock for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] get_account: acquired cache read lock for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] get_account: cache miss for 34068678-f78f-4c4e-897a-320e1e1ef98c
[DEBUG] ProjectionStore: About to query DB for account_id=34068678-f78f-4c4e-897a-320e1e1ef98c
[2m2025-07-30T10:47:35.669527Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.433009ms [3melapsed_secs[0m[2m=[0m0.003433009
[DEBUG] ProjectionStore: Finished DB query for account_id=34068678-f78f-4c4e-897a-320e1e1ef98c
[2m2025-07-30T10:47:35.683889Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 34068678-f78f-4c4e-897a-320e1e1ef98c
[2m2025-07-30T10:47:35.683961Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: start for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: before L1 cache lookup for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: L1 cache miss for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: before Redis lookup for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: Redis miss for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] CacheService::get_account: returning None for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[2m2025-07-30T10:47:35.694988Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] get_account: start for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] get_account: acquiring cache read lock for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] get_account: acquired cache read lock for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] get_account: cache miss for f28b281d-1783-4d9d-989e-dbf9ed9130cd
[DEBUG] ProjectionStore: About to query DB for account_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd
[2m2025-07-30T10:47:35.701019Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.608661ms [3melapsed_secs[0m[2m=[0m0.003608661
[DEBUG] ProjectionStore: Finished DB query for account_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd
[2m2025-07-30T10:47:35.713762Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: f28b281d-1783-4d9d-989e-dbf9ed9130cd
[2m2025-07-30T10:47:35.713831Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: start for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: before L1 cache lookup for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: L1 cache miss for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: before Redis lookup for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: Redis miss for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] CacheService::get_account: returning None for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[2m2025-07-30T10:47:35.723957Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] get_account: start for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] get_account: acquiring cache read lock for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] get_account: acquired cache read lock for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] get_account: cache miss for 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[DEBUG] ProjectionStore: About to query DB for account_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432
[2m2025-07-30T10:47:35.732570Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.645021ms [3melapsed_secs[0m[2m=[0m0.005645021
[DEBUG] ProjectionStore: Finished DB query for account_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432
[2m2025-07-30T10:47:35.746496Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 5591cc7a-5bfa-49d2-bda8-7e9c78197432
[2m2025-07-30T10:47:35.746601Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: start for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: before L1 cache lookup for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: L1 cache miss for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: before Redis lookup for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: Redis miss for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] CacheService::get_account: returning None for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[2m2025-07-30T10:47:35.756426Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] get_account: start for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] get_account: acquiring cache read lock for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] get_account: acquired cache read lock for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] get_account: cache miss for c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[DEBUG] ProjectionStore: About to query DB for account_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[2m2025-07-30T10:47:35.764005Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.039008ms [3melapsed_secs[0m[2m=[0m0.004039008
[DEBUG] ProjectionStore: Finished DB query for account_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[2m2025-07-30T10:47:35.776428Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: c4897ec9-f2ac-45df-aefa-9326bfac6a2f
[2m2025-07-30T10:47:35.776528Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 10 projections to ProjectionStore. IDs: [0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.776833Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 8d0392bf-e746-4b5b-9ddb-a387d5baba89
[2m2025-07-30T10:47:35.776877Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (immediate)
[2m2025-07-30T10:47:35.776910Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e status=Completed
[2m2025-07-30T10:47:35.776945Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (immediate)
[2m2025-07-30T10:47:35.776997Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (immediate)
[2m2025-07-30T10:47:35.777021Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e status=Completed
[2m2025-07-30T10:47:35.777058Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e (immediate)
[2m2025-07-30T10:47:35.777185Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006338    
[2m2025-07-30T10:47:35.777199Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006338    
[2m2025-07-30T10:47:35.777213Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300062c0    
[2m2025-07-30T10:47:35.777231Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300062c0    
[2m2025-07-30T10:47:35.777275Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006688, event_ptr: 0x714430006610 }
[2m2025-07-30T10:47:35.777496Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("550123b2-bf64-4afb-a6b1-b8d34120defa"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("cc6c62c5-7106-4d03-9425-37f71476c4eb"), "event_type": String("AccountCreated"), "id": String("ab8f98d8-d614-495b-a4fa-deb8636c623b"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAVQEjsr9kSvumsbjTQSDe+hEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.777587Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("550123b2-bf64-4afb-a6b1-b8d34120defa"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("cc6c62c5-7106-4d03-9425-37f71476c4eb"), "event_type": String("AccountCreated"), "id": String("ab8f98d8-d614-495b-a4fa-deb8636c623b"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAVQEjsr9kSvumsbjTQSDe+hEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}
[2m2025-07-30T10:47:35.777644Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=550123b2-bf64-4afb-a6b1-b8d34120defa, event_id=cc6c62c5-7106-4d03-9425-37f71476c4eb, event_type=AccountCreated
[2m2025-07-30T10:47:35.777689Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id cc6c62c5-7106-4d03-9425-37f71476c4eb: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 85, 1, 35, 178])
[2m2025-07-30T10:47:35.777743Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: cc6c62c5-7106-4d03-9425-37f71476c4eb, Aggregate: 550123b2-bf64-4afb-a6b1-b8d34120defa, Type: AccountCreated
[2m2025-07-30T10:47:35.777779Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id cc6c62c5-7106-4d03-9425-37f71476c4eb
[2m2025-07-30T10:47:35.777810Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: cc6c62c5-7106-4d03-9425-37f71476c4eb
[2m2025-07-30T10:47:35.777874Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: cc6c62c5-7106-4d03-9425-37f71476c4eb
[2m2025-07-30T10:47:35.777904Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (immediate)
[2m2025-07-30T10:47:35.777938Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=550123b2-bf64-4afb-a6b1-b8d34120defa status=Completed
[2m2025-07-30T10:47:35.777966Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (immediate)
[2m2025-07-30T10:47:35.777989Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (immediate)
[2m2025-07-30T10:47:35.778028Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=550123b2-bf64-4afb-a6b1-b8d34120defa status=Completed
[2m2025-07-30T10:47:35.778062Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 550123b2-bf64-4afb-a6b1-b8d34120defa (immediate)
[2m2025-07-30T10:47:35.778161Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006688    
[2m2025-07-30T10:47:35.778185Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006688    
[2m2025-07-30T10:47:35.778209Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006610    
[2m2025-07-30T10:47:35.778226Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006610    
[2m2025-07-30T10:47:35.778254Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300067c8, event_ptr: 0x714430006750 }
[2m2025-07-30T10:47:35.778477Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("e527021e-2239-422d-b558-f698ec838ab1"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("56a3ab30-1752-453b-9c27-4e38fcf22ad0"), "event_type": String("AccountCreated"), "id": String("4b50cffe-ef46-4877-8a88-426bce3fd810"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA5ScCHiI5Qi21WPaY7IOKsREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.778556Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("e527021e-2239-422d-b558-f698ec838ab1"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("56a3ab30-1752-453b-9c27-4e38fcf22ad0"), "event_type": String("AccountCreated"), "id": String("4b50cffe-ef46-4877-8a88-426bce3fd810"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA5ScCHiI5Qi21WPaY7IOKsREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}
[2m2025-07-30T10:47:35.778584Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=e527021e-2239-422d-b558-f698ec838ab1, event_id=56a3ab30-1752-453b-9c27-4e38fcf22ad0, event_type=AccountCreated
[2m2025-07-30T10:47:35.778607Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 56a3ab30-1752-453b-9c27-4e38fcf22ad0: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 229, 39, 2, 30])
[2m2025-07-30T10:47:35.778745Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 56a3ab30-1752-453b-9c27-4e38fcf22ad0, Aggregate: e527021e-2239-422d-b558-f698ec838ab1, Type: AccountCreated
[2m2025-07-30T10:47:35.778776Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 56a3ab30-1752-453b-9c27-4e38fcf22ad0
[2m2025-07-30T10:47:35.778793Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 56a3ab30-1752-453b-9c27-4e38fcf22ad0
[2m2025-07-30T10:47:35.778837Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 56a3ab30-1752-453b-9c27-4e38fcf22ad0
[2m2025-07-30T10:47:35.778854Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate e527021e-2239-422d-b558-f698ec838ab1 (immediate)
[2m2025-07-30T10:47:35.778895Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=e527021e-2239-422d-b558-f698ec838ab1 status=Completed
[2m2025-07-30T10:47:35.778912Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate e527021e-2239-422d-b558-f698ec838ab1 (immediate)
[2m2025-07-30T10:47:35.778924Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate e527021e-2239-422d-b558-f698ec838ab1 (immediate)
[2m2025-07-30T10:47:35.778952Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=e527021e-2239-422d-b558-f698ec838ab1 status=Completed
[2m2025-07-30T10:47:35.778968Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate e527021e-2239-422d-b558-f698ec838ab1 (immediate)
[2m2025-07-30T10:47:35.779021Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300067c8    
[2m2025-07-30T10:47:35.779035Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300067c8    
[2m2025-07-30T10:47:35.779045Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006750    
[2m2025-07-30T10:47:35.779055Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006750    
[2m2025-07-30T10:47:35.779074Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006908, event_ptr: 0x714430006890 }
[2m2025-07-30T10:47:35.779219Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f"), "event_type": String("AccountCreated"), "id": String("e7a429aa-37fd-4321-b462-f9a31f08c51a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAzzx9c/MqTd2uwi/DvpDLmBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.779275Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f"), "event_type": String("AccountCreated"), "id": String("e7a429aa-37fd-4321-b462-f9a31f08c51a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAzzx9c/MqTd2uwi/DvpDLmBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}
[2m2025-07-30T10:47:35.779298Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98, event_id=3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f, event_type=AccountCreated
[2m2025-07-30T10:47:35.779319Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 207, 60, 125, 115])
[2m2025-07-30T10:47:35.779345Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f, Aggregate: cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98, Type: AccountCreated
[2m2025-07-30T10:47:35.779363Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f
[2m2025-07-30T10:47:35.779379Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f
[2m2025-07-30T10:47:35.779414Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 3f3f500c-3ff9-4703-b247-a7f0fcc2ac3f
[2m2025-07-30T10:47:35.779429Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (immediate)
[2m2025-07-30T10:47:35.779444Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 status=Completed
[2m2025-07-30T10:47:35.779459Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (immediate)
[2m2025-07-30T10:47:35.779471Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (immediate)
[2m2025-07-30T10:47:35.779486Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 status=Completed
[2m2025-07-30T10:47:35.779500Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98 (immediate)
[2m2025-07-30T10:47:35.779551Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006908    
[2m2025-07-30T10:47:35.779564Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006908    
[2m2025-07-30T10:47:35.779574Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006890    
[2m2025-07-30T10:47:35.779584Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006890    
[2m2025-07-30T10:47:35.779607Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006a48, event_ptr: 0x7144300069d0 }
[2m2025-07-30T10:47:35.779758Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("6123ee1b-78cb-4996-98dc-801c2cbac2b2"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("10176408-40b9-44a4-9e09-e71b8139e919"), "event_type": String("AccountCreated"), "id": String("fef8be92-39ca-4a6f-b0e8-a0eac0947948"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAYSPuG3jLSZaY3IAcLLrCshEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.779814Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("6123ee1b-78cb-4996-98dc-801c2cbac2b2"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("10176408-40b9-44a4-9e09-e71b8139e919"), "event_type": String("AccountCreated"), "id": String("fef8be92-39ca-4a6f-b0e8-a0eac0947948"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAYSPuG3jLSZaY3IAcLLrCshEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}
[2m2025-07-30T10:47:35.779839Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2, event_id=10176408-40b9-44a4-9e09-e71b8139e919, event_type=AccountCreated
[2m2025-07-30T10:47:35.779860Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 10176408-40b9-44a4-9e09-e71b8139e919: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 97, 35, 238, 27])
[2m2025-07-30T10:47:35.779885Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 10176408-40b9-44a4-9e09-e71b8139e919, Aggregate: 6123ee1b-78cb-4996-98dc-801c2cbac2b2, Type: AccountCreated
[2m2025-07-30T10:47:35.779905Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 10176408-40b9-44a4-9e09-e71b8139e919
[2m2025-07-30T10:47:35.779920Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 10176408-40b9-44a4-9e09-e71b8139e919
[2m2025-07-30T10:47:35.779962Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 10176408-40b9-44a4-9e09-e71b8139e919
[2m2025-07-30T10:47:35.779978Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (immediate)
[2m2025-07-30T10:47:35.779994Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2 status=Completed
[2m2025-07-30T10:47:35.780009Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (immediate)
[2m2025-07-30T10:47:35.780022Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (immediate)
[2m2025-07-30T10:47:35.780036Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2 status=Completed
[2m2025-07-30T10:47:35.780051Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 6123ee1b-78cb-4996-98dc-801c2cbac2b2 (immediate)
[2m2025-07-30T10:47:35.780102Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006a48    
[2m2025-07-30T10:47:35.780115Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006a48    
[2m2025-07-30T10:47:35.780125Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300069d0    
[2m2025-07-30T10:47:35.780135Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300069d0    
[2m2025-07-30T10:47:35.780158Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006b88, event_ptr: 0x714430006b10 }
[2m2025-07-30T10:47:35.780309Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("19e6eb70-d640-4aa4-87b1-07a148f1c279"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("8b77c2d9-009f-4be0-bc64-e404d948bd5f"), "event_type": String("AccountCreated"), "id": String("07aa7f4b-deae-460f-bc11-7cf55a229bdd"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAGebrcNZASqSHsQehSPHCeREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.780361Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("19e6eb70-d640-4aa4-87b1-07a148f1c279"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("8b77c2d9-009f-4be0-bc64-e404d948bd5f"), "event_type": String("AccountCreated"), "id": String("07aa7f4b-deae-460f-bc11-7cf55a229bdd"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAGebrcNZASqSHsQehSPHCeREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}
[2m2025-07-30T10:47:35.780384Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=19e6eb70-d640-4aa4-87b1-07a148f1c279, event_id=8b77c2d9-009f-4be0-bc64-e404d948bd5f, event_type=AccountCreated
[2m2025-07-30T10:47:35.780404Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 8b77c2d9-009f-4be0-bc64-e404d948bd5f: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 25, 230, 235, 112])
[2m2025-07-30T10:47:35.780428Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 8b77c2d9-009f-4be0-bc64-e404d948bd5f, Aggregate: 19e6eb70-d640-4aa4-87b1-07a148f1c279, Type: AccountCreated
[2m2025-07-30T10:47:35.780446Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 8b77c2d9-009f-4be0-bc64-e404d948bd5f
[2m2025-07-30T10:47:35.780461Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 8b77c2d9-009f-4be0-bc64-e404d948bd5f
[2m2025-07-30T10:47:35.780496Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 8b77c2d9-009f-4be0-bc64-e404d948bd5f
[2m2025-07-30T10:47:35.780511Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (immediate)
[2m2025-07-30T10:47:35.780526Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=19e6eb70-d640-4aa4-87b1-07a148f1c279 status=Completed
[2m2025-07-30T10:47:35.780541Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (immediate)
[2m2025-07-30T10:47:35.780553Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (immediate)
[2m2025-07-30T10:47:35.780567Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=19e6eb70-d640-4aa4-87b1-07a148f1c279 status=Completed
[2m2025-07-30T10:47:35.780581Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 19e6eb70-d640-4aa4-87b1-07a148f1c279 (immediate)
[2m2025-07-30T10:47:35.780638Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006b88    
[2m2025-07-30T10:47:35.780652Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006b88    
[2m2025-07-30T10:47:35.780662Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006b10    
[2m2025-07-30T10:47:35.780672Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006b10    
[2m2025-07-30T10:47:35.780693Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430006cc8, event_ptr: 0x714430006c50 }
[2m2025-07-30T10:47:35.780832Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("82a28ae2-091a-4d48-b74d-6a26967b6847"), "created_at": String("2025-07-30T10:47:34.933395Z"), "event_id": String("18a4c1a4-9729-46fb-8edd-4d2fda5b4bce"), "event_type": String("AccountCreated"), "id": String("ae3daa4f-79cb-4531-8ed0-826bc874d4c8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAgqKK4gkaTUi3TWomlntoRxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933395Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.780885Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("82a28ae2-091a-4d48-b74d-6a26967b6847"), "created_at": String("2025-07-30T10:47:34.933395Z"), "event_id": String("18a4c1a4-9729-46fb-8edd-4d2fda5b4bce"), "event_type": String("AccountCreated"), "id": String("ae3daa4f-79cb-4531-8ed0-826bc874d4c8"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAgqKK4gkaTUi3TWomlntoRxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjcEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933395Z")}
[2m2025-07-30T10:47:35.780908Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=82a28ae2-091a-4d48-b74d-6a26967b6847, event_id=18a4c1a4-9729-46fb-8edd-4d2fda5b4bce, event_type=AccountCreated
[2m2025-07-30T10:47:35.780928Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 18a4c1a4-9729-46fb-8edd-4d2fda5b4bce: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 130, 162, 138, 226])
[2m2025-07-30T10:47:35.780952Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 18a4c1a4-9729-46fb-8edd-4d2fda5b4bce, Aggregate: 82a28ae2-091a-4d48-b74d-6a26967b6847, Type: AccountCreated
[2m2025-07-30T10:47:35.780970Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 18a4c1a4-9729-46fb-8edd-4d2fda5b4bce
[2m2025-07-30T10:47:35.780985Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 18a4c1a4-9729-46fb-8edd-4d2fda5b4bce
[2m2025-07-30T10:47:35.781020Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 18a4c1a4-9729-46fb-8edd-4d2fda5b4bce
[2m2025-07-30T10:47:35.781035Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (immediate)
[2m2025-07-30T10:47:35.781050Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=82a28ae2-091a-4d48-b74d-6a26967b6847 status=Completed
[2m2025-07-30T10:47:35.781065Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (immediate)
[2m2025-07-30T10:47:35.781076Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (immediate)
[2m2025-07-30T10:47:35.781090Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=82a28ae2-091a-4d48-b74d-6a26967b6847 status=Completed
[2m2025-07-30T10:47:35.781104Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 82a28ae2-091a-4d48-b74d-6a26967b6847 (immediate)
[2m2025-07-30T10:47:35.781153Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430006cc8    
[2m2025-07-30T10:47:35.781166Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430006cc8    
[2m2025-07-30T10:47:35.781176Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430006c50    
[2m2025-07-30T10:47:35.781187Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430006c50    
[2m2025-07-30T10:47:35.781204Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300070b8, event_ptr: 0x714430007040 }
[2m2025-07-30T10:47:35.781341Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("934002d1-3696-455e-95d3-29b1fd549c06"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("096f7cf1-c698-47ff-bfb7-d7fad36e5ae0"), "event_type": String("AccountCreated"), "id": String("7e58700d-dc47-40ff-90f3-3094f643f4e9"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAk0AC0TaWRV6V0ymx/VScBhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.781394Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("934002d1-3696-455e-95d3-29b1fd549c06"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("096f7cf1-c698-47ff-bfb7-d7fad36e5ae0"), "event_type": String("AccountCreated"), "id": String("7e58700d-dc47-40ff-90f3-3094f643f4e9"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAk0AC0TaWRV6V0ymx/VScBhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}
[2m2025-07-30T10:47:35.781417Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=934002d1-3696-455e-95d3-29b1fd549c06, event_id=096f7cf1-c698-47ff-bfb7-d7fad36e5ae0, event_type=AccountCreated
[2m2025-07-30T10:47:35.781437Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 096f7cf1-c698-47ff-bfb7-d7fad36e5ae0: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 147, 64, 2, 209])
[2m2025-07-30T10:47:35.781461Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 096f7cf1-c698-47ff-bfb7-d7fad36e5ae0, Aggregate: 934002d1-3696-455e-95d3-29b1fd549c06, Type: AccountCreated
[2m2025-07-30T10:47:35.781479Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 096f7cf1-c698-47ff-bfb7-d7fad36e5ae0
[2m2025-07-30T10:47:35.781494Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 096f7cf1-c698-47ff-bfb7-d7fad36e5ae0
[2m2025-07-30T10:47:35.781529Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 096f7cf1-c698-47ff-bfb7-d7fad36e5ae0
[2m2025-07-30T10:47:35.781544Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (immediate)
[2m2025-07-30T10:47:35.781559Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=934002d1-3696-455e-95d3-29b1fd549c06 status=Completed
[2m2025-07-30T10:47:35.781573Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (immediate)
[2m2025-07-30T10:47:35.781585Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (immediate)
[2m2025-07-30T10:47:35.781599Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=934002d1-3696-455e-95d3-29b1fd549c06 status=Completed
[2m2025-07-30T10:47:35.781613Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 934002d1-3696-455e-95d3-29b1fd549c06 (immediate)
[2m2025-07-30T10:47:35.781671Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300070b8    
[2m2025-07-30T10:47:35.781685Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300070b8    
[2m2025-07-30T10:47:35.781694Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007040    
[2m2025-07-30T10:47:35.781704Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007040    
[2m2025-07-30T10:47:35.781725Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300071f8, event_ptr: 0x714430007180 }
[2m2025-07-30T10:47:35.781864Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("43940fcc-f74b-426f-a97b-2574764a7e31"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("d8622646-8725-4509-9247-d93b6235f2df"), "event_type": String("AccountCreated"), "id": String("7c7ada59-2ac9-4772-9774-58de1d6dc71c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAQ5QPzPdLQm+peyV0dkp+MREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.781917Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("43940fcc-f74b-426f-a97b-2574764a7e31"), "created_at": String("2025-07-30T10:47:34.918933Z"), "event_id": String("d8622646-8725-4509-9247-d93b6235f2df"), "event_type": String("AccountCreated"), "id": String("7c7ada59-2ac9-4772-9774-58de1d6dc71c"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAQ5QPzPdLQm+peyV0dkp+MREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.918933Z")}
[2m2025-07-30T10:47:35.781940Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=43940fcc-f74b-426f-a97b-2574764a7e31, event_id=d8622646-8725-4509-9247-d93b6235f2df, event_type=AccountCreated
[2m2025-07-30T10:47:35.781960Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id d8622646-8725-4509-9247-d93b6235f2df: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 67, 148, 15, 204])
[2m2025-07-30T10:47:35.781984Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: d8622646-8725-4509-9247-d93b6235f2df, Aggregate: 43940fcc-f74b-426f-a97b-2574764a7e31, Type: AccountCreated
[2m2025-07-30T10:47:35.782002Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id d8622646-8725-4509-9247-d93b6235f2df
[2m2025-07-30T10:47:35.782017Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: d8622646-8725-4509-9247-d93b6235f2df
[2m2025-07-30T10:47:35.782050Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: d8622646-8725-4509-9247-d93b6235f2df
[2m2025-07-30T10:47:35.782065Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (immediate)
[2m2025-07-30T10:47:35.782080Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=43940fcc-f74b-426f-a97b-2574764a7e31 status=Completed
[2m2025-07-30T10:47:35.782094Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (immediate)
[2m2025-07-30T10:47:35.782106Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (immediate)
[2m2025-07-30T10:47:35.782120Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=43940fcc-f74b-426f-a97b-2574764a7e31 status=Completed
[2m2025-07-30T10:47:35.782175Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 10 accounts. IDs: [0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.782191Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=0341015a-b267-467c-b005-6094bbabfeaf, owner_name=StressTestUser_37
[2m2025-07-30T10:47:35.782198Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=c987ee59-e277-49cc-8759-ae6fa80c36bb, owner_name=StressTestUser_43
[2m2025-07-30T10:47:35.782204Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae, owner_name=StressTestUser_31
[2m2025-07-30T10:47:35.782210Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=83985b20-c135-4923-a1b2-1ca795622186, owner_name=StressTestUser_19
[2m2025-07-30T10:47:35.782217Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=d23dfd52-c53e-41ff-ad59-84ce50361f13, owner_name=StressTestUser_23
[2m2025-07-30T10:47:35.782223Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f, owner_name=StressTestUser_41
[2m2025-07-30T10:47:35.782229Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=34068678-f78f-4c4e-897a-320e1e1ef98c, owner_name=StressTestUser_48
[2m2025-07-30T10:47:35.782237Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd, owner_name=StressTestUser_42
[2m2025-07-30T10:47:35.782243Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432, owner_name=StressTestUser_11
[2m2025-07-30T10:47:35.782249Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f, owner_name=StressTestUser_2
[2m2025-07-30T10:47:35.782267Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:35.782404Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {5591cc7a-5bfa-49d2-bda8-7e9c78197432: true, c4897ec9-f2ac-45df-aefa-9326bfac6a2f: true, f28b281d-1783-4d9d-989e-dbf9ed9130cd: true, d23dfd52-c53e-41ff-ad59-84ce50361f13: true, c987ee59-e277-49cc-8759-ae6fa80c36bb: true, 34068678-f78f-4c4e-897a-320e1e1ef98c: true, 83985b20-c135-4923-a1b2-1ca795622186: true, 0341015a-b267-467c-b005-6094bbabfeaf: true, de7c59df-e67a-4ecb-bc69-ddd631c84c9f: true, 15aecab1-20c2-4ee4-9b64-a980a9a341ae: true}
[2m2025-07-30T10:47:35.782434Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 10 events in 333ms, throughput: 30/s
[2m2025-07-30T10:47:35.782515Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] CacheService::get_account: start for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] CacheService::get_account: before L1 cache lookup for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] CacheService::get_account: L1 cache miss for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] CacheService::get_account: before Redis lookup for e527021e-2239-422d-b558-f698ec838ab1
[2m2025-07-30T10:47:35.783806Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 43940fcc-f74b-426f-a97b-2574764a7e31 (immediate)
[2m2025-07-30T10:47:35.783873Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300071f8    
[2m2025-07-30T10:47:35.783918Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300071f8    
[2m2025-07-30T10:47:35.783950Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430007180    
[2m2025-07-30T10:47:35.783980Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430007180    
[2m2025-07-30T10:47:35.784021Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430007338, event_ptr: 0x7144300072c0 }
[2m2025-07-30T10:47:35.784186Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("cffce9cb-b536-4cf4-9578-ac63bf4d41b2"), "created_at": String("2025-07-30T10:47:34.933338Z"), "event_id": String("fd54a23c-fdaf-4339-9de6-79d615178d54"), "event_type": String("AccountCreated"), "id": String("90573413-597b-40f5-a4c7-9fe75d6b18fb"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAz/zpy7U2TPSVeKxjv01BshAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNgQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933338Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:35.784299Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("cffce9cb-b536-4cf4-9578-ac63bf4d41b2"), "created_at": String("2025-07-30T10:47:34.933338Z"), "event_id": String("fd54a23c-fdaf-4339-9de6-79d615178d54"), "event_type": String("AccountCreated"), "id": String("90573413-597b-40f5-a4c7-9fe75d6b18fb"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAz/zpy7U2TPSVeKxjv01BshAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNgQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933338Z")}
[2m2025-07-30T10:47:35.784355Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2, event_id=fd54a23c-fdaf-4339-9de6-79d615178d54, event_type=AccountCreated
[2m2025-07-30T10:47:35.784403Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id fd54a23c-fdaf-4339-9de6-79d615178d54: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 207, 252, 233, 203])
[2m2025-07-30T10:47:35.784460Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: fd54a23c-fdaf-4339-9de6-79d615178d54, Aggregate: cffce9cb-b536-4cf4-9578-ac63bf4d41b2, Type: AccountCreated
[2m2025-07-30T10:47:35.784486Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id fd54a23c-fdaf-4339-9de6-79d615178d54
[2m2025-07-30T10:47:35.784501Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: fd54a23c-fdaf-4339-9de6-79d615178d54
[DEBUG] CacheService::get_account: Redis miss for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] CacheService::get_account: returning None for e527021e-2239-422d-b558-f698ec838ab1
[2m2025-07-30T10:47:35.796164Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] get_account: start for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] get_account: acquiring cache read lock for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] get_account: acquired cache read lock for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] get_account: cache miss for e527021e-2239-422d-b558-f698ec838ab1
[DEBUG] ProjectionStore: About to query DB for account_id=e527021e-2239-422d-b558-f698ec838ab1
[2m2025-07-30T10:47:35.801864Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.535897ms [3melapsed_secs[0m[2m=[0m0.003535897
[DEBUG] ProjectionStore: Finished DB query for account_id=e527021e-2239-422d-b558-f698ec838ab1
[2m2025-07-30T10:47:35.814076Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: e527021e-2239-422d-b558-f698ec838ab1
[2m2025-07-30T10:47:35.814142Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: start for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: before L1 cache lookup for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: L1 cache miss for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: before Redis lookup for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: Redis miss for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] CacheService::get_account: returning None for 82a28ae2-091a-4d48-b74d-6a26967b6847
[2m2025-07-30T10:47:35.825799Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] get_account: start for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] get_account: acquiring cache read lock for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] get_account: acquired cache read lock for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] get_account: cache miss for 82a28ae2-091a-4d48-b74d-6a26967b6847
[DEBUG] ProjectionStore: About to query DB for account_id=82a28ae2-091a-4d48-b74d-6a26967b6847
[2m2025-07-30T10:47:35.826453Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 10. IDs: [0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.828531Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 10 accounts to DB. IDs: [0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.832530Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.52362ms [3melapsed_secs[0m[2m=[0m0.00452362
[DEBUG] ProjectionStore: Finished DB query for account_id=82a28ae2-091a-4d48-b74d-6a26967b6847
[2m2025-07-30T10:47:35.834561Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.834585Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=0341015a-b267-467c-b005-6094bbabfeaf, owner_name=StressTestUser_37
[2m2025-07-30T10:47:35.834592Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=c987ee59-e277-49cc-8759-ae6fa80c36bb, owner_name=StressTestUser_43
[2m2025-07-30T10:47:35.834599Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=15aecab1-20c2-4ee4-9b64-a980a9a341ae, owner_name=StressTestUser_31
[2m2025-07-30T10:47:35.834614Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=83985b20-c135-4923-a1b2-1ca795622186, owner_name=StressTestUser_19
[2m2025-07-30T10:47:35.834649Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=d23dfd52-c53e-41ff-ad59-84ce50361f13, owner_name=StressTestUser_23
[2m2025-07-30T10:47:35.834654Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=de7c59df-e67a-4ecb-bc69-ddd631c84c9f, owner_name=StressTestUser_41
[2m2025-07-30T10:47:35.834660Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=34068678-f78f-4c4e-897a-320e1e1ef98c, owner_name=StressTestUser_48
[2m2025-07-30T10:47:35.834675Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=f28b281d-1783-4d9d-989e-dbf9ed9130cd, owner_name=StressTestUser_42
[2m2025-07-30T10:47:35.834681Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=5591cc7a-5bfa-49d2-bda8-7e9c78197432, owner_name=StressTestUser_11
[2m2025-07-30T10:47:35.834689Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=c4897ec9-f2ac-45df-aefa-9326bfac6a2f, owner_name=StressTestUser_2
[2m2025-07-30T10:47:35.848720Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m10 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.24941ms [3melapsed_secs[0m[2m=[0m0.00624941
[2m2025-07-30T10:47:35.848776Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=10
[2m2025-07-30T10:47:35.850916Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.09601ms [3melapsed_secs[0m[2m=[0m0.00209601
[2m2025-07-30T10:47:35.850959Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 10 accounts. IDs: [0341015a-b267-467c-b005-6094bbabfeaf, c987ee59-e277-49cc-8759-ae6fa80c36bb, 15aecab1-20c2-4ee4-9b64-a980a9a341ae, 83985b20-c135-4923-a1b2-1ca795622186, d23dfd52-c53e-41ff-ad59-84ce50361f13, de7c59df-e67a-4ecb-bc69-ddd631c84c9f, 34068678-f78f-4c4e-897a-320e1e1ef98c, f28b281d-1783-4d9d-989e-dbf9ed9130cd, 5591cc7a-5bfa-49d2-bda8-7e9c78197432, c4897ec9-f2ac-45df-aefa-9326bfac6a2f]
[2m2025-07-30T10:47:35.854390Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 82a28ae2-091a-4d48-b74d-6a26967b6847
[2m2025-07-30T10:47:35.854534Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: start for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: before L1 cache lookup for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: L1 cache miss for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: before Redis lookup for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: Redis miss for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] CacheService::get_account: returning None for 934002d1-3696-455e-95d3-29b1fd549c06
[2m2025-07-30T10:47:35.866038Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] get_account: start for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] get_account: acquiring cache read lock for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] get_account: acquired cache read lock for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] get_account: cache miss for 934002d1-3696-455e-95d3-29b1fd549c06
[DEBUG] ProjectionStore: About to query DB for account_id=934002d1-3696-455e-95d3-29b1fd549c06
[2m2025-07-30T10:47:35.874968Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.538466ms [3melapsed_secs[0m[2m=[0m0.004538466
[DEBUG] ProjectionStore: Finished DB query for account_id=934002d1-3696-455e-95d3-29b1fd549c06
[2m2025-07-30T10:47:35.886336Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 934002d1-3696-455e-95d3-29b1fd549c06
[2m2025-07-30T10:47:35.886400Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: start for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: before L1 cache lookup for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: L1 cache miss for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: before Redis lookup for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: Redis miss for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] CacheService::get_account: returning None for 550123b2-bf64-4afb-a6b1-b8d34120defa
[2m2025-07-30T10:47:35.903464Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] get_account: start for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] get_account: acquiring cache read lock for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] get_account: acquired cache read lock for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] get_account: cache miss for 550123b2-bf64-4afb-a6b1-b8d34120defa
[DEBUG] ProjectionStore: About to query DB for account_id=550123b2-bf64-4afb-a6b1-b8d34120defa
[2m2025-07-30T10:47:35.912417Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.675183ms [3melapsed_secs[0m[2m=[0m0.006675183
[DEBUG] ProjectionStore: Finished DB query for account_id=550123b2-bf64-4afb-a6b1-b8d34120defa
[2m2025-07-30T10:47:35.923864Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 550123b2-bf64-4afb-a6b1-b8d34120defa
[2m2025-07-30T10:47:35.923995Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: start for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: before L1 cache lookup for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: L1 cache miss for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: before Redis lookup for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: Redis miss for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] CacheService::get_account: returning None for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[2m2025-07-30T10:47:35.933320Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] get_account: start for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] get_account: acquiring cache read lock for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] get_account: acquired cache read lock for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] get_account: cache miss for 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[DEBUG] ProjectionStore: About to query DB for account_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2
[2m2025-07-30T10:47:35.942631Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.768478ms [3melapsed_secs[0m[2m=[0m0.006768478
[DEBUG] ProjectionStore: Finished DB query for account_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2
[2m2025-07-30T10:47:35.953694Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 6123ee1b-78cb-4996-98dc-801c2cbac2b2
[2m2025-07-30T10:47:35.953765Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: start for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: before L1 cache lookup for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: L1 cache miss for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: before Redis lookup for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: Redis miss for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] CacheService::get_account: returning None for 43940fcc-f74b-426f-a97b-2574764a7e31
[2m2025-07-30T10:47:35.969737Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] get_account: start for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] get_account: acquiring cache read lock for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] get_account: acquired cache read lock for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] get_account: cache miss for 43940fcc-f74b-426f-a97b-2574764a7e31
[DEBUG] ProjectionStore: About to query DB for account_id=43940fcc-f74b-426f-a97b-2574764a7e31
[2m2025-07-30T10:47:35.981299Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.841321ms [3melapsed_secs[0m[2m=[0m0.006841321
[DEBUG] ProjectionStore: Finished DB query for account_id=43940fcc-f74b-426f-a97b-2574764a7e31
[2m2025-07-30T10:47:35.994249Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 43940fcc-f74b-426f-a97b-2574764a7e31
[2m2025-07-30T10:47:35.994330Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: start for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: before L1 cache lookup for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: L1 cache miss for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: before Redis lookup for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: Redis miss for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] CacheService::get_account: returning None for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[2m2025-07-30T10:47:36.010336Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] get_account: start for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] get_account: acquiring cache read lock for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] get_account: acquired cache read lock for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] get_account: cache miss for ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[DEBUG] ProjectionStore: About to query DB for account_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[2m2025-07-30T10:47:36.016672Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.016933ms [3melapsed_secs[0m[2m=[0m0.004016933
[DEBUG] ProjectionStore: Finished DB query for account_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[2m2025-07-30T10:47:36.028809Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e
[2m2025-07-30T10:47:36.028911Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: start for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: before L1 cache lookup for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: L1 cache miss for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: before Redis lookup for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: Redis miss for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] CacheService::get_account: returning None for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[2m2025-07-30T10:47:36.038071Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] get_account: start for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] get_account: acquiring cache read lock for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] get_account: acquired cache read lock for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] get_account: cache miss for 19e6eb70-d640-4aa4-87b1-07a148f1c279
[DEBUG] ProjectionStore: About to query DB for account_id=19e6eb70-d640-4aa4-87b1-07a148f1c279
[2m2025-07-30T10:47:36.045854Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.865534ms [3melapsed_secs[0m[2m=[0m0.004865534
[DEBUG] ProjectionStore: Finished DB query for account_id=19e6eb70-d640-4aa4-87b1-07a148f1c279
[2m2025-07-30T10:47:36.057987Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 19e6eb70-d640-4aa4-87b1-07a148f1c279
[2m2025-07-30T10:47:36.058108Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: start for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: before L1 cache lookup for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: L1 cache miss for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: before Redis lookup for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: Redis miss for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] CacheService::get_account: returning None for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[2m2025-07-30T10:47:36.067541Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] get_account: start for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] get_account: acquiring cache read lock for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] get_account: acquired cache read lock for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] get_account: cache miss for cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[DEBUG] ProjectionStore: About to query DB for account_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[2m2025-07-30T10:47:36.078376Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.789135ms [3melapsed_secs[0m[2m=[0m0.006789135
[DEBUG] ProjectionStore: Finished DB query for account_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[2m2025-07-30T10:47:36.090152Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98
[2m2025-07-30T10:47:36.090718Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 9 projections to ProjectionStore. IDs: [e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[2m2025-07-30T10:47:36.091310Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: fd54a23c-fdaf-4339-9de6-79d615178d54
[2m2025-07-30T10:47:36.091362Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (immediate)
[2m2025-07-30T10:47:36.091380Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2 status=Completed
[2m2025-07-30T10:47:36.091398Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (immediate)
[2m2025-07-30T10:47:36.091410Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (immediate)
[2m2025-07-30T10:47:36.091426Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2 status=Completed
[2m2025-07-30T10:47:36.091440Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate cffce9cb-b536-4cf4-9578-ac63bf4d41b2 (immediate)
[2m2025-07-30T10:47:36.091552Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430007338    
[2m2025-07-30T10:47:36.091569Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430007338    
[2m2025-07-30T10:47:36.091578Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300072c0    
[2m2025-07-30T10:47:36.091589Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300072c0    
[2m2025-07-30T10:47:36.091642Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430013cf8, event_ptr: 0x714430013c80 }
[2m2025-07-30T10:47:36.091801Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("acf0ba30-0efb-4b8c-9842-f6033fbfc84d"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("cf124277-9e7e-48db-89f9-c8ef4eacc3ab"), "event_type": String("AccountCreated"), "id": String("6a8cfe06-21ab-4472-843a-e21f276a5e53"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAArPC6MA77S4yYQvYDP7/ITREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.091853Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("acf0ba30-0efb-4b8c-9842-f6033fbfc84d"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("cf124277-9e7e-48db-89f9-c8ef4eacc3ab"), "event_type": String("AccountCreated"), "id": String("6a8cfe06-21ab-4472-843a-e21f276a5e53"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAArPC6MA77S4yYQvYDP7/ITREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzMEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}
[2m2025-07-30T10:47:36.091876Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d, event_id=cf124277-9e7e-48db-89f9-c8ef4eacc3ab, event_type=AccountCreated
[2m2025-07-30T10:47:36.091903Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id cf124277-9e7e-48db-89f9-c8ef4eacc3ab: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 172, 240, 186, 48])
[2m2025-07-30T10:47:36.091976Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: cf124277-9e7e-48db-89f9-c8ef4eacc3ab, Aggregate: acf0ba30-0efb-4b8c-9842-f6033fbfc84d, Type: AccountCreated
[2m2025-07-30T10:47:36.091996Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id cf124277-9e7e-48db-89f9-c8ef4eacc3ab
[2m2025-07-30T10:47:36.092013Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: cf124277-9e7e-48db-89f9-c8ef4eacc3ab
[2m2025-07-30T10:47:36.092066Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: cf124277-9e7e-48db-89f9-c8ef4eacc3ab
[2m2025-07-30T10:47:36.092096Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (immediate)
[2m2025-07-30T10:47:36.092128Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d status=Completed
[2m2025-07-30T10:47:36.092162Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (immediate)
[2m2025-07-30T10:47:36.092191Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (immediate)
[2m2025-07-30T10:47:36.092223Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d status=Completed
[2m2025-07-30T10:47:36.092255Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate acf0ba30-0efb-4b8c-9842-f6033fbfc84d (immediate)
[2m2025-07-30T10:47:36.092344Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430013cf8    
[2m2025-07-30T10:47:36.092368Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430013cf8    
[2m2025-07-30T10:47:36.092392Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430013c80    
[2m2025-07-30T10:47:36.092416Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430013c80    
[2m2025-07-30T10:47:36.092447Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430013e38, event_ptr: 0x714430013dc0 }
[2m2025-07-30T10:47:36.092655Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("8a1e00f0-1597-4259-8059-0e75d4a854a5"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("b19d4719-1ccc-4196-8130-00f133eacc78"), "event_type": String("AccountCreated"), "id": String("d2e4a5e8-38a9-4754-b184-7d777d22430a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAih4A8BWXQlmAWQ511KhUpREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.092741Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("8a1e00f0-1597-4259-8059-0e75d4a854a5"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("b19d4719-1ccc-4196-8130-00f133eacc78"), "event_type": String("AccountCreated"), "id": String("d2e4a5e8-38a9-4754-b184-7d777d22430a"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAih4A8BWXQlmAWQ511KhUpREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}
[2m2025-07-30T10:47:36.092783Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=8a1e00f0-1597-4259-8059-0e75d4a854a5, event_id=b19d4719-1ccc-4196-8130-00f133eacc78, event_type=AccountCreated
[2m2025-07-30T10:47:36.092822Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id b19d4719-1ccc-4196-8130-00f133eacc78: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 138, 30, 0, 240])
[2m2025-07-30T10:47:36.092865Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: b19d4719-1ccc-4196-8130-00f133eacc78, Aggregate: 8a1e00f0-1597-4259-8059-0e75d4a854a5, Type: AccountCreated
[2m2025-07-30T10:47:36.092902Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id b19d4719-1ccc-4196-8130-00f133eacc78
[2m2025-07-30T10:47:36.092931Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: b19d4719-1ccc-4196-8130-00f133eacc78
[2m2025-07-30T10:47:36.092994Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: b19d4719-1ccc-4196-8130-00f133eacc78
[2m2025-07-30T10:47:36.093023Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (immediate)
[2m2025-07-30T10:47:36.093055Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=8a1e00f0-1597-4259-8059-0e75d4a854a5 status=Completed
[2m2025-07-30T10:47:36.093088Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (immediate)
[2m2025-07-30T10:47:36.093116Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (immediate)
[2m2025-07-30T10:47:36.093147Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=8a1e00f0-1597-4259-8059-0e75d4a854a5 status=Completed
[2m2025-07-30T10:47:36.093180Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 8a1e00f0-1597-4259-8059-0e75d4a854a5 (immediate)
[2m2025-07-30T10:47:36.093265Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430013e38    
[2m2025-07-30T10:47:36.093288Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430013e38    
[2m2025-07-30T10:47:36.093312Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430013dc0    
[2m2025-07-30T10:47:36.093337Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430013dc0    
[2m2025-07-30T10:47:36.093365Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430013f78, event_ptr: 0x714430013f00 }
[2m2025-07-30T10:47:36.093560Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("7186dfcc-e470-4997-ba8a-d80f3f3dac73"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("a851dcb4-a913-4996-be36-0d5572b342ae"), "event_type": String("AccountCreated"), "id": String("03fb7234-4b80-4c39-b6ea-9e91b38ee188"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAcYbfzORwSZe6itgPPz2scxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.093657Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("7186dfcc-e470-4997-ba8a-d80f3f3dac73"), "created_at": String("2025-07-30T10:47:34.933435Z"), "event_id": String("a851dcb4-a913-4996-be36-0d5572b342ae"), "event_type": String("AccountCreated"), "id": String("03fb7234-4b80-4c39-b6ea-9e91b38ee188"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAcYbfzORwSZe6itgPPz2scxEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.933435Z")}
[2m2025-07-30T10:47:36.093702Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73, event_id=a851dcb4-a913-4996-be36-0d5572b342ae, event_type=AccountCreated
[2m2025-07-30T10:47:36.093737Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id a851dcb4-a913-4996-be36-0d5572b342ae: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 113, 134, 223, 204])
[2m2025-07-30T10:47:36.093802Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: a851dcb4-a913-4996-be36-0d5572b342ae, Aggregate: 7186dfcc-e470-4997-ba8a-d80f3f3dac73, Type: AccountCreated
[2m2025-07-30T10:47:36.093840Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id a851dcb4-a913-4996-be36-0d5572b342ae
[2m2025-07-30T10:47:36.093875Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: a851dcb4-a913-4996-be36-0d5572b342ae
[2m2025-07-30T10:47:36.093937Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: a851dcb4-a913-4996-be36-0d5572b342ae
[2m2025-07-30T10:47:36.093966Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (immediate)
[2m2025-07-30T10:47:36.093999Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73 status=Completed
[2m2025-07-30T10:47:36.094032Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (immediate)
[2m2025-07-30T10:47:36.094060Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (immediate)
[2m2025-07-30T10:47:36.094093Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73 status=Completed
[2m2025-07-30T10:47:36.094126Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 7186dfcc-e470-4997-ba8a-d80f3f3dac73 (immediate)
[2m2025-07-30T10:47:36.094213Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430013f78    
[2m2025-07-30T10:47:36.094236Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430013f78    
[2m2025-07-30T10:47:36.094260Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430013f00    
[2m2025-07-30T10:47:36.094286Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430013f00    
[2m2025-07-30T10:47:36.094323Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300160b8, event_ptr: 0x714430016040 }
[2m2025-07-30T10:47:36.094520Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("95295434-12fb-4e71-844f-b0e41f005d18"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("710a7b9f-e101-4d61-928d-1a02fe5dbcf7"), "event_type": String("AccountCreated"), "id": String("69e05409-b767-4e9d-aee3-99291c6bab92"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAlSlUNBL7TnGET7DkHwBdGBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.094605Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("95295434-12fb-4e71-844f-b0e41f005d18"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("710a7b9f-e101-4d61-928d-1a02fe5dbcf7"), "event_type": String("AccountCreated"), "id": String("69e05409-b767-4e9d-aee3-99291c6bab92"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAlSlUNBL7TnGET7DkHwBdGBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjEEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}
[2m2025-07-30T10:47:36.094656Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=95295434-12fb-4e71-844f-b0e41f005d18, event_id=710a7b9f-e101-4d61-928d-1a02fe5dbcf7, event_type=AccountCreated
[2m2025-07-30T10:47:36.094695Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 710a7b9f-e101-4d61-928d-1a02fe5dbcf7: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 149, 41, 84, 52])
[2m2025-07-30T10:47:36.094739Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 710a7b9f-e101-4d61-928d-1a02fe5dbcf7, Aggregate: 95295434-12fb-4e71-844f-b0e41f005d18, Type: AccountCreated
[2m2025-07-30T10:47:36.094775Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 710a7b9f-e101-4d61-928d-1a02fe5dbcf7
[2m2025-07-30T10:47:36.094804Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 710a7b9f-e101-4d61-928d-1a02fe5dbcf7
[2m2025-07-30T10:47:36.094864Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 710a7b9f-e101-4d61-928d-1a02fe5dbcf7
[2m2025-07-30T10:47:36.094893Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (immediate)
[2m2025-07-30T10:47:36.094926Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=95295434-12fb-4e71-844f-b0e41f005d18 status=Completed
[2m2025-07-30T10:47:36.094958Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (immediate)
[2m2025-07-30T10:47:36.094987Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (immediate)
[2m2025-07-30T10:47:36.095019Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=95295434-12fb-4e71-844f-b0e41f005d18 status=Completed
[2m2025-07-30T10:47:36.095052Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 95295434-12fb-4e71-844f-b0e41f005d18 (immediate)
[2m2025-07-30T10:47:36.095139Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300160b8    
[2m2025-07-30T10:47:36.095163Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300160b8    
[2m2025-07-30T10:47:36.095187Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430016040    
[2m2025-07-30T10:47:36.095228Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430016040    
[2m2025-07-30T10:47:36.095257Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300161f8, event_ptr: 0x714430016180 }
[2m2025-07-30T10:47:36.095449Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("1e66be70-e791-4039-8fd6-84d172418be7"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("0c94ec95-0121-4acf-aa47-e253e8f84765"), "event_type": String("AccountCreated"), "id": String("bfd3ef3a-6429-4b4a-af56-d4a7c303e7eb"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAHma+cOeRQDmP1oTRckGL5xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.095531Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("1e66be70-e791-4039-8fd6-84d172418be7"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("0c94ec95-0121-4acf-aa47-e253e8f84765"), "event_type": String("AccountCreated"), "id": String("bfd3ef3a-6429-4b4a-af56-d4a7c303e7eb"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAHma+cOeRQDmP1oTRckGL5xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}
[2m2025-07-30T10:47:36.095573Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=1e66be70-e791-4039-8fd6-84d172418be7, event_id=0c94ec95-0121-4acf-aa47-e253e8f84765, event_type=AccountCreated
[2m2025-07-30T10:47:36.095609Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 0c94ec95-0121-4acf-aa47-e253e8f84765: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 30, 102, 190, 112])
[2m2025-07-30T10:47:36.095662Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 0c94ec95-0121-4acf-aa47-e253e8f84765, Aggregate: 1e66be70-e791-4039-8fd6-84d172418be7, Type: AccountCreated
[2m2025-07-30T10:47:36.095697Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 0c94ec95-0121-4acf-aa47-e253e8f84765
[2m2025-07-30T10:47:36.095726Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 0c94ec95-0121-4acf-aa47-e253e8f84765
[2m2025-07-30T10:47:36.095783Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 0c94ec95-0121-4acf-aa47-e253e8f84765
[2m2025-07-30T10:47:36.095811Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (immediate)
[2m2025-07-30T10:47:36.095843Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=1e66be70-e791-4039-8fd6-84d172418be7 status=Completed
[2m2025-07-30T10:47:36.095876Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (immediate)
[2m2025-07-30T10:47:36.095903Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (immediate)
[2m2025-07-30T10:47:36.095934Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=1e66be70-e791-4039-8fd6-84d172418be7 status=Completed
[2m2025-07-30T10:47:36.095966Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 1e66be70-e791-4039-8fd6-84d172418be7 (immediate)
[2m2025-07-30T10:47:36.096049Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300161f8    
[2m2025-07-30T10:47:36.096072Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300161f8    
[2m2025-07-30T10:47:36.096096Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430016180    
[2m2025-07-30T10:47:36.096119Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430016180    
[2m2025-07-30T10:47:36.096153Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430016338, event_ptr: 0x7144300162c0 }
[2m2025-07-30T10:47:36.096347Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("bba216de-b846-46ca-a2e0-a248fa9481e4"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("95657bd9-2ca2-4bc2-ad8e-8725aad3f794"), "event_type": String("AccountCreated"), "id": String("e0c863b8-f4cc-4da3-bf46-ca71411ea0ab"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAu6IW3rhGRsqi4KJI+pSB5BAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfOQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.096430Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("bba216de-b846-46ca-a2e0-a248fa9481e4"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("95657bd9-2ca2-4bc2-ad8e-8725aad3f794"), "event_type": String("AccountCreated"), "id": String("e0c863b8-f4cc-4da3-bf46-ca71411ea0ab"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAu6IW3rhGRsqi4KJI+pSB5BAAAAAAAAAAU3RyZXNzVGVzdFVzZXJfOQQAAAAAAAAAMTAwMA=="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}
[2m2025-07-30T10:47:36.096471Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=bba216de-b846-46ca-a2e0-a248fa9481e4, event_id=95657bd9-2ca2-4bc2-ad8e-8725aad3f794, event_type=AccountCreated
[2m2025-07-30T10:47:36.096508Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 95657bd9-2ca2-4bc2-ad8e-8725aad3f794: 64 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 187, 162, 22, 222])
[2m2025-07-30T10:47:36.096550Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 95657bd9-2ca2-4bc2-ad8e-8725aad3f794, Aggregate: bba216de-b846-46ca-a2e0-a248fa9481e4, Type: AccountCreated
[2m2025-07-30T10:47:36.096584Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 95657bd9-2ca2-4bc2-ad8e-8725aad3f794
[2m2025-07-30T10:47:36.096613Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 95657bd9-2ca2-4bc2-ad8e-8725aad3f794
[2m2025-07-30T10:47:36.096681Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 95657bd9-2ca2-4bc2-ad8e-8725aad3f794
[2m2025-07-30T10:47:36.096709Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (immediate)
[2m2025-07-30T10:47:36.096741Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=bba216de-b846-46ca-a2e0-a248fa9481e4 status=Completed
[2m2025-07-30T10:47:36.096773Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (immediate)
[2m2025-07-30T10:47:36.096801Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (immediate)
[2m2025-07-30T10:47:36.096832Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=bba216de-b846-46ca-a2e0-a248fa9481e4 status=Completed
[2m2025-07-30T10:47:36.096859Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate bba216de-b846-46ca-a2e0-a248fa9481e4 (immediate)
[2m2025-07-30T10:47:36.096944Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430016338    
[2m2025-07-30T10:47:36.096967Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430016338    
[2m2025-07-30T10:47:36.096991Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x7144300162c0    
[2m2025-07-30T10:47:36.097014Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x7144300162c0    
[2m2025-07-30T10:47:36.097048Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x714430016478, event_ptr: 0x714430016400 }
[2m2025-07-30T10:47:36.097254Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("2fb0c79f-18dd-49bd-94ec-24980172faf7"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("796b6dcb-4333-4b52-8395-20957b85a8d0"), "event_type": String("AccountCreated"), "id": String("999076b0-dce8-4c73-8db6-086e21cdd637"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAL7DHnxjdSb2U7CSYAXL69xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.097339Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("2fb0c79f-18dd-49bd-94ec-24980172faf7"), "created_at": String("2025-07-30T10:47:34.936976Z"), "event_id": String("796b6dcb-4333-4b52-8395-20957b85a8d0"), "event_type": String("AccountCreated"), "id": String("999076b0-dce8-4c73-8db6-086e21cdd637"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAL7DHnxjdSb2U7CSYAXL69xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDYEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.936976Z")}
[2m2025-07-30T10:47:36.097382Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=2fb0c79f-18dd-49bd-94ec-24980172faf7, event_id=796b6dcb-4333-4b52-8395-20957b85a8d0, event_type=AccountCreated
[2m2025-07-30T10:47:36.097420Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 796b6dcb-4333-4b52-8395-20957b85a8d0: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 47, 176, 199, 159])
[2m2025-07-30T10:47:36.097463Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 796b6dcb-4333-4b52-8395-20957b85a8d0, Aggregate: 2fb0c79f-18dd-49bd-94ec-24980172faf7, Type: AccountCreated
[2m2025-07-30T10:47:36.097499Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 796b6dcb-4333-4b52-8395-20957b85a8d0
[2m2025-07-30T10:47:36.097528Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 796b6dcb-4333-4b52-8395-20957b85a8d0
[2m2025-07-30T10:47:36.097591Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 796b6dcb-4333-4b52-8395-20957b85a8d0
[2m2025-07-30T10:47:36.097628Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (immediate)
[2m2025-07-30T10:47:36.097662Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=2fb0c79f-18dd-49bd-94ec-24980172faf7 status=Completed
[2m2025-07-30T10:47:36.097692Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (immediate)
[2m2025-07-30T10:47:36.097721Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (immediate)
[2m2025-07-30T10:47:36.097753Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=2fb0c79f-18dd-49bd-94ec-24980172faf7 status=Completed
[2m2025-07-30T10:47:36.097786Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 2fb0c79f-18dd-49bd-94ec-24980172faf7 (immediate)
[2m2025-07-30T10:47:36.097872Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x714430016478    
[2m2025-07-30T10:47:36.097896Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x714430016478    
[2m2025-07-30T10:47:36.097919Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430016400    
[2m2025-07-30T10:47:36.097944Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430016400    
[2m2025-07-30T10:47:36.097978Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300177b8, event_ptr: 0x714430017740 }
[2m2025-07-30T10:47:36.098173Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("8b39b03e-62d5-47a2-85d0-4c7d6160a252"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7"), "event_type": String("AccountCreated"), "id": String("6c1606e9-d950-481b-81b5-f0066a9703f1"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAizmwPmLVR6KF0Ex9YWCiUhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.098268Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("8b39b03e-62d5-47a2-85d0-4c7d6160a252"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7"), "event_type": String("AccountCreated"), "id": String("6c1606e9-d950-481b-81b5-f0066a9703f1"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAizmwPmLVR6KF0Ex9YWCiUhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.098309Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252, event_id=ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7, event_type=AccountCreated
[2m2025-07-30T10:47:36.098345Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 139, 57, 176, 62])
[2m2025-07-30T10:47:36.098387Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7, Aggregate: 8b39b03e-62d5-47a2-85d0-4c7d6160a252, Type: AccountCreated
[2m2025-07-30T10:47:36.098422Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7
[2m2025-07-30T10:47:36.098450Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7
[2m2025-07-30T10:47:36.098506Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: ad5ebf75-48d1-492b-a9ba-f9da2d6a22f7
[2m2025-07-30T10:47:36.098535Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (immediate)
[2m2025-07-30T10:47:36.098566Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252 status=Completed
[2m2025-07-30T10:47:36.098597Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (immediate)
[2m2025-07-30T10:47:36.098633Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (immediate)
[2m2025-07-30T10:47:36.098665Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252 status=Completed
[2m2025-07-30T10:47:36.098729Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 9 accounts. IDs: [e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[2m2025-07-30T10:47:36.098752Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=e527021e-2239-422d-b558-f698ec838ab1, owner_name=StressTestUser_32
[2m2025-07-30T10:47:36.098768Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=82a28ae2-091a-4d48-b74d-6a26967b6847, owner_name=StressTestUser_27
[2m2025-07-30T10:47:36.098783Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=934002d1-3696-455e-95d3-29b1fd549c06, owner_name=StressTestUser_26
[2m2025-07-30T10:47:36.098798Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=550123b2-bf64-4afb-a6b1-b8d34120defa, owner_name=StressTestUser_39
[2m2025-07-30T10:47:36.098814Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2, owner_name=StressTestUser_18
[2m2025-07-30T10:47:36.098829Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=43940fcc-f74b-426f-a97b-2574764a7e31, owner_name=StressTestUser_35
[2m2025-07-30T10:47:36.098845Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, owner_name=StressTestUser_40
[2m2025-07-30T10:47:36.098859Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=19e6eb70-d640-4aa4-87b1-07a148f1c279, owner_name=StressTestUser_22
[2m2025-07-30T10:47:36.098875Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98, owner_name=StressTestUser_30
[2m2025-07-30T10:47:36.098901Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:36.099008Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {e527021e-2239-422d-b558-f698ec838ab1: true, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98: true, 19e6eb70-d640-4aa4-87b1-07a148f1c279: true, 934002d1-3696-455e-95d3-29b1fd549c06: true, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e: true, 550123b2-bf64-4afb-a6b1-b8d34120defa: true, 6123ee1b-78cb-4996-98dc-801c2cbac2b2: true, 43940fcc-f74b-426f-a97b-2574764a7e31: true, 82a28ae2-091a-4d48-b74d-6a26967b6847: true}
[2m2025-07-30T10:47:36.099042Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 9 events in 316ms, throughput: 28/s
[2m2025-07-30T10:47:36.099124Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] CacheService::get_account: start for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] CacheService::get_account: before L1 cache lookup for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] CacheService::get_account: L1 cache miss for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] CacheService::get_account: before Redis lookup for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[2m2025-07-30T10:47:36.099638Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 8b39b03e-62d5-47a2-85d0-4c7d6160a252 (immediate)
[2m2025-07-30T10:47:36.099727Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300177b8    
[2m2025-07-30T10:47:36.099750Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300177b8    
[2m2025-07-30T10:47:36.099769Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430017740    
[2m2025-07-30T10:47:36.099792Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430017740    
[2m2025-07-30T10:47:36.099822Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x7144300178f8, event_ptr: 0x714430017880 }
[2m2025-07-30T10:47:36.100013Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("008eed35-a97e-4648-983b-539a104fa6fa"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("abb942e1-408e-4f15-88b5-2a4d5b9648a5"), "event_type": String("AccountCreated"), "id": String("56cbb38e-c0b2-448f-b9c8-b4e1222a4b53"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAAI7tNal+RkiYO1OaEE+m+hEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.100096Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("008eed35-a97e-4648-983b-539a104fa6fa"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("abb942e1-408e-4f15-88b5-2a4d5b9648a5"), "event_type": String("AccountCreated"), "id": String("56cbb38e-c0b2-448f-b9c8-b4e1222a4b53"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAAI7tNal+RkiYO1OaEE+m+hEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDUEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.100138Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=008eed35-a97e-4648-983b-539a104fa6fa, event_id=abb942e1-408e-4f15-88b5-2a4d5b9648a5, event_type=AccountCreated
[2m2025-07-30T10:47:36.100175Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id abb942e1-408e-4f15-88b5-2a4d5b9648a5: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 142, 237, 53])
[2m2025-07-30T10:47:36.100218Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: abb942e1-408e-4f15-88b5-2a4d5b9648a5, Aggregate: 008eed35-a97e-4648-983b-539a104fa6fa, Type: AccountCreated
[2m2025-07-30T10:47:36.100252Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id abb942e1-408e-4f15-88b5-2a4d5b9648a5
[2m2025-07-30T10:47:36.100281Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: abb942e1-408e-4f15-88b5-2a4d5b9648a5
[DEBUG] CacheService::get_account: Redis miss for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] CacheService::get_account: returning None for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[2m2025-07-30T10:47:36.118450Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] get_account: start for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] get_account: acquiring cache read lock for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] get_account: acquired cache read lock for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] get_account: cache miss for cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[DEBUG] ProjectionStore: About to query DB for account_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[2m2025-07-30T10:47:36.128037Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.953232ms [3melapsed_secs[0m[2m=[0m0.006953232
[DEBUG] ProjectionStore: Finished DB query for account_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[2m2025-07-30T10:47:36.128359Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 9. IDs: [e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[2m2025-07-30T10:47:36.130523Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 9 accounts to DB. IDs: [e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[2m2025-07-30T10:47:36.134311Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[2m2025-07-30T10:47:36.134329Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=e527021e-2239-422d-b558-f698ec838ab1, owner_name=StressTestUser_32
[2m2025-07-30T10:47:36.134336Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=82a28ae2-091a-4d48-b74d-6a26967b6847, owner_name=StressTestUser_27
[2m2025-07-30T10:47:36.134340Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=934002d1-3696-455e-95d3-29b1fd549c06, owner_name=StressTestUser_26
[2m2025-07-30T10:47:36.134344Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=550123b2-bf64-4afb-a6b1-b8d34120defa, owner_name=StressTestUser_39
[2m2025-07-30T10:47:36.134349Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=6123ee1b-78cb-4996-98dc-801c2cbac2b2, owner_name=StressTestUser_18
[2m2025-07-30T10:47:36.134353Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=43940fcc-f74b-426f-a97b-2574764a7e31, owner_name=StressTestUser_35
[2m2025-07-30T10:47:36.134358Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, owner_name=StressTestUser_40
[2m2025-07-30T10:47:36.134362Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=19e6eb70-d640-4aa4-87b1-07a148f1c279, owner_name=StressTestUser_22
[2m2025-07-30T10:47:36.134366Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98, owner_name=StressTestUser_30
[2m2025-07-30T10:47:36.142693Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: cffce9cb-b536-4cf4-9578-ac63bf4d41b2
[2m2025-07-30T10:47:36.142797Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] CacheService::get_account: start for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] CacheService::get_account: before L1 cache lookup for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] CacheService::get_account: L1 cache miss for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] CacheService::get_account: before Redis lookup for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[2m2025-07-30T10:47:36.152039Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m9 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m9.003996ms [3melapsed_secs[0m[2m=[0m0.009003996
[2m2025-07-30T10:47:36.152101Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=9
[2m2025-07-30T10:47:36.154774Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.578288ms [3melapsed_secs[0m[2m=[0m0.002578288
[2m2025-07-30T10:47:36.154948Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 9 accounts. IDs: [e527021e-2239-422d-b558-f698ec838ab1, 82a28ae2-091a-4d48-b74d-6a26967b6847, 934002d1-3696-455e-95d3-29b1fd549c06, 550123b2-bf64-4afb-a6b1-b8d34120defa, 6123ee1b-78cb-4996-98dc-801c2cbac2b2, 43940fcc-f74b-426f-a97b-2574764a7e31, ef93e10f-8091-4b1d-a9d6-aa51c6e79a4e, 19e6eb70-d640-4aa4-87b1-07a148f1c279, cf3c7d73-f32a-4ddd-aec2-2fc3be90cb98]
[DEBUG] CacheService::get_account: Redis miss for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] CacheService::get_account: returning None for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[2m2025-07-30T10:47:36.163987Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] get_account: start for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] get_account: acquiring cache read lock for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] get_account: acquired cache read lock for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] get_account: cache miss for acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[DEBUG] ProjectionStore: About to query DB for account_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[2m2025-07-30T10:47:36.169747Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.638899ms [3melapsed_secs[0m[2m=[0m0.003638899
[DEBUG] ProjectionStore: Finished DB query for account_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[2m2025-07-30T10:47:36.183508Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: acf0ba30-0efb-4b8c-9842-f6033fbfc84d
[2m2025-07-30T10:47:36.183575Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: start for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: before L1 cache lookup for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: L1 cache miss for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: before Redis lookup for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: Redis miss for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] CacheService::get_account: returning None for bba216de-b846-46ca-a2e0-a248fa9481e4
[2m2025-07-30T10:47:36.194393Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] get_account: start for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] get_account: acquiring cache read lock for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] get_account: acquired cache read lock for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] get_account: cache miss for bba216de-b846-46ca-a2e0-a248fa9481e4
[DEBUG] ProjectionStore: About to query DB for account_id=bba216de-b846-46ca-a2e0-a248fa9481e4
[2m2025-07-30T10:47:36.200690Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.101388ms [3melapsed_secs[0m[2m=[0m0.004101388
[DEBUG] ProjectionStore: Finished DB query for account_id=bba216de-b846-46ca-a2e0-a248fa9481e4
[2m2025-07-30T10:47:36.213317Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: bba216de-b846-46ca-a2e0-a248fa9481e4
[2m2025-07-30T10:47:36.213385Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: start for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: before L1 cache lookup for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: L1 cache miss for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: before Redis lookup for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: Redis miss for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] CacheService::get_account: returning None for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[2m2025-07-30T10:47:36.226177Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] get_account: start for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] get_account: acquiring cache read lock for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] get_account: acquired cache read lock for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] get_account: cache miss for 2fb0c79f-18dd-49bd-94ec-24980172faf7
[DEBUG] ProjectionStore: About to query DB for account_id=2fb0c79f-18dd-49bd-94ec-24980172faf7
[2m2025-07-30T10:47:36.233629Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.160788ms [3melapsed_secs[0m[2m=[0m0.005160788
[DEBUG] ProjectionStore: Finished DB query for account_id=2fb0c79f-18dd-49bd-94ec-24980172faf7
[2m2025-07-30T10:47:36.246921Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 2fb0c79f-18dd-49bd-94ec-24980172faf7
[2m2025-07-30T10:47:36.246998Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: start for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: before L1 cache lookup for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: L1 cache miss for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: before Redis lookup for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: Redis miss for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] CacheService::get_account: returning None for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[2m2025-07-30T10:47:36.256313Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] get_account: start for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] get_account: acquiring cache read lock for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] get_account: acquired cache read lock for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] get_account: cache miss for 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[DEBUG] ProjectionStore: About to query DB for account_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73
[2m2025-07-30T10:47:36.264249Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.465913ms [3melapsed_secs[0m[2m=[0m0.005465913
[DEBUG] ProjectionStore: Finished DB query for account_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73
[2m2025-07-30T10:47:36.275973Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 7186dfcc-e470-4997-ba8a-d80f3f3dac73
[2m2025-07-30T10:47:36.276383Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: start for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: before L1 cache lookup for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: L1 cache miss for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: before Redis lookup for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: Redis miss for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] CacheService::get_account: returning None for 95295434-12fb-4e71-844f-b0e41f005d18
[2m2025-07-30T10:47:36.286317Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] get_account: start for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] get_account: acquiring cache read lock for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] get_account: acquired cache read lock for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] get_account: cache miss for 95295434-12fb-4e71-844f-b0e41f005d18
[DEBUG] ProjectionStore: About to query DB for account_id=95295434-12fb-4e71-844f-b0e41f005d18
[2m2025-07-30T10:47:36.292612Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.50182ms [3melapsed_secs[0m[2m=[0m0.00350182
[DEBUG] ProjectionStore: Finished DB query for account_id=95295434-12fb-4e71-844f-b0e41f005d18
[2m2025-07-30T10:47:36.304786Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 95295434-12fb-4e71-844f-b0e41f005d18
[2m2025-07-30T10:47:36.304851Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: start for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: before L1 cache lookup for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: L1 cache miss for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: before Redis lookup for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: Redis miss for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] CacheService::get_account: returning None for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[2m2025-07-30T10:47:36.315169Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] get_account: start for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] get_account: acquiring cache read lock for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] get_account: acquired cache read lock for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] get_account: cache miss for 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[DEBUG] ProjectionStore: About to query DB for account_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252
[2m2025-07-30T10:47:36.321104Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.802703ms [3melapsed_secs[0m[2m=[0m0.003802703
[DEBUG] ProjectionStore: Finished DB query for account_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252
[2m2025-07-30T10:47:36.338727Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 8b39b03e-62d5-47a2-85d0-4c7d6160a252
[2m2025-07-30T10:47:36.338794Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: start for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: before L1 cache lookup for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: L1 cache miss for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: before Redis lookup for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: Redis miss for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] CacheService::get_account: returning None for 1e66be70-e791-4039-8fd6-84d172418be7
[2m2025-07-30T10:47:36.349418Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] get_account: start for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] get_account: acquiring cache read lock for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] get_account: acquired cache read lock for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] get_account: cache miss for 1e66be70-e791-4039-8fd6-84d172418be7
[DEBUG] ProjectionStore: About to query DB for account_id=1e66be70-e791-4039-8fd6-84d172418be7
[2m2025-07-30T10:47:36.355977Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.449595ms [3melapsed_secs[0m[2m=[0m0.004449595
[DEBUG] ProjectionStore: Finished DB query for account_id=1e66be70-e791-4039-8fd6-84d172418be7
[2m2025-07-30T10:47:36.369170Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 1e66be70-e791-4039-8fd6-84d172418be7
[2m2025-07-30T10:47:36.369235Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: start for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: before L1 cache lookup for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: L1 cache miss for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: before Redis lookup for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: Redis miss for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] CacheService::get_account: returning None for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[2m2025-07-30T10:47:36.379601Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] get_account: start for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] get_account: acquiring cache read lock for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] get_account: acquired cache read lock for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] get_account: cache miss for 8a1e00f0-1597-4259-8059-0e75d4a854a5
[DEBUG] ProjectionStore: About to query DB for account_id=8a1e00f0-1597-4259-8059-0e75d4a854a5
[2m2025-07-30T10:47:36.385551Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.564327ms [3melapsed_secs[0m[2m=[0m0.003564327
[DEBUG] ProjectionStore: Finished DB query for account_id=8a1e00f0-1597-4259-8059-0e75d4a854a5
[2m2025-07-30T10:47:36.397711Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 8a1e00f0-1597-4259-8059-0e75d4a854a5
[2m2025-07-30T10:47:36.397855Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 9 projections to ProjectionStore. IDs: [cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[2m2025-07-30T10:47:36.398247Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: abb942e1-408e-4f15-88b5-2a4d5b9648a5
[2m2025-07-30T10:47:36.398288Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 008eed35-a97e-4648-983b-539a104fa6fa (immediate)
[2m2025-07-30T10:47:36.398305Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=008eed35-a97e-4648-983b-539a104fa6fa status=Completed
[2m2025-07-30T10:47:36.398319Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 008eed35-a97e-4648-983b-539a104fa6fa (immediate)
[2m2025-07-30T10:47:36.398330Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 008eed35-a97e-4648-983b-539a104fa6fa (immediate)
[2m2025-07-30T10:47:36.398345Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=008eed35-a97e-4648-983b-539a104fa6fa status=Completed
[2m2025-07-30T10:47:36.398357Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 008eed35-a97e-4648-983b-539a104fa6fa (immediate)
[2m2025-07-30T10:47:36.398449Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x7144300178f8    
[2m2025-07-30T10:47:36.398463Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x7144300178f8    
[2m2025-07-30T10:47:36.398472Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714430017880    
[2m2025-07-30T10:47:36.398486Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714430017880    
[2m2025-07-30T10:47:36.398535Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x71443001a1d8, event_ptr: 0x71443001a160 }
[2m2025-07-30T10:47:36.398724Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("d1b755fc-6266-414c-ab59-ab599dac5a5c"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("368b22db-f0ee-412d-a4c0-2203423040e9"), "event_type": String("AccountCreated"), "id": String("c0ae4b5b-cd37-48cd-b22b-a786a9627425"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA0bdV/GJmQUyrWatZnaxaXBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.398771Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("d1b755fc-6266-414c-ab59-ab599dac5a5c"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("368b22db-f0ee-412d-a4c0-2203423040e9"), "event_type": String("AccountCreated"), "id": String("c0ae4b5b-cd37-48cd-b22b-a786a9627425"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAA0bdV/GJmQUyrWatZnaxaXBEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMTIEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.398792Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=d1b755fc-6266-414c-ab59-ab599dac5a5c, event_id=368b22db-f0ee-412d-a4c0-2203423040e9, event_type=AccountCreated
[2m2025-07-30T10:47:36.398845Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id 368b22db-f0ee-412d-a4c0-2203423040e9: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 209, 183, 85, 252])
[2m2025-07-30T10:47:36.398891Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: 368b22db-f0ee-412d-a4c0-2203423040e9, Aggregate: d1b755fc-6266-414c-ab59-ab599dac5a5c, Type: AccountCreated
[2m2025-07-30T10:47:36.398923Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id 368b22db-f0ee-412d-a4c0-2203423040e9
[2m2025-07-30T10:47:36.398952Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: 368b22db-f0ee-412d-a4c0-2203423040e9
[2m2025-07-30T10:47:36.399006Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: 368b22db-f0ee-412d-a4c0-2203423040e9
[2m2025-07-30T10:47:36.399035Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (immediate)
[2m2025-07-30T10:47:36.399056Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=d1b755fc-6266-414c-ab59-ab599dac5a5c status=Completed
[2m2025-07-30T10:47:36.399083Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (immediate)
[2m2025-07-30T10:47:36.399110Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (immediate)
[2m2025-07-30T10:47:36.399138Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=d1b755fc-6266-414c-ab59-ab599dac5a5c status=Completed
[2m2025-07-30T10:47:36.399172Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate d1b755fc-6266-414c-ab59-ab599dac5a5c (immediate)
[2m2025-07-30T10:47:36.399247Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x71443001a1d8    
[2m2025-07-30T10:47:36.399272Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x71443001a1d8    
[2m2025-07-30T10:47:36.399291Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x71443001a160    
[2m2025-07-30T10:47:36.399308Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x71443001a160    
[2m2025-07-30T10:47:36.399337Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x71443001a318, event_ptr: 0x71443001a2a0 }
[2m2025-07-30T10:47:36.399524Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("99d9d236-1b1e-4b04-82e3-fdd8c20144d7"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ad056ed2-9fbc-43ed-8297-b0fed668ac0e"), "event_type": String("AccountCreated"), "id": String("d44cc21e-b773-4d2f-9460-90591200d274"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAmdnSNhseSwSC4/3YwgFE1xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.399608Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("99d9d236-1b1e-4b04-82e3-fdd8c20144d7"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ad056ed2-9fbc-43ed-8297-b0fed668ac0e"), "event_type": String("AccountCreated"), "id": String("d44cc21e-b773-4d2f-9460-90591200d274"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAmdnSNhseSwSC4/3YwgFE1xEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfNDkEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.399659Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7, event_id=ad056ed2-9fbc-43ed-8297-b0fed668ac0e, event_type=AccountCreated
[2m2025-07-30T10:47:36.399696Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id ad056ed2-9fbc-43ed-8297-b0fed668ac0e: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 153, 217, 210, 54])
[2m2025-07-30T10:47:36.399741Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: ad056ed2-9fbc-43ed-8297-b0fed668ac0e, Aggregate: 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, Type: AccountCreated
[2m2025-07-30T10:47:36.399777Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id ad056ed2-9fbc-43ed-8297-b0fed668ac0e
[2m2025-07-30T10:47:36.399807Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: ad056ed2-9fbc-43ed-8297-b0fed668ac0e
[2m2025-07-30T10:47:36.399865Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: ad056ed2-9fbc-43ed-8297-b0fed668ac0e
[2m2025-07-30T10:47:36.399902Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (immediate)
[2m2025-07-30T10:47:36.399938Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7 status=Completed
[2m2025-07-30T10:47:36.399963Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (immediate)
[2m2025-07-30T10:47:36.399991Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (immediate)
[2m2025-07-30T10:47:36.400017Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7 status=Completed
[2m2025-07-30T10:47:36.400050Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 99d9d236-1b1e-4b04-82e3-fdd8c20144d7 (immediate)
[2m2025-07-30T10:47:36.400127Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x71443001a318    
[2m2025-07-30T10:47:36.400151Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x71443001a318    
[2m2025-07-30T10:47:36.400170Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x71443001a2a0    
[2m2025-07-30T10:47:36.400187Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x71443001a2a0    
[2m2025-07-30T10:47:36.400211Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x71443001a458, event_ptr: 0x71443001a3e0 }
[2m2025-07-30T10:47:36.400404Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("74c38bc0-5acd-4dd2-9bbd-eefa58ad8131"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("d9fdfd97-d603-4df6-8544-24dd57bfbfe8"), "event_type": String("AccountCreated"), "id": String("a85970b0-685f-4478-a9c6-c3fae8746fc9"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAdMOLwFrNTdKbve76WK2BMREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.400487Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("74c38bc0-5acd-4dd2-9bbd-eefa58ad8131"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("d9fdfd97-d603-4df6-8544-24dd57bfbfe8"), "event_type": String("AccountCreated"), "id": String("a85970b0-685f-4478-a9c6-c3fae8746fc9"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAdMOLwFrNTdKbve76WK2BMREAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMzQEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.400525Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, event_id=d9fdfd97-d603-4df6-8544-24dd57bfbfe8, event_type=AccountCreated
[2m2025-07-30T10:47:36.400557Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id d9fdfd97-d603-4df6-8544-24dd57bfbfe8: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 116, 195, 139, 192])
[2m2025-07-30T10:47:36.400601Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: d9fdfd97-d603-4df6-8544-24dd57bfbfe8, Aggregate: 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, Type: AccountCreated
[2m2025-07-30T10:47:36.400647Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id d9fdfd97-d603-4df6-8544-24dd57bfbfe8
[2m2025-07-30T10:47:36.400677Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: d9fdfd97-d603-4df6-8544-24dd57bfbfe8
[2m2025-07-30T10:47:36.400732Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: d9fdfd97-d603-4df6-8544-24dd57bfbfe8
[2m2025-07-30T10:47:36.400761Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (immediate)
[2m2025-07-30T10:47:36.400794Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 status=Completed
[2m2025-07-30T10:47:36.400821Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (immediate)
[2m2025-07-30T10:47:36.400850Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (immediate)
[2m2025-07-30T10:47:36.400876Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 status=Completed
[2m2025-07-30T10:47:36.400908Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131 (immediate)
[2m2025-07-30T10:47:36.400988Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x71443001a458    
[2m2025-07-30T10:47:36.401017Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x71443001a458    
[2m2025-07-30T10:47:36.401041Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x71443001a3e0    
[2m2025-07-30T10:47:36.401067Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x71443001a3e0    
[2m2025-07-30T10:47:36.401104Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x71443001a598, event_ptr: 0x71443001a520 }
[2m2025-07-30T10:47:36.401319Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("3f158540-6f31-4847-911a-10d513334c6e"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("fe9ead01-7750-4a9b-9438-ed3646a94284"), "event_type": String("AccountCreated"), "id": String("5312003d-81a5-41ed-9ee0-3c220b887fa2"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAPxWFQG8xSEeRGhDVEzNMbhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.401402Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("3f158540-6f31-4847-911a-10d513334c6e"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("fe9ead01-7750-4a9b-9438-ed3646a94284"), "event_type": String("AccountCreated"), "id": String("5312003d-81a5-41ed-9ee0-3c220b887fa2"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAPxWFQG8xSEeRGhDVEzNMbhEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjgEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.401446Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=3f158540-6f31-4847-911a-10d513334c6e, event_id=fe9ead01-7750-4a9b-9438-ed3646a94284, event_type=AccountCreated
[2m2025-07-30T10:47:36.401478Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id fe9ead01-7750-4a9b-9438-ed3646a94284: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 63, 21, 133, 64])
[2m2025-07-30T10:47:36.401524Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: fe9ead01-7750-4a9b-9438-ed3646a94284, Aggregate: 3f158540-6f31-4847-911a-10d513334c6e, Type: AccountCreated
[2m2025-07-30T10:47:36.401561Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id fe9ead01-7750-4a9b-9438-ed3646a94284
[2m2025-07-30T10:47:36.401587Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: fe9ead01-7750-4a9b-9438-ed3646a94284
[2m2025-07-30T10:47:36.401647Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: fe9ead01-7750-4a9b-9438-ed3646a94284
[2m2025-07-30T10:47:36.401676Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 3f158540-6f31-4847-911a-10d513334c6e (immediate)
[2m2025-07-30T10:47:36.401709Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=3f158540-6f31-4847-911a-10d513334c6e status=Completed
[2m2025-07-30T10:47:36.401739Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 3f158540-6f31-4847-911a-10d513334c6e (immediate)
[2m2025-07-30T10:47:36.401766Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 3f158540-6f31-4847-911a-10d513334c6e (immediate)
[2m2025-07-30T10:47:36.401793Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=3f158540-6f31-4847-911a-10d513334c6e status=Completed
[2m2025-07-30T10:47:36.401825Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 3f158540-6f31-4847-911a-10d513334c6e (immediate)
[2m2025-07-30T10:47:36.401919Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x71443001a598    
[2m2025-07-30T10:47:36.401943Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x71443001a598    
[2m2025-07-30T10:47:36.401964Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x71443001a520    
[2m2025-07-30T10:47:36.401979Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x71443001a520    
[2m2025-07-30T10:47:36.402004Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m Message received: Message { ptr: 0x71443001a6d8, event_ptr: 0x71443001a660 }
[2m2025-07-30T10:47:36.402196Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 extract_event_serde_json: Processing CDC event: Object {"payload": Object {"__deleted": String("false"), "aggregate_id": String("8d7de81d-5f6a-4204-811b-86a77fbc34e0"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ecf85f54-3440-4469-bcae-4c77280a4c13"), "event_type": String("AccountCreated"), "id": String("5ec55a5a-bc68-4e59-81ed-5c7c19259d8d"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAjX3oHV9qQgSBG4anf7w04BEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}, "schema": Object {"fields": Array [Object {"default": String("00000000-0000-0000-0000-000000000000"), "field": String("id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("aggregate_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_id"), "name": String("io.debezium.data.Uuid"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("event_type"), "optional": Bool(false), "type": String("string")}, Object {"field": String("payload"), "optional": Bool(false), "type": String("bytes")}, Object {"field": String("topic"), "optional": Bool(false), "type": String("string")}, Object {"field": String("metadata"), "name": String("io.debezium.data.Json"), "optional": Bool(true), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("created_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"default": String("1970-01-01T00:00:00.000000Z"), "field": String("updated_at"), "name": String("io.debezium.time.ZonedTimestamp"), "optional": Bool(false), "type": String("string"), "version": Number(1)}, Object {"field": String("__deleted"), "optional": Bool(true), "type": String("string")}], "name": String("banking-es.public.kafka_outbox_cdc.Value"), "optional": Bool(false), "type": String("struct")}}
[2m2025-07-30T10:47:36.402279Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event data: Object {"__deleted": String("false"), "aggregate_id": String("8d7de81d-5f6a-4204-811b-86a77fbc34e0"), "created_at": String("2025-07-30T10:47:34.960494Z"), "event_id": String("ecf85f54-3440-4469-bcae-4c77280a4c13"), "event_type": String("AccountCreated"), "id": String("5ec55a5a-bc68-4e59-81ed-5c7c19259d8d"), "metadata": String("null"), "payload": String("AAAAABAAAAAAAAAAjX3oHV9qQgSBG4anf7w04BEAAAAAAAAAU3RyZXNzVGVzdFVzZXJfMjAEAAAAAAAAADEwMDA="), "topic": String("banking-es.public.kafka_outbox_cdc"), "updated_at": String("2025-07-30T10:47:34.960494Z")}
[2m2025-07-30T10:47:36.402320Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC EXTRACTED: aggregate_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0, event_id=ecf85f54-3440-4469-bcae-4c77280a4c13, event_type=AccountCreated
[2m2025-07-30T10:47:36.402351Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Decoded base64 payload for event_id ecf85f54-3440-4469-bcae-4c77280a4c13: 65 bytes (first 16: [0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 141, 125, 232, 29])
[2m2025-07-30T10:47:36.402395Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Extracted event - ID: ecf85f54-3440-4469-bcae-4c77280a4c13, Aggregate: 8d7de81d-5f6a-4204-811b-86a77fbc34e0, Type: AccountCreated
[2m2025-07-30T10:47:36.402432Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Successfully deserialized domain event for event_id ecf85f54-3440-4469-bcae-4c77280a4c13
[2m2025-07-30T10:47:36.402460Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Successfully extracted event with serde_json: ecf85f54-3440-4469-bcae-4c77280a4c13
[2m2025-07-30T10:47:36.402512Z[0m [34mDEBUG[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m 🔍 Event processed successfully: ecf85f54-3440-4469-bcae-4c77280a4c13
[2m2025-07-30T10:47:36.402541Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking projection completed for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (immediate)
[2m2025-07-30T10:47:36.402574Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_projection_completed: aggregate_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0 status=Completed
[2m2025-07-30T10:47:36.402602Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked projection completed for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (immediate)
[2m2025-07-30T10:47:36.402637Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Marking CDC completed for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (immediate)
[2m2025-07-30T10:47:36.402671Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::consistency_manager[0m[2m:[0m [ConsistencyManager] mark_completed: aggregate_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0 status=Completed
[2m2025-07-30T10:47:36.402701Z[0m [32m INFO[0m [1mprocess_cdc_event_ultra_fast[0m[2m:[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDC Event Processor: Successfully marked CDC completed for aggregate 8d7de81d-5f6a-4204-811b-86a77fbc34e0 (immediate)
[2m2025-07-30T10:47:36.402780Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying message: 0x71443001a6d8    
[2m2025-07-30T10:47:36.402805Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed message: 0x71443001a6d8    
[2m2025-07-30T10:47:36.402824Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x71443001a660    
[2m2025-07-30T10:47:36.402841Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x71443001a660    
[2m2025-07-30T10:47:36.402900Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 9 accounts. IDs: [cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[2m2025-07-30T10:47:36.402924Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2, owner_name=StressTestUser_6
[2m2025-07-30T10:47:36.402938Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d, owner_name=StressTestUser_33
[2m2025-07-30T10:47:36.402952Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=bba216de-b846-46ca-a2e0-a248fa9481e4, owner_name=StressTestUser_9
[2m2025-07-30T10:47:36.402963Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=2fb0c79f-18dd-49bd-94ec-24980172faf7, owner_name=StressTestUser_46
[2m2025-07-30T10:47:36.402974Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73, owner_name=StressTestUser_29
[2m2025-07-30T10:47:36.402982Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=95295434-12fb-4e71-844f-b0e41f005d18, owner_name=StressTestUser_21
[2m2025-07-30T10:47:36.402990Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252, owner_name=StressTestUser_15
[2m2025-07-30T10:47:36.403000Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=1e66be70-e791-4039-8fd6-84d172418be7, owner_name=StressTestUser_16
[2m2025-07-30T10:47:36.403010Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=8a1e00f0-1597-4259-8059-0e75d4a854a5, owner_name=StressTestUser_36
[2m2025-07-30T10:47:36.403026Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:36.403116Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {8a1e00f0-1597-4259-8059-0e75d4a854a5: true, cffce9cb-b536-4cf4-9578-ac63bf4d41b2: true, 8b39b03e-62d5-47a2-85d0-4c7d6160a252: true, 2fb0c79f-18dd-49bd-94ec-24980172faf7: true, 95295434-12fb-4e71-844f-b0e41f005d18: true, 1e66be70-e791-4039-8fd6-84d172418be7: true, bba216de-b846-46ca-a2e0-a248fa9481e4: true, acf0ba30-0efb-4b8c-9842-f6033fbfc84d: true, 7186dfcc-e470-4997-ba8a-d80f3f3dac73: true}
[2m2025-07-30T10:47:36.403150Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 9 events in 304ms, throughput: 29/s
[2m2025-07-30T10:47:36.403225Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: start for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: before L1 cache lookup for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: L1 cache miss for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: before Redis lookup for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: Redis miss for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] CacheService::get_account: returning None for 008eed35-a97e-4648-983b-539a104fa6fa
[2m2025-07-30T10:47:36.415517Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] get_account: start for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] get_account: acquiring cache read lock for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] get_account: acquired cache read lock for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] get_account: cache miss for 008eed35-a97e-4648-983b-539a104fa6fa
[DEBUG] ProjectionStore: About to query DB for account_id=008eed35-a97e-4648-983b-539a104fa6fa
[2m2025-07-30T10:47:36.421943Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.125655ms [3melapsed_secs[0m[2m=[0m0.004125655
[DEBUG] ProjectionStore: Finished DB query for account_id=008eed35-a97e-4648-983b-539a104fa6fa
[2m2025-07-30T10:47:36.426978Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 9. IDs: [cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[2m2025-07-30T10:47:36.429116Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 9 accounts to DB. IDs: [cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[2m2025-07-30T10:47:36.436736Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[2m2025-07-30T10:47:36.436777Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=cffce9cb-b536-4cf4-9578-ac63bf4d41b2, owner_name=StressTestUser_6
[2m2025-07-30T10:47:36.436784Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=acf0ba30-0efb-4b8c-9842-f6033fbfc84d, owner_name=StressTestUser_33
[2m2025-07-30T10:47:36.436789Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=bba216de-b846-46ca-a2e0-a248fa9481e4, owner_name=StressTestUser_9
[2m2025-07-30T10:47:36.436794Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=2fb0c79f-18dd-49bd-94ec-24980172faf7, owner_name=StressTestUser_46
[2m2025-07-30T10:47:36.436799Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=7186dfcc-e470-4997-ba8a-d80f3f3dac73, owner_name=StressTestUser_29
[2m2025-07-30T10:47:36.436815Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=95295434-12fb-4e71-844f-b0e41f005d18, owner_name=StressTestUser_21
[2m2025-07-30T10:47:36.436821Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=8b39b03e-62d5-47a2-85d0-4c7d6160a252, owner_name=StressTestUser_15
[2m2025-07-30T10:47:36.436826Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=1e66be70-e791-4039-8fd6-84d172418be7, owner_name=StressTestUser_16
[2m2025-07-30T10:47:36.436830Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=8a1e00f0-1597-4259-8059-0e75d4a854a5, owner_name=StressTestUser_36
[2m2025-07-30T10:47:36.441682Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 008eed35-a97e-4648-983b-539a104fa6fa
[2m2025-07-30T10:47:36.442118Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] CacheService::get_account: start for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] CacheService::get_account: before L1 cache lookup for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] CacheService::get_account: L1 cache miss for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] CacheService::get_account: before Redis lookup for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[2m2025-07-30T10:47:36.452494Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m9 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.952823ms [3melapsed_secs[0m[2m=[0m0.006952823
[2m2025-07-30T10:47:36.452552Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=9
[2m2025-07-30T10:47:36.454752Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.153907ms [3melapsed_secs[0m[2m=[0m0.002153907
[2m2025-07-30T10:47:36.454798Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 9 accounts. IDs: [cffce9cb-b536-4cf4-9578-ac63bf4d41b2, acf0ba30-0efb-4b8c-9842-f6033fbfc84d, bba216de-b846-46ca-a2e0-a248fa9481e4, 2fb0c79f-18dd-49bd-94ec-24980172faf7, 7186dfcc-e470-4997-ba8a-d80f3f3dac73, 95295434-12fb-4e71-844f-b0e41f005d18, 8b39b03e-62d5-47a2-85d0-4c7d6160a252, 1e66be70-e791-4039-8fd6-84d172418be7, 8a1e00f0-1597-4259-8059-0e75d4a854a5]
[DEBUG] CacheService::get_account: Redis miss for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] CacheService::get_account: returning None for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[2m2025-07-30T10:47:36.466560Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] get_account: start for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] get_account: acquiring cache read lock for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] get_account: acquired cache read lock for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] get_account: cache miss for 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[DEBUG] ProjectionStore: About to query DB for account_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[2m2025-07-30T10:47:36.472300Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.607436ms [3melapsed_secs[0m[2m=[0m0.003607436
[DEBUG] ProjectionStore: Finished DB query for account_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[2m2025-07-30T10:47:36.490736Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 99d9d236-1b1e-4b04-82e3-fdd8c20144d7
[2m2025-07-30T10:47:36.490858Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: start for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: before L1 cache lookup for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: L1 cache miss for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: before Redis lookup for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: Redis miss for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] CacheService::get_account: returning None for d1b755fc-6266-414c-ab59-ab599dac5a5c
[2m2025-07-30T10:47:36.500725Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] get_account: start for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] get_account: acquiring cache read lock for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] get_account: acquired cache read lock for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] get_account: cache miss for d1b755fc-6266-414c-ab59-ab599dac5a5c
[DEBUG] ProjectionStore: About to query DB for account_id=d1b755fc-6266-414c-ab59-ab599dac5a5c
[2m2025-07-30T10:47:36.507122Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.379766ms [3melapsed_secs[0m[2m=[0m0.004379766
[DEBUG] ProjectionStore: Finished DB query for account_id=d1b755fc-6266-414c-ab59-ab599dac5a5c
[2m2025-07-30T10:47:36.520308Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: d1b755fc-6266-414c-ab59-ab599dac5a5c
[2m2025-07-30T10:47:36.520371Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: start for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: before L1 cache lookup for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: L1 cache miss for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: before Redis lookup for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: Redis miss for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] CacheService::get_account: returning None for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[2m2025-07-30T10:47:36.533864Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] get_account: start for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] get_account: acquiring cache read lock for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] get_account: acquired cache read lock for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] get_account: cache miss for 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[DEBUG] ProjectionStore: About to query DB for account_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[2m2025-07-30T10:47:36.540184Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.652138ms [3melapsed_secs[0m[2m=[0m0.003652138
[DEBUG] ProjectionStore: Finished DB query for account_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[2m2025-07-30T10:47:36.557108Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131
[2m2025-07-30T10:47:36.557229Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: start for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: before L1 cache lookup for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: L1 cache miss for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: before Redis lookup for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: Redis miss for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] CacheService::get_account: returning None for 3f158540-6f31-4847-911a-10d513334c6e
[2m2025-07-30T10:47:36.567794Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] get_account: start for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] get_account: acquiring cache read lock for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] get_account: acquired cache read lock for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] get_account: cache miss for 3f158540-6f31-4847-911a-10d513334c6e
[DEBUG] ProjectionStore: About to query DB for account_id=3f158540-6f31-4847-911a-10d513334c6e
[2m2025-07-30T10:47:36.573606Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.685119ms [3melapsed_secs[0m[2m=[0m0.003685119
[DEBUG] ProjectionStore: Finished DB query for account_id=3f158540-6f31-4847-911a-10d513334c6e
[2m2025-07-30T10:47:36.587261Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 3f158540-6f31-4847-911a-10d513334c6e
[2m2025-07-30T10:47:36.587325Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L1 cache miss for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: start for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: before L1 cache lookup for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: L1 cache miss for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: before Redis lookup for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: Redis miss for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] CacheService::get_account: returning None for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[2m2025-07-30T10:47:36.599474Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m ProjectionCache: L2 (Redis) cache miss for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] get_account: start for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] get_account: acquiring cache read lock for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] get_account: acquired cache read lock for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] get_account: cache miss for 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[DEBUG] ProjectionStore: About to query DB for account_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0
[2m2025-07-30T10:47:36.605107Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT id, owner_name, balance, …" [3mdb.statement[0m[2m=[0m"\n\nSELECT\n  id,\n  owner_name,\n  balance,\n  is_active,\n  created_at,\n  updated_at\nFROM\n  account_projections\nWHERE\n  id = $1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.544645ms [3melapsed_secs[0m[2m=[0m0.003544645
[DEBUG] ProjectionStore: Finished DB query for account_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0
[2m2025-07-30T10:47:36.618385Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cache_service[0m[2m:[0m [CacheService] Updated in-memory cache for account: 8d7de81d-5f6a-4204-811b-86a77fbc34e0
[2m2025-07-30T10:47:36.618464Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: About to upsert 6 projections to ProjectionStore. IDs: [008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:36.618609Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch called with 6 accounts. IDs: [008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:36.618638Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=008eed35-a97e-4648-983b-539a104fa6fa, owner_name=StressTestUser_45
[2m2025-07-30T10:47:36.618648Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7, owner_name=StressTestUser_49
[2m2025-07-30T10:47:36.618655Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=d1b755fc-6266-414c-ab59-ab599dac5a5c, owner_name=StressTestUser_12
[2m2025-07-30T10:47:36.618663Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, owner_name=StressTestUser_34
[2m2025-07-30T10:47:36.618670Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=3f158540-6f31-4847-911a-10d513334c6e, owner_name=StressTestUser_28
[2m2025-07-30T10:47:36.618681Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: account_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0, owner_name=StressTestUser_20
[2m2025-07-30T10:47:36.618696Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] upsert_accounts_batch: sent to update_sender successfully
[2m2025-07-30T10:47:36.618771Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m CDCEventProcessor: Upsert to ProjectionStore completed: {3f158540-6f31-4847-911a-10d513334c6e: true, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131: true, 008eed35-a97e-4648-983b-539a104fa6fa: true, d1b755fc-6266-414c-ab59-ab599dac5a5c: true, 8d7de81d-5f6a-4204-811b-86a77fbc34e0: true, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7: true}
[2m2025-07-30T10:47:36.618800Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_event_processor[0m[2m:[0m Optimized batch processing: 6 events in 215ms, throughput: 27/s
[2m2025-07-30T10:47:36.626711Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: update_processor flushing account batch of size 6. IDs: [008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:36.628600Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel flushing 6 accounts to DB. IDs: [008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:36.632684Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: about to upsert accounts: ids=[008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:36.632715Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=008eed35-a97e-4648-983b-539a104fa6fa, owner_name=StressTestUser_45
[2m2025-07-30T10:47:36.632722Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=99d9d236-1b1e-4b04-82e3-fdd8c20144d7, owner_name=StressTestUser_49
[2m2025-07-30T10:47:36.632726Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=d1b755fc-6266-414c-ab59-ab599dac5a5c, owner_name=StressTestUser_12
[2m2025-07-30T10:47:36.632731Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, owner_name=StressTestUser_34
[2m2025-07-30T10:47:36.632735Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=3f158540-6f31-4847-911a-10d513334c6e, owner_name=StressTestUser_28
[2m2025-07-30T10:47:36.632740Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: account_id=8d7de81d-5f6a-4204-811b-86a77fbc34e0, owner_name=StressTestUser_20
[2m2025-07-30T10:47:36.644570Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO account_projections (id, …" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO\n  account_projections (\n    id,\n    owner_name,\n    balance,\n    is_active,\n    created_at,\n    updated_at\n  )\nSELECT\n  *\nFROM\n  UNNEST(\n    $1 :: uuid [],\n    $2 :: text [],\n    $3 :: decimal [],\n    $4 :: boolean [],\n    $5 :: timestamptz [],\n    $6 :: timestamptz []\n  ) ON CONFLICT (id) DO\nUPDATE\nSET\n  owner_name = EXCLUDED.owner_name,\n  balance = EXCLUDED.balance,\n  is_active = EXCLUDED.is_active,\n  updated_at = EXCLUDED.updated_at\n" [3mrows_affected[0m[2m=[0m6 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.902016ms [3melapsed_secs[0m[2m=[0m0.003902016
[2m2025-07-30T10:47:36.644693Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m [ProjectionStore] bulk_upsert_accounts: SQL result: rows_affected=6
[2m2025-07-30T10:47:36.648331Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"COMMIT" [3mdb.statement[0m[2m=[0m"" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.517742ms [3melapsed_secs[0m[2m=[0m0.003517742
[2m2025-07-30T10:47:36.648458Z[0m [32m INFO[0m [2mbanking_es::infrastructure::projections[0m[2m:[0m ProjectionStore: upsert_accounts_batch_parallel DB upsert completed successfully for 6 accounts. IDs: [008eed35-a97e-4648-983b-539a104fa6fa, 99d9d236-1b1e-4b04-82e3-fdd8c20144d7, d1b755fc-6266-414c-ab59-ab599dac5a5c, 74c38bc0-5acd-4dd2-9bbd-eefa58ad8131, 3f158540-6f31-4847-911a-10d513334c6e, 8d7de81d-5f6a-4204-811b-86a77fbc34e0]
[2m2025-07-30T10:47:45.683291Z[0m [34mDEBUG[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Poll timeout (count: 1000)
✅ Proceeding to write operations.

📝 PHASE 2: Submit Multiple Operations Per Account
==================================================

🧹 Cleaning up test resources...
🛑 Stopping CDC service manager...
[2m2025-07-30T10:47:49.737938Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Starting graceful shutdown of CDC Service Manager
[2m2025-07-30T10:47:49.737968Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: About to cancel shutdown_token
[2m2025-07-30T10:47:49.737985Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: shutdown_token.cancel() called
[2m2025-07-30T10:47:49.737991Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Starting graceful shutdown of CDC Service Manager
[2m2025-07-30T10:47:49.737997Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: About to cancel shutdown_token
[2m2025-07-30T10:47:49.738003Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: shutdown_token.cancel() called
[2m2025-07-30T10:47:49.738018Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Awaiting all background tasks
[2m2025-07-30T10:47:49.739625Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Health Monitor: Task completed
[2m2025-07-30T10:47:49.739682Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Metrics Collector: Task completed
[2m2025-07-30T10:47:49.739708Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Cleanup Task: Task completed
[2m2025-07-30T10:47:49.739731Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m Circuit Breaker Monitor: Task completed
[2m2025-07-30T10:47:49.739775Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDC consumer received shutdown signal
[2m2025-07-30T10:47:49.739787Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Received shutdown signal, breaking loop
[2m2025-07-30T10:47:49.739795Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDC consumer stopped after 1350 polls
[2m2025-07-30T10:47:49.739801Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Exiting start_consuming after 1350 polls
[2m2025-07-30T10:47:49.739810Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_debezium[0m[2m:[0m CDCConsumer: Exiting main polling loop. Active consumers: 0
[2m2025-07-30T10:47:49.739836Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Consumer: Completed normally
[2m2025-07-30T10:47:49.739851Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Consumer: Received shutdown signal (outer loop)
[2m2025-07-30T10:47:49.739858Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m CDC Consumer: Task completed
[2m2025-07-30T10:47:49.739973Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: All CDC tasks stopped gracefully
[2m2025-07-30T10:47:49.739990Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: CDC Service Manager stopped
[2m2025-07-30T10:47:49.739997Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: CDC Service Manager stopped
✅ CDC service manager stopped successfully
[2m2025-07-30T10:47:49.740009Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Starting graceful shutdown of CDC Service Manager
[2m2025-07-30T10:47:49.740016Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: About to cancel shutdown_token
[2m2025-07-30T10:47:49.740021Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: shutdown_token.cancel() called
[2m2025-07-30T10:47:49.740026Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Starting graceful shutdown of CDC Service Manager
[2m2025-07-30T10:47:49.740031Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: About to cancel shutdown_token
[2m2025-07-30T10:47:49.740035Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: shutdown_token.cancel() called
[2m2025-07-30T10:47:49.740042Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m 🛑 CDCServiceManager: Awaiting all background tasks
[2m2025-07-30T10:47:49.740049Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: All CDC tasks stopped gracefully
[2m2025-07-30T10:47:49.740055Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: CDC Service Manager stopped
[2m2025-07-30T10:47:49.740059Z[0m [32m INFO[0m [2mbanking_es::infrastructure::cdc_service_manager[0m[2m:[0m ✅ CDCServiceManager: CDC Service Manager stopped
✅ CDC service stopped
✅ Database pool closed
✅ All background tasks (including CDC consumer) stopped. Test complete.
✅ Write Batching Multi-Row Insert Test completed successfully!
[2m2025-07-30T10:47:52.099193Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Destroy ThreadedProducer    
[2m2025-07-30T10:47:52.099232Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Stopping polling    
[2m2025-07-30T10:47:52.099249Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Waiting for polling thread termination    
[2m2025-07-30T10:47:52.105629Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling thread loop terminated    
[2m2025-07-30T10:47:52.106047Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m Polling stopped    
[2m2025-07-30T10:47:52.106111Z[0m [35mTRACE[0m [2mrdkafka::producer::base_producer[0m[2m:[0m ThreadedProducer destroyed    
[2m2025-07-30T10:47:52.106300Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464d70ff0    
[2m2025-07-30T10:47:52.110016Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464d70ff0    
[2m2025-07-30T10:47:52.110082Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464d70800    
[2m2025-07-30T10:47:52.110096Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464d70800    
[2m2025-07-30T10:47:52.110511Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Destroying consumer: 0x714464d90590    
[2m2025-07-30T10:47:52.110593Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running pre-rebalance with Revoke(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.110640Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Pre-rebalance: Revoke(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:52.110657Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running rebalance with Revoke(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.110741Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running post-rebalance with Revoke(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.110759Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Post-rebalance: Revoke(TPL {banking-es-cache/0: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:52.110773Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714448021d50    
[2m2025-07-30T10:47:52.110785Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714448021d50    
[2m2025-07-30T10:47:52.210860Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Consumer destroyed: 0x714464d90590    
[2m2025-07-30T10:47:52.210956Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464d90590    
[2m2025-07-30T10:47:52.211925Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464d90590    
[2m2025-07-30T10:47:52.211996Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464d8f9c0    
[2m2025-07-30T10:47:52.212037Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464d8f9c0    
[2m2025-07-30T10:47:52.231021Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Destroying consumer: 0x714464e9d350    
[2m2025-07-30T10:47:52.231290Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running pre-rebalance with Revoke(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.231376Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Pre-rebalance: Revoke(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:52.231397Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running rebalance with Revoke(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.231581Z[0m [35mTRACE[0m [2mrdkafka::consumer[0m[2m:[0m Running post-rebalance with Revoke(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})    
[2m2025-07-30T10:47:52.231613Z[0m [32m INFO[0m [2mbanking_es::infrastructure::kafka_abstraction[0m[2m:[0m Post-rebalance: Revoke(TPL {banking-es.public.kafka_outbox_cdc/0: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/1: offset=Invalid metadata="", error=Ok(()); banking-es.public.kafka_outbox_cdc/2: offset=Invalid metadata="", error=Ok(())})
[2m2025-07-30T10:47:52.231916Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying event: 0x714440022a00    
[2m2025-07-30T10:47:52.231948Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed event: 0x714440022a00    
[2m2025-07-30T10:47:52.332002Z[0m [35mTRACE[0m [2mrdkafka::consumer::base_consumer[0m[2m:[0m Consumer destroyed: 0x714464e9d350    
[2m2025-07-30T10:47:52.332042Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying client: 0x714464e9d350    
[2m2025-07-30T10:47:52.332586Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed client: 0x714464e9d350    
[2m2025-07-30T10:47:52.332625Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroying queue: 0x714464ec3970    
[2m2025-07-30T10:47:52.332639Z[0m [35mTRACE[0m [2mrdkafka::util[0m[2m:[0m Destroyed queue: 0x714464ec3970    
test test_write_batching_multi_row_inserts ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 41.22s

